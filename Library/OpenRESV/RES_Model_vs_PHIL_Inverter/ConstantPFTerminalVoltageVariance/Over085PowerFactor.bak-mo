within OpenRESV.RES_Model_vs_PHIL_Inverter.ConstantPFTerminalVoltageVariance;
package Over085PowerFactor
  "Model validation for inverter experiment with constant power factor mode - 0.85 Overexcited."
  model VoltageVariation_350_to_340_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.10905,
          889.05; 0.17028,889.05; 0.31029,889.59; 0.3739,889.58; 0.54358,
          889.25; 0.65345,889.27; 0.73186,890.32; 0.85871,890.32; 0.92132,
          889.31; 0.98398,889.31; 1.1082,890.29; 1.1712,890.29; 1.3108,
          889.87; 1.3742,888.88; 1.5281,889.13; 1.6504,889.13; 1.729,889.89;
          1.8543,889.89; 1.9478,889.04; 2.0878,889.04; 2.1335,890.23;
          2.2589,890.23; 2.3211,889.33; 2.3834,889.33; 2.5241,889.95;
          2.6796,889.95; 2.743,888.81; 2.8666,888.81; 2.9607,889.56; 3.0999,
          888.75; 3.1929,889.75; 3.3184,889.92; 3.3654,889.92; 3.5065,
          890.55; 3.584,889.56; 3.7244,888.88; 3.7873,888.88; 3.9122,889.6;
          3.9743,889.6; 4.1449,890.23; 4.2847,889.26; 4.3469,889.15; 4.4556,
          889.15; 4.5327,889.36; 4.6734,889.36; 4.7526,890.89; 4.8615,
          890.89; 4.9218,888.55; 5.0575,888.55; 5.1354,913.17; 5.2749,
          912.88; 5.3534,889.66; 5.5094,893.16; 5.5718,887.41; 5.7273,
          887.56; 5.7893,887.55; 5.8975,887.52; 5.9749,887.52; 6.0839,
          887.69; 6.1609,887.7; 6.3026,887.74; 6.3643,887.74; 6.5049,887.67;
          6.5682,887.66; 6.723,887.41; 6.786,887.41; 6.8944,887; 6.9714,887;
          7.0803,886.17; 7.1583,888.07; 7.2998,888.54; 7.3769,887.59;
          7.5016,887.48; 7.563,888.43; 7.6888,888.43; 7.751,888.24; 7.8768,
          888.28],        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.10905,
          608.02; 0.17028,608.02; 0.31029,607.25; 0.3739,607.24; 0.54358,
          607.7; 0.65345,607.71; 0.73186,608.3; 0.85871,608.3; 0.92132,
          607.66; 0.98398,607.66; 1.1082,608.35; 1.1712,608.35; 1.3108,
          608.98; 1.3742,608.28; 1.5281,607.92; 1.6504,607.91; 1.729,606.77;
          1.8543,606.77; 1.9478,608.01; 2.0878,608.01; 2.1335,608.39;
          2.2589,608.39; 2.3211,607.6; 2.3834,607.6; 2.5241,608.81; 2.6796,
          608.81; 2.743,608.38; 2.8666,608.38; 2.9607,607.23; 3.0999,608.41;
          3.1929,609.12; 3.3184,608.85; 3.3654,608.85; 3.5065,607.93; 3.584,
          607.23; 3.7244,608.27; 3.7873,608.27; 3.9122,609.33; 3.9743,
          609.33; 4.1449,608.39; 4.2847,607.71; 4.3469,607.85; 4.4556,
          607.85; 4.5327,607.55; 4.6734,607.55; 4.7526,609.51; 4.8615,
          609.51; 4.9218,606.63; 5.0575,606.63; 5.1354,613.26; 5.2749,
          613.69; 5.3534,626.93; 5.5094,621.94; 5.5718,617.93; 5.7273,
          617.72; 5.7893,617.72; 5.8975,617.77; 5.9749,617.77; 6.0839,
          617.51; 6.1609,617.52; 6.3026,617.47; 6.3643,617.47; 6.5049,
          617.57; 6.5682,617.57; 6.723,617.93; 6.786,617.93; 6.8944,616.51;
          6.9714,616.51; 7.0803,617.69; 7.1583,619.03; 7.2998,618.35;
          7.3769,617.67; 7.5016,617.83; 7.563,618.51; 7.6888,618.51; 7.751,
          618.76; 7.8768,618.71],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.10905,1; 0.17028,1;
          0.31029,1; 0.3739,0.99999; 0.54358,0.99999; 0.65345,1; 0.73186,1;
          0.85871,1; 0.92132,1; 0.98398,1; 1.1082,1; 1.1712,1; 1.3108,1;
          1.3742,1; 1.5281,1; 1.6504,1; 1.729,0.99999; 1.8543,0.99999;
          1.9478,0.99999; 2.0878,0.99999; 2.1335,1; 2.2589,1; 2.3211,
          0.99999; 2.3834,0.99999; 2.5241,1; 2.6796,1; 2.743,1; 2.8666,1;
          2.9607,0.99998; 3.0999,0.99998; 3.1929,1; 3.3184,1; 3.3654,1;
          3.5065,1; 3.584,0.99998; 3.7244,1; 3.7873,1; 3.9122,1; 3.9743,1;
          4.1449,1; 4.2847,1; 4.3469,0.99999; 4.4556,0.99999; 4.5327,
          0.99999; 4.6734,0.99999; 4.7526,1; 4.8615,1; 4.9218,0.99998;
          5.0575,0.99998; 5.1354,0.99721; 5.2749,0.99721; 5.3534,0.97313;
          5.5094,0.97313; 5.5718,0.97302; 5.7273,0.97302; 5.7893,0.97302;
          5.8975,0.97302; 5.9749,0.97302; 6.0839,0.97302; 6.1609,0.97303;
          6.3026,0.97303; 6.3643,0.97303; 6.5049,0.97303; 6.5682,0.97302;
          6.723,0.97302; 6.786,0.97302; 6.8944,0.97302; 6.9714,0.97302;
          7.0803,0.97302; 7.1583,0.97304; 7.2998,0.97304; 7.3769,0.97302;
          7.5016,0.97302; 7.563,0.97303; 7.6888,0.97303; 7.751,0.97303;
          7.8768,0.97303],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.10905,-0.52401;
          0.17028,-0.52401; 0.31029,-0.52406; 0.3739,-0.52406; 0.54358,-0.52401;
          0.65345,-0.52401; 0.73186,-0.52401; 0.85871,-0.52401; 0.92132,-0.52401;
          0.98398,-0.52401; 1.1082,-0.52401; 1.1712,-0.52401; 1.3108,-0.52401;
          1.3742,-0.52401; 1.5281,-0.52401; 1.6504,-0.52401; 1.729,-0.52401;
          1.8543,-0.52401; 1.9478,-0.52401; 2.0878,-0.52401; 2.1335,-0.52401;
          2.2589,-0.52401; 2.3211,-0.52401; 2.3834,-0.52401; 2.5241,-0.52401;
          2.6796,-0.52401; 2.743,-0.52401; 2.8666,-0.52401; 2.9607,-0.52401;
          3.0999,-0.52401; 3.1929,-0.52401; 3.3184,-0.52401; 3.3654,-0.52401;
          3.5065,-0.52401; 3.584,-0.52401; 3.7244,-0.52401; 3.7873,-0.52401;
          3.9122,-0.52401; 3.9743,-0.52401; 4.1449,-0.52401; 4.2847,-0.52401;
          4.3469,-0.52401; 4.4556,-0.52401; 4.5327,-0.52401; 4.6734,-0.52401;
          4.7526,-0.52401; 4.8615,-0.52401; 4.9218,-0.52401; 5.0575,-0.52401;
          5.1354,-0.52441; 5.2749,-0.52395; 5.3534,-0.52395; 5.5094,-0.52401;
          5.5718,-0.52401; 5.7273,-0.52401; 5.7893,-0.52401; 5.8975,-0.52401;
          5.9749,-0.52401; 6.0839,-0.52406; 6.1609,-0.52406; 6.3026,-0.52401;
          6.3643,-0.52401; 6.5049,-0.52401; 6.5682,-0.52401; 6.723,-0.52406;
          6.786,-0.52406; 6.8944,-0.52401; 6.9714,-0.52401; 7.0803,-0.52401;
          7.1583,-0.52401; 7.2998,-0.52412; 7.3769,-0.52412; 7.5016,-0.52401;
          7.563,-0.52401; 7.6888,-0.52401; 7.751,-0.52401; 7.8768,-0.52406],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[0.10905,
          -1.1238; 0.17028,-1.1238; 0.31029,-1.123; 0.3739,-1.123; 0.54358,
          -1.1235; 0.65345,-1.1235; 0.73186,-1.1234; 0.85871,-1.1234;
          0.92132,-1.1234; 0.98398,-1.1234; 1.1082,-1.1235; 1.1712,-1.1235;
          1.3108,-1.1242; 1.3742,-1.1241; 1.5281,-1.1237; 1.6504,-1.1237;
          1.729,-1.1224; 1.8543,-1.1224; 1.9478,-1.1238; 2.0878,-1.1238;
          2.1335,-1.1235; 2.2589,-1.1235; 2.3211,-1.1234; 2.3834,-1.1234;
          2.5241,-1.124; 2.6796,-1.124; 2.743,-1.1242; 2.8666,-1.1242;
          2.9607,-1.123; 3.0999,-1.1243; 3.1929,-1.1243; 3.3184,-1.124;
          3.3654,-1.124; 3.5065,-1.123; 3.584,-1.123; 3.7244,-1.1241;
          3.7873,-1.1241; 3.9122,-1.1246; 3.9743,-1.1246; 4.1449,-1.1235;
          4.2847,-1.1235; 4.3469,-1.1237; 4.4556,-1.1237; 4.5327,-1.1233;
          4.6734,-1.1233; 4.7526,-1.124; 4.8615,-1.124; 4.9218,-1.123;
          5.0575,-1.123; 5.1354,-1.1158; 5.2749,-1.1158; 5.3534,-1.1378;
          5.5094,-1.1323; 5.5718,-1.1323; 5.7273,-1.132; 5.7893,-1.132;
          5.8975,-1.1321; 5.9749,-1.1321; 6.0839,-1.1319; 6.1609,-1.1319;
          6.3026,-1.1317; 6.3643,-1.1317; 6.5049,-1.1319; 6.5682,-1.1319;
          6.723,-1.1323; 6.786,-1.1323; 6.8944,-1.1314; 6.9714,-1.1314;
          7.0803,-1.1327; 7.1583,-1.1327; 7.2998,-1.1321; 7.3769,-1.1321;
          7.5016,-1.1321; 7.563,-1.1322; 7.6888,-1.1322; 7.751,-1.1325;
          7.8768,-1.1325],                 extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.10905,1; 0.17028,1;
          0.31029,1; 0.3739,0.99999; 0.54358,0.99999; 0.65345,1; 0.73186,1;
          0.85871,1; 0.92132,1; 0.98398,1; 1.1082,1; 1.1712,1; 1.3108,1;
          1.3742,1; 1.5281,1; 1.6504,1; 1.729,0.99999; 1.8543,0.99999;
          1.9478,0.99999; 2.0878,0.99999; 2.1335,1; 2.2589,1; 2.3211,
          0.99999; 2.3834,0.99999; 2.5241,1; 2.6796,1; 2.743,1; 2.8666,1;
          2.9607,0.99998; 3.0999,0.99998; 3.1929,1; 3.3184,1; 3.3654,1;
          3.5065,1; 3.584,0.99998; 3.7244,1; 3.7873,1; 3.9122,1; 3.9743,1;
          4.1449,1; 4.2847,1; 4.3469,0.99999; 4.4556,0.99999; 4.5327,
          0.99999; 4.6734,0.99999; 4.7526,1; 4.8615,1; 4.9218,0.99998;
          5.0575,0.99998; 5.1354,0.99721; 5.2749,0.99721; 5.3534,0.97313;
          5.5094,0.97313; 5.5718,0.97302; 5.7273,0.97302; 5.7893,0.97302;
          5.8975,0.97302; 5.9749,0.97302; 6.0839,0.97302; 6.1609,0.97303;
          6.3026,0.97303; 6.3643,0.97303; 6.5049,0.97303; 6.5682,0.97302;
          6.723,0.97302; 6.786,0.97302; 6.8944,0.97302; 6.9714,0.97302;
          7.0803,0.97302; 7.1583,0.97304; 7.2998,0.97304; 7.3769,0.97302;
          7.5016,0.97302; 7.563,0.97303; 7.6888,0.97303; 7.751,0.97303;
          7.8768,0.97303],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.10905,-0.52401;
          0.17028,-0.52401; 0.31029,-0.52406; 0.3739,-0.52406; 0.54358,-0.52401;
          0.65345,-0.52401; 0.73186,-0.52401; 0.85871,-0.52401; 0.92132,-0.52401;
          0.98398,-0.52401; 1.1082,-0.52401; 1.1712,-0.52401; 1.3108,-0.52401;
          1.3742,-0.52401; 1.5281,-0.52401; 1.6504,-0.52401; 1.729,-0.52401;
          1.8543,-0.52401; 1.9478,-0.52401; 2.0878,-0.52401; 2.1335,-0.52401;
          2.2589,-0.52401; 2.3211,-0.52401; 2.3834,-0.52401; 2.5241,-0.52401;
          2.6796,-0.52401; 2.743,-0.52401; 2.8666,-0.52401; 2.9607,-0.52401;
          3.0999,-0.52401; 3.1929,-0.52401; 3.3184,-0.52401; 3.3654,-0.52401;
          3.5065,-0.52401; 3.584,-0.52401; 3.7244,-0.52401; 3.7873,-0.52401;
          3.9122,-0.52401; 3.9743,-0.52401; 4.1449,-0.52401; 4.2847,-0.52401;
          4.3469,-0.52401; 4.4556,-0.52401; 4.5327,-0.52401; 4.6734,-0.52401;
          4.7526,-0.52401; 4.8615,-0.52401; 4.9218,-0.52401; 5.0575,-0.52401;
          5.1354,-0.52441; 5.2749,-0.52395; 5.3534,-0.52395; 5.5094,-0.52401;
          5.5718,-0.52401; 5.7273,-0.52401; 5.7893,-0.52401; 5.8975,-0.52401;
          5.9749,-0.52401; 6.0839,-0.52406; 6.1609,-0.52406; 6.3026,-0.52401;
          6.3643,-0.52401; 6.5049,-0.52401; 6.5682,-0.52401; 6.723,-0.52406;
          6.786,-0.52406; 6.8944,-0.52401; 6.9714,-0.52401; 7.0803,-0.52401;
          7.1583,-0.52401; 7.2998,-0.52412; 7.3769,-0.52412; 7.5016,-0.52401;
          7.563,-0.52401; 7.6888,-0.52401; 7.751,-0.52401; 7.8768,-0.52406],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.10905,1; 0.17028,1;
          0.31029,1; 0.3739,0.99999; 0.54358,0.99999; 0.65345,1; 0.73186,1;
          0.85871,1; 0.92132,1; 0.98398,1; 1.1082,1; 1.1712,1; 1.3108,1;
          1.3742,1; 1.5281,1; 1.6504,1; 1.729,0.99999; 1.8543,0.99999;
          1.9478,0.99999; 2.0878,0.99999; 2.1335,1; 2.2589,1; 2.3211,
          0.99999; 2.3834,0.99999; 2.5241,1; 2.6796,1; 2.743,1; 2.8666,1;
          2.9607,0.99998; 3.0999,0.99998; 3.1929,1; 3.3184,1; 3.3654,1;
          3.5065,1; 3.584,0.99998; 3.7244,1; 3.7873,1; 3.9122,1; 3.9743,1;
          4.1449,1; 4.2847,1; 4.3469,0.99999; 4.4556,0.99999; 4.5327,
          0.99999; 4.6734,0.99999; 4.7526,1; 4.8615,1; 4.9218,0.99998;
          5.0575,0.99998; 5.1354,0.99721; 5.2749,0.99721; 5.3534,0.97313;
          5.5094,0.97313; 5.5718,0.97302; 5.7273,0.97302; 5.7893,0.97302;
          5.8975,0.97302; 5.9749,0.97302; 6.0839,0.97302; 6.1609,0.97303;
          6.3026,0.97303; 6.3643,0.97303; 6.5049,0.97303; 6.5682,0.97302;
          6.723,0.97302; 6.786,0.97302; 6.8944,0.97302; 6.9714,0.97302;
          7.0803,0.97302; 7.1583,0.97304; 7.2998,0.97304; 7.3769,0.97302;
          7.5016,0.97302; 7.563,0.97303; 7.6888,0.97303; 7.751,0.97303;
          7.8768,0.97303],                 extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.10905,-0.52401;
          0.17028,-0.52401; 0.31029,-0.52406; 0.3739,-0.52406; 0.54358,-0.52401;
          0.65345,-0.52401; 0.73186,-0.52401; 0.85871,-0.52401; 0.92132,-0.52401;
          0.98398,-0.52401; 1.1082,-0.52401; 1.1712,-0.52401; 1.3108,-0.52401;
          1.3742,-0.52401; 1.5281,-0.52401; 1.6504,-0.52401; 1.729,-0.52401;
          1.8543,-0.52401; 1.9478,-0.52401; 2.0878,-0.52401; 2.1335,-0.52401;
          2.2589,-0.52401; 2.3211,-0.52401; 2.3834,-0.52401; 2.5241,-0.52401;
          2.6796,-0.52401; 2.743,-0.52401; 2.8666,-0.52401; 2.9607,-0.52401;
          3.0999,-0.52401; 3.1929,-0.52401; 3.3184,-0.52401; 3.3654,-0.52401;
          3.5065,-0.52401; 3.584,-0.52401; 3.7244,-0.52401; 3.7873,-0.52401;
          3.9122,-0.52401; 3.9743,-0.52401; 4.1449,-0.52401; 4.2847,-0.52401;
          4.3469,-0.52401; 4.4556,-0.52401; 4.5327,-0.52401; 4.6734,-0.52401;
          4.7526,-0.52401; 4.8615,-0.52401; 4.9218,-0.52401; 5.0575,-0.52401;
          5.1354,-0.52441; 5.2749,-0.52395; 5.3534,-0.52395; 5.5094,-0.52401;
          5.5718,-0.52401; 5.7273,-0.52401; 5.7893,-0.52401; 5.8975,-0.52401;
          5.9749,-0.52401; 6.0839,-0.52406; 6.1609,-0.52406; 6.3026,-0.52401;
          6.3643,-0.52401; 6.5049,-0.52401; 6.5682,-0.52401; 6.723,-0.52406;
          6.786,-0.52406; 6.8944,-0.52401; 6.9714,-0.52401; 7.0803,-0.52401;
          7.1583,-0.52401; 7.2998,-0.52412; 7.3769,-0.52412; 7.5016,-0.52401;
          7.563,-0.52401; 7.6888,-0.52401; 7.751,-0.52401; 7.8768,-0.52406],
                                                            extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.10905,3.0398; 0.17028,3.0398; 0.31029,3.0398; 0.3739,3.0398;
          0.54358,3.0398; 0.65345,3.0398; 0.73186,3.0431; 0.85871,3.0431;
          0.92132,3.0398; 0.98398,3.0398; 1.1082,3.0431; 1.1712,3.0431;
          1.3108,3.0431; 1.3742,3.0398; 1.5281,3.0398; 1.6504,3.0398; 1.729,
          3.0398; 1.8543,3.0398; 1.9478,3.0398; 2.0878,3.0398; 2.1335,
          3.0431; 2.2589,3.0431; 2.3211,3.0398; 2.3834,3.0398; 2.5241,
          3.0431; 2.6796,3.0431; 2.743,3.0398; 2.8666,3.0398; 2.9607,3.0398;
          3.0999,3.0398; 3.1929,3.0431; 3.3184,3.0431; 3.3654,3.0431;
          3.5065,3.0431; 3.584,3.0398; 3.7244,3.0398; 3.7873,3.0398; 3.9122,
          3.0431; 3.9743,3.0431; 4.1449,3.0431; 4.2847,3.0398; 4.3469,
          3.0398; 4.4556,3.0398; 4.5327,3.0398; 4.6734,3.0398; 4.7526,
          3.0464; 4.8615,3.0464; 4.9218,3.0365; 5.0575,3.0365; 5.1354,
          3.1131; 5.2749,3.1131; 5.3534,3.1565; 5.5094,3.1565; 5.5718,
          3.1365; 5.7273,3.1365; 5.7893,3.1365; 5.8975,3.1365; 5.9749,
          3.1365; 6.0839,3.1365; 6.1609,3.1365; 6.3026,3.1365; 6.3643,
          3.1365; 6.5049,3.1365; 6.5682,3.1365; 6.723,3.1365; 6.786,3.1365;
          6.8944,3.1332; 6.9714,3.1332; 7.0803,3.1331; 7.1583,3.1398;
          7.2998,3.1398; 7.3769,3.1365; 7.5016,3.1365; 7.563,3.1398; 7.6888,
          3.1398; 7.751,3.1398; 7.8768,3.1398],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.10905,354.33;
          0.17028,354.33; 0.31029,354.33; 0.3739,354.32; 0.54358,354.32;
          0.65345,354.33; 0.73186,354.33; 0.85871,354.33; 0.92132,354.33;
          0.98398,354.33; 1.1082,354.34; 1.1712,354.34; 1.3108,354.34;
          1.3742,354.33; 1.5281,354.33; 1.6504,354.33; 1.729,354.32; 1.8543,
          354.32; 1.9478,354.32; 2.0878,354.32; 2.1335,354.33; 2.2589,
          354.33; 2.3211,354.32; 2.3834,354.32; 2.5241,354.33; 2.6796,
          354.33; 2.743,354.33; 2.8666,354.33; 2.9607,354.32; 3.0999,354.32;
          3.1929,354.34; 3.3184,354.33; 3.3654,354.33; 3.5065,354.33; 3.584,
          354.32; 3.7244,354.33; 3.7873,354.33; 3.9122,354.33; 3.9743,
          354.33; 4.1449,354.33; 4.2847,354.33; 4.3469,354.32; 4.4556,
          354.32; 4.5327,354.32; 4.6734,354.32; 4.7526,354.33; 4.8615,
          354.33; 4.9218,354.32; 5.0575,354.32; 5.1354,353.34; 5.2749,
          353.34; 5.3534,344.8; 5.5094,344.8; 5.5718,344.77; 5.7273,344.77;
          5.7893,344.77; 5.8975,344.77; 5.9749,344.77; 6.0839,344.77;
          6.1609,344.77; 6.3026,344.77; 6.3643,344.77; 6.5049,344.77;
          6.5682,344.77; 6.723,344.77; 6.786,344.77; 6.8944,344.77; 6.9714,
          344.77; 7.0803,344.77; 7.1583,344.77; 7.2998,344.77; 7.3769,
          344.77; 7.5016,344.77; 7.563,344.77; 7.6888,344.77; 7.751,344.77;
          7.8768,344.77], extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_340_V;

  model VoltageVariation_350_to_335_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.080449,
          889.28; 0.21884,889.25; 0.29703,890.12; 0.43621,890.16; 0.49696,
          889.82; 0.63682,889.82; 0.699,889.53; 0.82397,889.53; 0.90103,
          888.89; 1.0398,888.89; 1.0868,889.01; 1.2117,889.01; 1.274,890.03;
          1.3367,890.03; 1.477,888.87; 1.617,888.87; 1.6789,890.14; 1.741,
          890.14; 1.8657,889.36; 1.9288,889.36; 2.0859,889.49; 2.2104,889.5;
          2.2735,889.31; 2.3352,889.31; 2.474,890.94; 2.6147,890.94; 2.677,
          890.19; 2.7397,890.19; 2.8824,889.49; 3.0064,889.49; 3.069,889.13;
          3.2081,889.13; 3.2709,890.88; 3.3179,890.88; 3.4565,889.97;
          3.5356,889.96; 3.676,888.94; 3.7226,888.94; 3.8326,889.52; 3.9111,
          889.5; 4.0521,889.22; 4.1144,889.23; 4.2524,889.05; 4.3134,889.04;
          4.4545,889.55; 4.5308,889.54; 4.6704,888.79; 4.7307,889.77;
          4.8368,890.34; 4.9147,889.37; 5.0407,889.72; 5.1028,919.18;
          5.2442,912.32; 5.3058,887.95; 5.4162,887.95; 5.4784,886.97;
          5.6196,886.97; 5.6836,887.64; 5.8074,887.64; 5.8698,885.89;
          5.9327,885.89; 6.0878,886.9; 6.2448,886.9; 6.2911,887.04; 6.4178,
          887.04; 6.4794,886.94; 6.6184,886.94; 6.6973,887.44; 6.8212,
          887.44; 6.8682,886.3; 6.9301,886.3; 7.0712,886.56; 7.1328,886.55;
          7.2721,886.49; 7.3352,886.49; 7.46,886.28; 7.5375,886.28; 7.662,
          887.4; 7.7239,887.4; 7.8483,887.4; 7.9109,886.46; 8.0519,886.75;
          8.1306,886.73; 8.2377,886.37; 8.2999,887.3; 8.4084,887.3; 8.4695,
          886.38; 8.546,886.38; 8.6856,886.6; 8.7326,886.6; 8.8568,886.37;
          8.9189,886.37; 9.0249,886.19; 9.1028,887.12; 9.2255,887.12;
          9.2876,886.15; 9.4126,886.15; 9.4764,886.48; 9.6322,886.48;
          9.6933,886.7; 9.8162,886.7; 9.8778,886.41; 9.9376,886.41; 10.077,
          886.77; 10.215,886.77; 10.279,886.88; 10.341,886.88; 10.448,
          885.12; 10.509,885.12],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.080449,
          607.65; 0.21884,607.7; 0.29703,608.53; 0.43621,608.48; 0.49696,
          609.01; 0.63682,609.01; 0.699,607.29; 0.82397,607.29; 0.90103,
          608.21; 1.0398,608.21; 1.0868,608.07; 1.2117,608.07; 1.274,608.7;
          1.3367,608.7; 1.477,608.28; 1.617,608.28; 1.6789,608.54; 1.741,
          608.54; 1.8657,607.55; 1.9288,607.55; 2.0859,607.34; 2.2104,
          607.35; 2.2735,607.65; 2.3352,607.65; 2.474,609.47; 2.6147,609.47;
          2.677,608.47; 2.7397,608.47; 2.8824,607.33; 3.0064,607.33; 3.069,
          607.91; 3.2081,607.91; 3.2709,607.46; 3.3179,607.46; 3.4565,
          608.81; 3.5356,608.81; 3.676,608.17; 3.7226,608.17; 3.8326,607.35;
          3.9111,607.34; 4.0521,607.75; 4.1144,607.75; 4.2524,608.01;
          4.3134,608.01; 4.4545,607.29; 4.5308,607.28; 4.6704,608.37;
          4.7307,609.07; 4.8368,608.24; 4.9147,607.55; 5.0407,607.03;
          5.1028,631.9; 5.2442,641.75; 5.3058,624.62; 5.4162,624.62; 5.4784,
          622.09; 5.6196,622.09; 5.6836,623.1; 5.8074,623.1; 5.8698,621.63;
          5.9327,621.63; 6.0878,622.2; 6.2448,622.2; 6.2911,621.99; 6.4178,
          621.99; 6.4794,622.15; 6.6184,622.15; 6.6973,623.42; 6.8212,
          623.42; 6.8682,623.09; 6.9301,623.09; 7.0712,622.72; 7.1328,
          622.72; 7.2721,622.76; 7.3352,622.76; 7.46,623.07; 7.5375,623.07;
          7.662,623.47; 7.7239,623.47; 7.8483,623.47; 7.9109,622.82; 8.0519,
          622.4; 8.1306,622.39; 8.2377,622.91; 8.2999,623.56; 8.4084,623.56;
          8.4695,622.91; 8.546,622.91; 8.6856,622.6; 8.7326,622.6; 8.8568,
          622.9; 8.9189,622.9; 9.0249,623.16; 9.1028,623.81; 9.2255,623.81;
          9.2876,623.21; 9.4126,623.21; 9.4764,622.75; 9.6322,622.75;
          9.6933,622.44; 9.8162,622.44; 9.8778,622.85; 9.9376,622.85;
          10.077,622.34; 10.215,622.34; 10.279,624.18; 10.341,624.18;
          10.448,622.7; 10.509,622.7],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.080449,1; 0.21884,1;
          0.29703,1; 0.43621,1; 0.49696,1; 0.63682,1; 0.699,1; 0.82397,1;
          0.90103,0.99999; 1.0398,0.99999; 1.0868,1; 1.2117,1; 1.274,1;
          1.3367,1; 1.477,1; 1.617,1; 1.6789,1; 1.741,1; 1.8657,1; 1.9288,1;
          2.0859,1; 2.2104,1; 2.2735,1; 2.3352,1; 2.474,1; 2.6147,1; 2.677,
          1; 2.7397,1; 2.8824,0.99999; 3.0064,0.99999; 3.069,1; 3.2081,1;
          3.2709,1; 3.3179,1; 3.4565,1; 3.5356,1; 3.676,1; 3.7226,1; 3.8326,
          1; 3.9111,1; 4.0521,1; 4.1144,1; 4.2524,1; 4.3134,1; 4.4545,1;
          4.5308,1; 4.6704,1; 4.7307,1; 4.8368,1; 4.9147,1; 5.0407,1;
          5.1028,0.97569; 5.2442,0.97569; 5.3058,0.95954; 5.4162,0.95954;
          5.4784,0.95954; 5.6196,0.95954; 5.6836,0.95954; 5.8074,0.95954;
          5.8698,0.95953; 5.9327,0.95953; 6.0878,0.95955; 6.2448,0.95955;
          6.2911,0.95954; 6.4178,0.95954; 6.4794,0.95955; 6.6184,0.95955;
          6.6973,0.95956; 6.8212,0.95956; 6.8682,0.95957; 6.9301,0.95957;
          7.0712,0.95957; 7.1328,0.95956; 7.2721,0.95954; 7.3352,0.95954;
          7.46,0.95955; 7.5375,0.95955; 7.662,0.95956; 7.7239,0.95956;
          7.8483,0.95956; 7.9109,0.95955; 8.0519,0.95955; 8.1306,0.95952;
          8.2377,0.95952; 8.2999,0.95953; 8.4084,0.95953; 8.4695,0.95954;
          8.546,0.95954; 8.6856,0.95954; 8.7326,0.95954; 8.8568,0.95952;
          8.9189,0.95952; 9.0249,0.95952; 9.1028,0.95953; 9.2255,0.95953;
          9.2876,0.95952; 9.4126,0.95952; 9.4764,0.95952; 9.6322,0.95952;
          9.6933,0.95953; 9.8162,0.95953; 9.8778,0.95952; 9.9376,0.95952;
          10.077,0.95952; 10.215,0.95952; 10.279,0.95954; 10.341,0.95954;
          10.448,0.95952; 10.509,0.95952],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.080449,-0.52401;
          0.21884,-0.52395; 0.29703,-0.52395; 0.43621,-0.52401; 0.49696,-0.52401;
          0.63682,-0.52401; 0.699,-0.52401; 0.82397,-0.52401; 0.90103,-0.52401;
          1.0398,-0.52401; 1.0868,-0.52401; 1.2117,-0.52401; 1.274,-0.52401;
          1.3367,-0.52401; 1.477,-0.52401; 1.617,-0.52401; 1.6789,-0.52401;
          1.741,-0.52401; 1.8657,-0.52401; 1.9288,-0.52401; 2.0859,-0.52401;
          2.2104,-0.52401; 2.2735,-0.52395; 2.3352,-0.52395; 2.474,-0.52401;
          2.6147,-0.52401; 2.677,-0.52401; 2.7397,-0.52401; 2.8824,-0.52401;
          3.0064,-0.52401; 3.069,-0.52401; 3.2081,-0.52401; 3.2709,-0.52401;
          3.3179,-0.52401; 3.4565,-0.52401; 3.5356,-0.52401; 3.676,-0.52401;
          3.7226,-0.52401; 3.8326,-0.52401; 3.9111,-0.52401; 4.0521,-0.52401;
          4.1144,-0.52401; 4.2524,-0.52401; 4.3134,-0.52401; 4.4545,-0.52401;
          4.5308,-0.52401; 4.6704,-0.52401; 4.7307,-0.52401; 4.8368,-0.52401;
          4.9147,-0.52401; 5.0407,-0.52459; 5.1028,-0.52459; 5.2442,-0.52401;
          5.3058,-0.52401; 5.4162,-0.52401; 5.4784,-0.52401; 5.6196,-0.52401;
          5.6836,-0.52401; 5.8074,-0.52401; 5.8698,-0.52401; 5.9327,-0.52401;
          6.0878,-0.52401; 6.2448,-0.52401; 6.2911,-0.52401; 6.4178,-0.52401;
          6.4794,-0.52401; 6.6184,-0.52401; 6.6973,-0.52401; 6.8212,-0.52401;
          6.8682,-0.52401; 6.9301,-0.52401; 7.0712,-0.52401; 7.1328,-0.52401;
          7.2721,-0.52401; 7.3352,-0.52401; 7.46,-0.52401; 7.5375,-0.52401;
          7.662,-0.52401; 7.7239,-0.52401; 7.8483,-0.52401; 7.9109,-0.52401;
          8.0519,-0.52401; 8.1306,-0.52401; 8.2377,-0.52401; 8.2999,-0.52401;
          8.4084,-0.52401; 8.4695,-0.52401; 8.546,-0.52401; 8.6856,-0.52401;
          8.7326,-0.52401; 8.8568,-0.52401; 8.9189,-0.52401; 9.0249,-0.52401;
          9.1028,-0.52401; 9.2255,-0.52401; 9.2876,-0.52401; 9.4126,-0.52401;
          9.4764,-0.52401; 9.6322,-0.52401; 9.6933,-0.52401; 9.8162,-0.52401;
          9.8778,-0.52401; 9.9376,-0.52401; 10.077,-0.52401; 10.215,-0.52401;
          10.279,-0.52401; 10.341,-0.52401; 10.448,-0.52401; 10.509,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[
          0.080449,-1.1234; 0.21884,-1.1234; 0.29703,-1.1236; 0.43621,-1.1236;
          0.49696,-1.1242; 0.63682,-1.1242; 0.699,-1.123; 0.82397,-1.123;
          0.90103,-1.1241; 1.0398,-1.1241; 1.0868,-1.1239; 1.2117,-1.1239;
          1.274,-1.1239; 1.3367,-1.1239; 1.477,-1.1241; 1.617,-1.1241;
          1.6789,-1.1237; 1.741,-1.1237; 1.8657,-1.1233; 1.9288,-1.1233;
          2.0859,-1.1231; 2.2104,-1.1231; 2.2735,-1.1234; 2.3352,-1.1234;
          2.474,-1.124; 2.6147,-1.124; 2.677,-1.1236; 2.7397,-1.1236;
          2.8824,-1.1231; 3.0064,-1.1231; 3.069,-1.1237; 3.2081,-1.1237;
          3.2709,-1.1225; 3.3179,-1.1225; 3.4565,-1.124; 3.5356,-1.124;
          3.676,-1.124; 3.7226,-1.124; 3.8326,-1.1231; 3.9111,-1.1231;
          4.0521,-1.1235; 4.1144,-1.1235; 4.2524,-1.1238; 4.3134,-1.1238;
          4.4545,-1.123; 4.5308,-1.123; 4.6704,-1.1242; 4.7307,-1.1243;
          4.8368,-1.1233; 4.9147,-1.1233; 5.0407,-1.1233; 5.1028,-1.1268;
          5.2442,-1.137; 5.3058,-1.137; 5.4162,-1.137; 5.4784,-1.1357;
          5.6196,-1.1357; 5.6836,-1.1361; 5.8074,-1.1361; 5.8698,-1.1359;
          5.9327,-1.1359; 6.0878,-1.1358; 6.2448,-1.1358; 6.2911,-1.1355;
          6.4178,-1.1355; 6.4794,-1.1357; 6.6184,-1.1357; 6.6973,-1.1364;
          6.8212,-1.1364; 6.8682,-1.1368; 6.9301,-1.1368; 7.0712,-1.1363;
          7.1328,-1.1363; 7.2721,-1.1364; 7.3352,-1.1364; 7.46,-1.1368;
          7.5375,-1.1368; 7.662,-1.1365; 7.7239,-1.1365; 7.8483,-1.1365;
          7.9109,-1.1365; 8.0519,-1.136; 8.1306,-1.136; 8.2377,-1.1366;
          8.2999,-1.1366; 8.4084,-1.1366; 8.4695,-1.1366; 8.546,-1.1366;
          8.6856,-1.1362; 8.7326,-1.1362; 8.8568,-1.1366; 8.9189,-1.1366;
          9.0249,-1.1369; 9.1028,-1.1369; 9.2255,-1.1369; 9.2876,-1.1369;
          9.4126,-1.1369; 9.4764,-1.1364; 9.6322,-1.1364; 9.6933,-1.1361;
          9.8162,-1.1361; 9.8778,-1.1365; 9.9376,-1.1365; 10.077,-1.1359;
          10.215,-1.1359; 10.279,-1.1373; 10.341,-1.1373; 10.448,-1.1371;
          10.509,-1.1371],                 extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.080449,1; 0.21884,1;
          0.29703,1; 0.43621,1; 0.49696,1; 0.63682,1; 0.699,1; 0.82397,1;
          0.90103,0.99999; 1.0398,0.99999; 1.0868,1; 1.2117,1; 1.274,1;
          1.3367,1; 1.477,1; 1.617,1; 1.6789,1; 1.741,1; 1.8657,1; 1.9288,1;
          2.0859,1; 2.2104,1; 2.2735,1; 2.3352,1; 2.474,1; 2.6147,1; 2.677,
          1; 2.7397,1; 2.8824,0.99999; 3.0064,0.99999; 3.069,1; 3.2081,1;
          3.2709,1; 3.3179,1; 3.4565,1; 3.5356,1; 3.676,1; 3.7226,1; 3.8326,
          1; 3.9111,1; 4.0521,1; 4.1144,1; 4.2524,1; 4.3134,1; 4.4545,1;
          4.5308,1; 4.6704,1; 4.7307,1; 4.8368,1; 4.9147,1; 5.0407,1;
          5.1028,0.97569; 5.2442,0.97569; 5.3058,0.95954; 5.4162,0.95954;
          5.4784,0.95954; 5.6196,0.95954; 5.6836,0.95954; 5.8074,0.95954;
          5.8698,0.95953; 5.9327,0.95953; 6.0878,0.95955; 6.2448,0.95955;
          6.2911,0.95954; 6.4178,0.95954; 6.4794,0.95955; 6.6184,0.95955;
          6.6973,0.95956; 6.8212,0.95956; 6.8682,0.95957; 6.9301,0.95957;
          7.0712,0.95957; 7.1328,0.95956; 7.2721,0.95954; 7.3352,0.95954;
          7.46,0.95955; 7.5375,0.95955; 7.662,0.95956; 7.7239,0.95956;
          7.8483,0.95956; 7.9109,0.95955; 8.0519,0.95955; 8.1306,0.95952;
          8.2377,0.95952; 8.2999,0.95953; 8.4084,0.95953; 8.4695,0.95954;
          8.546,0.95954; 8.6856,0.95954; 8.7326,0.95954; 8.8568,0.95952;
          8.9189,0.95952; 9.0249,0.95952; 9.1028,0.95953; 9.2255,0.95953;
          9.2876,0.95952; 9.4126,0.95952; 9.4764,0.95952; 9.6322,0.95952;
          9.6933,0.95953; 9.8162,0.95953; 9.8778,0.95952; 9.9376,0.95952;
          10.077,0.95952; 10.215,0.95952; 10.279,0.95954; 10.341,0.95954;
          10.448,0.95952; 10.509,0.95952],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.080449,-0.52401;
          0.21884,-0.52395; 0.29703,-0.52395; 0.43621,-0.52401; 0.49696,-0.52401;
          0.63682,-0.52401; 0.699,-0.52401; 0.82397,-0.52401; 0.90103,-0.52401;
          1.0398,-0.52401; 1.0868,-0.52401; 1.2117,-0.52401; 1.274,-0.52401;
          1.3367,-0.52401; 1.477,-0.52401; 1.617,-0.52401; 1.6789,-0.52401;
          1.741,-0.52401; 1.8657,-0.52401; 1.9288,-0.52401; 2.0859,-0.52401;
          2.2104,-0.52401; 2.2735,-0.52395; 2.3352,-0.52395; 2.474,-0.52401;
          2.6147,-0.52401; 2.677,-0.52401; 2.7397,-0.52401; 2.8824,-0.52401;
          3.0064,-0.52401; 3.069,-0.52401; 3.2081,-0.52401; 3.2709,-0.52401;
          3.3179,-0.52401; 3.4565,-0.52401; 3.5356,-0.52401; 3.676,-0.52401;
          3.7226,-0.52401; 3.8326,-0.52401; 3.9111,-0.52401; 4.0521,-0.52401;
          4.1144,-0.52401; 4.2524,-0.52401; 4.3134,-0.52401; 4.4545,-0.52401;
          4.5308,-0.52401; 4.6704,-0.52401; 4.7307,-0.52401; 4.8368,-0.52401;
          4.9147,-0.52401; 5.0407,-0.52459; 5.1028,-0.52459; 5.2442,-0.52401;
          5.3058,-0.52401; 5.4162,-0.52401; 5.4784,-0.52401; 5.6196,-0.52401;
          5.6836,-0.52401; 5.8074,-0.52401; 5.8698,-0.52401; 5.9327,-0.52401;
          6.0878,-0.52401; 6.2448,-0.52401; 6.2911,-0.52401; 6.4178,-0.52401;
          6.4794,-0.52401; 6.6184,-0.52401; 6.6973,-0.52401; 6.8212,-0.52401;
          6.8682,-0.52401; 6.9301,-0.52401; 7.0712,-0.52401; 7.1328,-0.52401;
          7.2721,-0.52401; 7.3352,-0.52401; 7.46,-0.52401; 7.5375,-0.52401;
          7.662,-0.52401; 7.7239,-0.52401; 7.8483,-0.52401; 7.9109,-0.52401;
          8.0519,-0.52401; 8.1306,-0.52401; 8.2377,-0.52401; 8.2999,-0.52401;
          8.4084,-0.52401; 8.4695,-0.52401; 8.546,-0.52401; 8.6856,-0.52401;
          8.7326,-0.52401; 8.8568,-0.52401; 8.9189,-0.52401; 9.0249,-0.52401;
          9.1028,-0.52401; 9.2255,-0.52401; 9.2876,-0.52401; 9.4126,-0.52401;
          9.4764,-0.52401; 9.6322,-0.52401; 9.6933,-0.52401; 9.8162,-0.52401;
          9.8778,-0.52401; 9.9376,-0.52401; 10.077,-0.52401; 10.215,-0.52401;
          10.279,-0.52401; 10.341,-0.52401; 10.448,-0.52401; 10.509,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.080449,1; 0.21884,1;
          0.29703,1; 0.43621,1; 0.49696,1; 0.63682,1; 0.699,1; 0.82397,1;
          0.90103,0.99999; 1.0398,0.99999; 1.0868,1; 1.2117,1; 1.274,1;
          1.3367,1; 1.477,1; 1.617,1; 1.6789,1; 1.741,1; 1.8657,1; 1.9288,1;
          2.0859,1; 2.2104,1; 2.2735,1; 2.3352,1; 2.474,1; 2.6147,1; 2.677,
          1; 2.7397,1; 2.8824,0.99999; 3.0064,0.99999; 3.069,1; 3.2081,1;
          3.2709,1; 3.3179,1; 3.4565,1; 3.5356,1; 3.676,1; 3.7226,1; 3.8326,
          1; 3.9111,1; 4.0521,1; 4.1144,1; 4.2524,1; 4.3134,1; 4.4545,1;
          4.5308,1; 4.6704,1; 4.7307,1; 4.8368,1; 4.9147,1; 5.0407,1;
          5.1028,0.97569; 5.2442,0.97569; 5.3058,0.95954; 5.4162,0.95954;
          5.4784,0.95954; 5.6196,0.95954; 5.6836,0.95954; 5.8074,0.95954;
          5.8698,0.95953; 5.9327,0.95953; 6.0878,0.95955; 6.2448,0.95955;
          6.2911,0.95954; 6.4178,0.95954; 6.4794,0.95955; 6.6184,0.95955;
          6.6973,0.95956; 6.8212,0.95956; 6.8682,0.95957; 6.9301,0.95957;
          7.0712,0.95957; 7.1328,0.95956; 7.2721,0.95954; 7.3352,0.95954;
          7.46,0.95955; 7.5375,0.95955; 7.662,0.95956; 7.7239,0.95956;
          7.8483,0.95956; 7.9109,0.95955; 8.0519,0.95955; 8.1306,0.95952;
          8.2377,0.95952; 8.2999,0.95953; 8.4084,0.95953; 8.4695,0.95954;
          8.546,0.95954; 8.6856,0.95954; 8.7326,0.95954; 8.8568,0.95952;
          8.9189,0.95952; 9.0249,0.95952; 9.1028,0.95953; 9.2255,0.95953;
          9.2876,0.95952; 9.4126,0.95952; 9.4764,0.95952; 9.6322,0.95952;
          9.6933,0.95953; 9.8162,0.95953; 9.8778,0.95952; 9.9376,0.95952;
          10.077,0.95952; 10.215,0.95952; 10.279,0.95954; 10.341,0.95954;
          10.448,0.95952; 10.509,0.95952], extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.080449,-0.52401;
          0.21884,-0.52395; 0.29703,-0.52395; 0.43621,-0.52401; 0.49696,-0.52401;
          0.63682,-0.52401; 0.699,-0.52401; 0.82397,-0.52401; 0.90103,-0.52401;
          1.0398,-0.52401; 1.0868,-0.52401; 1.2117,-0.52401; 1.274,-0.52401;
          1.3367,-0.52401; 1.477,-0.52401; 1.617,-0.52401; 1.6789,-0.52401;
          1.741,-0.52401; 1.8657,-0.52401; 1.9288,-0.52401; 2.0859,-0.52401;
          2.2104,-0.52401; 2.2735,-0.52395; 2.3352,-0.52395; 2.474,-0.52401;
          2.6147,-0.52401; 2.677,-0.52401; 2.7397,-0.52401; 2.8824,-0.52401;
          3.0064,-0.52401; 3.069,-0.52401; 3.2081,-0.52401; 3.2709,-0.52401;
          3.3179,-0.52401; 3.4565,-0.52401; 3.5356,-0.52401; 3.676,-0.52401;
          3.7226,-0.52401; 3.8326,-0.52401; 3.9111,-0.52401; 4.0521,-0.52401;
          4.1144,-0.52401; 4.2524,-0.52401; 4.3134,-0.52401; 4.4545,-0.52401;
          4.5308,-0.52401; 4.6704,-0.52401; 4.7307,-0.52401; 4.8368,-0.52401;
          4.9147,-0.52401; 5.0407,-0.52459; 5.1028,-0.52459; 5.2442,-0.52401;
          5.3058,-0.52401; 5.4162,-0.52401; 5.4784,-0.52401; 5.6196,-0.52401;
          5.6836,-0.52401; 5.8074,-0.52401; 5.8698,-0.52401; 5.9327,-0.52401;
          6.0878,-0.52401; 6.2448,-0.52401; 6.2911,-0.52401; 6.4178,-0.52401;
          6.4794,-0.52401; 6.6184,-0.52401; 6.6973,-0.52401; 6.8212,-0.52401;
          6.8682,-0.52401; 6.9301,-0.52401; 7.0712,-0.52401; 7.1328,-0.52401;
          7.2721,-0.52401; 7.3352,-0.52401; 7.46,-0.52401; 7.5375,-0.52401;
          7.662,-0.52401; 7.7239,-0.52401; 7.8483,-0.52401; 7.9109,-0.52401;
          8.0519,-0.52401; 8.1306,-0.52401; 8.2377,-0.52401; 8.2999,-0.52401;
          8.4084,-0.52401; 8.4695,-0.52401; 8.546,-0.52401; 8.6856,-0.52401;
          8.7326,-0.52401; 8.8568,-0.52401; 8.9189,-0.52401; 9.0249,-0.52401;
          9.1028,-0.52401; 9.2255,-0.52401; 9.2876,-0.52401; 9.4126,-0.52401;
          9.4764,-0.52401; 9.6322,-0.52401; 9.6933,-0.52401; 9.8162,-0.52401;
          9.8778,-0.52401; 9.9376,-0.52401; 10.077,-0.52401; 10.215,-0.52401;
          10.279,-0.52401; 10.341,-0.52401; 10.448,-0.52401; 10.509,-0.52401],
                                                            extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.080449,3.0398; 0.21884,3.0398; 0.29703,3.0431; 0.43621,3.0431;
          0.49696,3.0431; 0.63682,3.0431; 0.699,3.0398; 0.82397,3.0398;
          0.90103,3.0398; 1.0398,3.0398; 1.0868,3.0398; 1.2117,3.0398;
          1.274,3.0431; 1.3367,3.0431; 1.477,3.0398; 1.617,3.0398; 1.6789,
          3.0431; 1.741,3.0431; 1.8657,3.0398; 1.9288,3.0398; 2.0859,3.0398;
          2.2104,3.0398; 2.2735,3.0398; 2.3352,3.0398; 2.474,3.0464; 2.6147,
          3.0464; 2.677,3.0431; 2.7397,3.0431; 2.8824,3.0398; 3.0064,3.0398;
          3.069,3.0398; 3.2081,3.0398; 3.2709,3.0431; 3.3179,3.0431; 3.4565,
          3.0431; 3.5356,3.0431; 3.676,3.0398; 3.7226,3.0398; 3.8326,3.0398;
          3.9111,3.0398; 4.0521,3.0398; 4.1144,3.0398; 4.2524,3.0398;
          4.3134,3.0398; 4.4545,3.0398; 4.5308,3.0398; 4.6704,3.0398;
          4.7307,3.0431; 4.8368,3.0431; 4.9147,3.0398; 5.0407,3.0398;
          5.1028,3.2265; 5.2442,3.2265; 5.3058,3.1932; 5.4162,3.1932;
          5.4784,3.1865; 5.6196,3.1865; 5.6836,3.1899; 5.8074,3.1899;
          5.8698,3.1832; 5.9327,3.1832; 6.0878,3.1865; 6.2448,3.1865;
          6.2911,3.1865; 6.4178,3.1865; 6.4794,3.1865; 6.6184,3.1865;
          6.6973,3.1899; 6.8212,3.1899; 6.8682,3.1865; 6.9301,3.1865;
          7.0712,3.1865; 7.1328,3.1865; 7.2721,3.1865; 7.3352,3.1865; 7.46,
          3.1865; 7.5375,3.1865; 7.662,3.1898; 7.7239,3.1898; 7.8483,3.1898;
          7.9109,3.1865; 8.0519,3.1865; 8.1306,3.1865; 8.2377,3.1865;
          8.2999,3.1899; 8.4084,3.1899; 8.4695,3.1865; 8.546,3.1865; 8.6856,
          3.1865; 8.7326,3.1865; 8.8568,3.1865; 8.9189,3.1865; 9.0249,
          3.1865; 9.1028,3.1898; 9.2255,3.1898; 9.2876,3.1865; 9.4126,
          3.1865; 9.4764,3.1865; 9.6322,3.1865; 9.6933,3.1865; 9.8162,
          3.1865; 9.8778,3.1865; 9.9376,3.1865; 10.077,3.1865; 10.215,
          3.1865; 10.279,3.1899; 10.341,3.1899; 10.448,3.1832; 10.509,
          3.1832], extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.080449,354.32;
          0.21884,354.32; 0.29703,354.33; 0.43621,354.33; 0.49696,354.33;
          0.63682,354.33; 0.699,354.32; 0.82397,354.32; 0.90103,354.32;
          1.0398,354.32; 1.0868,354.33; 1.2117,354.33; 1.274,354.33; 1.3367,
          354.33; 1.477,354.33; 1.617,354.33; 1.6789,354.33; 1.741,354.33;
          1.8657,354.32; 1.9288,354.32; 2.0859,354.32; 2.2104,354.33;
          2.2735,354.33; 2.3352,354.33; 2.474,354.33; 2.6147,354.33; 2.677,
          354.33; 2.7397,354.33; 2.8824,354.32; 3.0064,354.32; 3.069,354.33;
          3.2081,354.33; 3.2709,354.33; 3.3179,354.33; 3.4565,354.33;
          3.5356,354.33; 3.676,354.33; 3.7226,354.33; 3.8326,354.33; 3.9111,
          354.32; 4.0521,354.32; 4.1144,354.33; 4.2524,354.33; 4.3134,
          354.32; 4.4545,354.32; 4.5308,354.32; 4.6704,354.32; 4.7307,
          354.33; 4.8368,354.33; 4.9147,354.32; 5.0407,354.32; 5.1028,
          345.71; 5.2442,345.71; 5.3058,339.99; 5.4162,339.99; 5.4784,
          339.99; 5.6196,339.99; 5.6836,339.99; 5.8074,339.99; 5.8698,
          339.98; 5.9327,339.98; 6.0878,339.99; 6.2448,339.99; 6.2911,
          339.99; 6.4178,339.99; 6.4794,339.99; 6.6184,339.99; 6.6973,
          339.99; 6.8212,339.99; 6.8682,340; 6.9301,340; 7.0712,340; 7.1328,
          339.99; 7.2721,339.99; 7.3352,339.99; 7.46,339.99; 7.5375,339.99;
          7.662,339.99; 7.7239,339.99; 7.8483,339.99; 7.9109,339.99; 8.0519,
          339.99; 8.1306,339.98; 8.2377,339.98; 8.2999,339.98; 8.4084,
          339.98; 8.4695,339.99; 8.546,339.99; 8.6856,339.99; 8.7326,339.99;
          8.8568,339.98; 8.9189,339.98; 9.0249,339.98; 9.1028,339.98;
          9.2255,339.98; 9.2876,339.98; 9.4126,339.98; 9.4764,339.98;
          9.6322,339.98; 9.6933,339.98; 9.8162,339.98; 9.8778,339.98;
          9.9376,339.98; 10.077,339.98; 10.215,339.98; 10.279,339.99;
          10.341,339.99; 10.448,339.98; 10.509,339.98],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_335_V;

  model VoltageVariation_350_to_330_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.1315,
          889.77; 0.17779,889.77; 0.31613,888.95; 0.37821,888.95; 0.48649,
          889.67; 0.5345,888.7; 0.66053,888.7; 0.74055,890.25; 0.88155,
          890.25; 0.94375,890.19; 1.0853,890.19; 1.1483,890.05; 1.3031,
          890.29; 1.3658,889.32; 1.4732,888.29; 1.5354,889.27; 1.6574,
          889.27; 1.7362,889.49; 1.7829,889.49; 1.9224,889.11; 1.9854,
          889.11; 2.1263,890.75; 2.1892,890.75; 2.3287,889.1; 2.4519,889.1;
          2.5149,890.38; 2.5772,890.38; 2.7172,889.67; 2.8572,889.66; 2.92,
          888.92; 2.983,888.92; 3.1216,889.87; 3.1686,889.87; 3.3263,889.98;
          3.3872,889.01; 3.4982,888.94; 3.5606,888.94; 3.6846,888.94;
          3.7625,890.1; 3.9023,890.32; 3.9658,889.33; 4.0898,889.5; 4.1514,
          889.49; 4.2926,889.49; 4.3557,889.83; 4.4647,889.83; 4.5267,
          889.38; 4.6495,889.38; 4.7408,915.87; 4.8767,916.01; 4.9367,
          899.73; 5.076,899.73; 5.1382,887.22; 5.2952,887.19; 5.3413,886.49;
          5.4658,886.49; 5.5451,885.21; 5.6549,885.21; 5.7328,885.4; 5.8727,
          885.4; 5.9357,885.79; 5.9826,885.79; 6.105,885.46; 6.1514,885.46;
          6.2914,885.46; 6.3524,885.9; 6.4761,885.79; 6.5537,885.79; 6.6954,
          885.61; 6.7588,885.59; 6.8844,885.89; 6.9623,885.89; 7.0855,
          885.49; 7.1333,886.41; 7.2726,886.37; 7.3348,885.62; 7.4924,
          885.66; 7.5559,885.48; 7.6977,885.4; 7.7767,885.4; 7.8877,885.58;
          7.9491,885.58; 8.0867,885.55; 8.1497,885.95; 8.3168,886.27;
          8.3793,885.35; 8.4871,885.72; 8.5497,886.64],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.1315,
          609.06; 0.17779,609.06; 0.31613,608.11; 0.37821,608.11; 0.48649,
          607.08; 0.5345,606.42; 0.66053,606.42; 0.74055,608.32; 0.88155,
          608.32; 0.94375,608.44; 1.0853,608.44; 1.1483,608.64; 1.3031,
          608.28; 1.3658,607.6; 1.4732,609.09; 1.5354,609.78; 1.6574,609.78;
          1.7362,607.33; 1.7829,607.33; 1.9224,607.9; 1.9854,607.9; 2.1263,
          609.71; 2.1892,609.71; 2.3287,607.91; 2.4519,607.91; 2.5149,
          608.19; 2.5772,608.19; 2.7172,609.22; 2.8572,609.22; 2.92,608.16;
          2.983,608.16; 3.1216,608.89; 3.1686,608.89; 3.3263,608.75; 3.3872,
          608.07; 3.4982,608.17; 3.5606,608.17; 3.6846,608.17; 3.7625,
          608.57; 3.9023,608.25; 3.9658,607.59; 4.0898,607.34; 4.1514,
          607.34; 4.2926,607.34; 4.3557,608.95; 4.4647,608.95; 4.5267,
          607.49; 4.6495,607.49; 4.7408,622.07; 4.8767,621.86; 4.9367,
          640.16; 5.076,640.16; 5.1382,626.27; 5.2952,626.32; 5.3413,627.37;
          5.4658,627.37; 5.5451,627.25; 5.6549,627.25; 5.7328,626.99;
          5.8727,626.99; 5.9357,626.42; 5.9826,626.42; 6.105,626.88; 6.1514,
          626.88; 6.2914,626.88; 6.3524,626.28; 6.4761,626.43; 6.5537,
          626.43; 6.6954,626.68; 6.7588,626.67; 6.8844,626.26; 6.9623,
          626.26; 7.0855,626.83; 7.1333,627.47; 7.2726,627.52; 7.3348,
          626.62; 7.4924,626.56; 7.5559,626.82; 7.6977,626.93; 7.7767,
          626.92; 7.8877,626.66; 7.9491,626.66; 8.0867,626.72; 8.1497,628.1;
          8.3168,627.63; 8.3793,626.97; 8.4871,626.46; 8.5497,627.09],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.1315,1; 0.17779,1;
          0.31613,0.99998; 0.37821,0.99998; 0.48649,0.99998; 0.5345,0.99998;
          0.66053,0.99998; 0.74055,0.99999; 0.88155,0.99999; 0.94375,1;
          1.0853,1; 1.1483,0.99999; 1.3031,0.99999; 1.3658,0.99999; 1.4732,
          0.99999; 1.5354,1; 1.6574,1; 1.7362,0.99998; 1.7829,0.99998;
          1.9224,0.99999; 1.9854,0.99999; 2.1263,1; 2.1892,1; 2.3287,
          0.99998; 2.4519,0.99998; 2.5149,1; 2.5772,1; 2.7172,1; 2.8572,1;
          2.92,0.99998; 2.983,0.99998; 3.1216,0.99999; 3.1686,0.99999;
          3.3263,0.99999; 3.3872,0.99999; 3.4982,1; 3.5606,1; 3.6846,1;
          3.7625,0.99999; 3.9023,0.99999; 3.9658,0.99999; 4.0898,0.99999;
          4.1514,0.99998; 4.2926,0.99998; 4.3557,1; 4.4647,1; 4.5267,
          0.99998; 4.6495,0.99998; 4.7408,0.99732; 4.8767,0.99732; 4.9367,
          0.94631; 5.076,0.94631; 5.1382,0.94601; 5.2952,0.94601; 5.3413,
          0.94603; 5.4658,0.94603; 5.5451,0.94604; 5.6549,0.94604; 5.7328,
          0.94604; 5.8727,0.94604; 5.9357,0.94603; 5.9826,0.94603; 6.105,
          0.94603; 6.1514,0.94603; 6.2914,0.94603; 6.3524,0.94604; 6.4761,
          0.94604; 6.5537,0.94604; 6.6954,0.94604; 6.7588,0.94602; 6.8844,
          0.94602; 6.9623,0.94603; 7.0855,0.94603; 7.1333,0.94603; 7.2726,
          0.94603; 7.3348,0.94602; 7.4924,0.94602; 7.5559,0.94602; 7.6977,
          0.94602; 7.7767,0.94601; 7.8877,0.94601; 7.9491,0.94601; 8.0867,
          0.94601; 8.1497,0.94602; 8.3168,0.94602; 8.3793,0.946; 8.4871,
          0.946; 8.5497,0.946],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.1315,-1.1242; 0.17779,
          -1.1242; 0.31613,-1.124; 0.37821,-1.124; 0.48649,-1.1228; 0.5345,
          -1.1228; 0.66053,-1.1228; 0.74055,-1.1234; 0.88155,-1.1234;
          0.94375,-1.1236; 1.0853,-1.1236; 1.1483,-1.1238; 1.3031,-1.1234;
          1.3658,-1.1234; 1.4732,-1.1251; 1.5354,-1.1251; 1.6574,-1.1251;
          1.7362,-1.1231; 1.7829,-1.1231; 1.9224,-1.1237; 1.9854,-1.1237;
          2.1263,-1.1242; 2.1892,-1.1242; 2.3287,-1.1237; 2.4519,-1.1237;
          2.5149,-1.1233; 2.5772,-1.1233; 2.7172,-1.1244; 2.8572,-1.1244;
          2.92,-1.124; 2.983,-1.124; 3.1216,-1.124; 3.1686,-1.124; 3.3263,-1.1239;
          3.3872,-1.1239; 3.4982,-1.124; 3.5606,-1.124; 3.6846,-1.124;
          3.7625,-1.1237; 3.9023,-1.1234; 3.9658,-1.1234; 4.0898,-1.1231;
          4.1514,-1.1231; 4.2926,-1.1231; 4.3557,-1.1241; 4.4647,-1.1241;
          4.5267,-1.1233; 4.6495,-1.1233; 4.7408,-1.1208; 4.8767,-1.1208;
          4.9367,-1.1428; 5.076,-1.1428; 5.1382,-1.1387; 5.2952,-1.1387;
          5.3413,-1.1399; 5.4658,-1.1399; 5.5451,-1.1405; 5.6549,-1.1405;
          5.7328,-1.1402; 5.8727,-1.1402; 5.9357,-1.1395; 5.9826,-1.1395;
          6.105,-1.1401; 6.1514,-1.1401; 6.2914,-1.1401; 6.3524,-1.1394;
          6.4761,-1.1395; 6.5537,-1.1395; 6.6954,-1.1398; 6.7588,-1.1398;
          6.8844,-1.1394; 6.9623,-1.1394; 7.0855,-1.14; 7.1333,-1.14;
          7.2726,-1.14; 7.3348,-1.1397; 7.4924,-1.1397; 7.5559,-1.14;
          7.6977,-1.1401; 7.7767,-1.1401; 7.8877,-1.1398; 7.9491,-1.1398;
          8.0867,-1.1398; 8.1497,-1.1407; 8.3168,-1.1401; 8.3793,-1.1401;
          8.4871,-1.1396; 8.5497,-1.1396],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[0.1315,
          -1.1242; 0.17779,-1.1242; 0.31613,-1.124; 0.37821,-1.124; 0.48649,
          -1.1228; 0.5345,-1.1228; 0.66053,-1.1228; 0.74055,-1.1234;
          0.88155,-1.1234; 0.94375,-1.1236; 1.0853,-1.1236; 1.1483,-1.1238;
          1.3031,-1.1234; 1.3658,-1.1234; 1.4732,-1.1251; 1.5354,-1.1251;
          1.6574,-1.1251; 1.7362,-1.1231; 1.7829,-1.1231; 1.9224,-1.1237;
          1.9854,-1.1237; 2.1263,-1.1242; 2.1892,-1.1242; 2.3287,-1.1237;
          2.4519,-1.1237; 2.5149,-1.1233; 2.5772,-1.1233; 2.7172,-1.1244;
          2.8572,-1.1244; 2.92,-1.124; 2.983,-1.124; 3.1216,-1.124; 3.1686,
          -1.124; 3.3263,-1.1239; 3.3872,-1.1239; 3.4982,-1.124; 3.5606,-1.124;
          3.6846,-1.124; 3.7625,-1.1237; 3.9023,-1.1234; 3.9658,-1.1234;
          4.0898,-1.1231; 4.1514,-1.1231; 4.2926,-1.1231; 4.3557,-1.1241;
          4.4647,-1.1241; 4.5267,-1.1233; 4.6495,-1.1233; 4.7408,-1.1208;
          4.8767,-1.1208; 4.9367,-1.1428; 5.076,-1.1428; 5.1382,-1.1387;
          5.2952,-1.1387; 5.3413,-1.1399; 5.4658,-1.1399; 5.5451,-1.1405;
          5.6549,-1.1405; 5.7328,-1.1402; 5.8727,-1.1402; 5.9357,-1.1395;
          5.9826,-1.1395; 6.105,-1.1401; 6.1514,-1.1401; 6.2914,-1.1401;
          6.3524,-1.1394; 6.4761,-1.1395; 6.5537,-1.1395; 6.6954,-1.1398;
          6.7588,-1.1398; 6.8844,-1.1394; 6.9623,-1.1394; 7.0855,-1.14;
          7.1333,-1.14; 7.2726,-1.14; 7.3348,-1.1397; 7.4924,-1.1397;
          7.5559,-1.14; 7.6977,-1.1401; 7.7767,-1.1401; 7.8877,-1.1398;
          7.9491,-1.1398; 8.0867,-1.1398; 8.1497,-1.1407; 8.3168,-1.1401;
          8.3793,-1.1401; 8.4871,-1.1396; 8.5497,-1.1396],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.1315,1; 0.17779,1;
          0.31613,0.99998; 0.37821,0.99998; 0.48649,0.99998; 0.5345,0.99998;
          0.66053,0.99998; 0.74055,0.99999; 0.88155,0.99999; 0.94375,1;
          1.0853,1; 1.1483,0.99999; 1.3031,0.99999; 1.3658,0.99999; 1.4732,
          0.99999; 1.5354,1; 1.6574,1; 1.7362,0.99998; 1.7829,0.99998;
          1.9224,0.99999; 1.9854,0.99999; 2.1263,1; 2.1892,1; 2.3287,
          0.99998; 2.4519,0.99998; 2.5149,1; 2.5772,1; 2.7172,1; 2.8572,1;
          2.92,0.99998; 2.983,0.99998; 3.1216,0.99999; 3.1686,0.99999;
          3.3263,0.99999; 3.3872,0.99999; 3.4982,1; 3.5606,1; 3.6846,1;
          3.7625,0.99999; 3.9023,0.99999; 3.9658,0.99999; 4.0898,0.99999;
          4.1514,0.99998; 4.2926,0.99998; 4.3557,1; 4.4647,1; 4.5267,
          0.99998; 4.6495,0.99998; 4.7408,0.99732; 4.8767,0.99732; 4.9367,
          0.94631; 5.076,0.94631; 5.1382,0.94601; 5.2952,0.94601; 5.3413,
          0.94603; 5.4658,0.94603; 5.5451,0.94604; 5.6549,0.94604; 5.7328,
          0.94604; 5.8727,0.94604; 5.9357,0.94603; 5.9826,0.94603; 6.105,
          0.94603; 6.1514,0.94603; 6.2914,0.94603; 6.3524,0.94604; 6.4761,
          0.94604; 6.5537,0.94604; 6.6954,0.94604; 6.7588,0.94602; 6.8844,
          0.94602; 6.9623,0.94603; 7.0855,0.94603; 7.1333,0.94603; 7.2726,
          0.94603; 7.3348,0.94602; 7.4924,0.94602; 7.5559,0.94602; 7.6977,
          0.94602; 7.7767,0.94601; 7.8877,0.94601; 7.9491,0.94601; 8.0867,
          0.94601; 8.1497,0.94602; 8.3168,0.94602; 8.3793,0.946; 8.4871,
          0.946; 8.5497,0.946],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.1315,-1.1242;
          0.17779,-1.1242; 0.31613,-1.124; 0.37821,-1.124; 0.48649,-1.1228;
          0.5345,-1.1228; 0.66053,-1.1228; 0.74055,-1.1234; 0.88155,-1.1234;
          0.94375,-1.1236; 1.0853,-1.1236; 1.1483,-1.1238; 1.3031,-1.1234;
          1.3658,-1.1234; 1.4732,-1.1251; 1.5354,-1.1251; 1.6574,-1.1251;
          1.7362,-1.1231; 1.7829,-1.1231; 1.9224,-1.1237; 1.9854,-1.1237;
          2.1263,-1.1242; 2.1892,-1.1242; 2.3287,-1.1237; 2.4519,-1.1237;
          2.5149,-1.1233; 2.5772,-1.1233; 2.7172,-1.1244; 2.8572,-1.1244;
          2.92,-1.124; 2.983,-1.124; 3.1216,-1.124; 3.1686,-1.124; 3.3263,-1.1239;
          3.3872,-1.1239; 3.4982,-1.124; 3.5606,-1.124; 3.6846,-1.124;
          3.7625,-1.1237; 3.9023,-1.1234; 3.9658,-1.1234; 4.0898,-1.1231;
          4.1514,-1.1231; 4.2926,-1.1231; 4.3557,-1.1241; 4.4647,-1.1241;
          4.5267,-1.1233; 4.6495,-1.1233; 4.7408,-1.1208; 4.8767,-1.1208;
          4.9367,-1.1428; 5.076,-1.1428; 5.1382,-1.1387; 5.2952,-1.1387;
          5.3413,-1.1399; 5.4658,-1.1399; 5.5451,-1.1405; 5.6549,-1.1405;
          5.7328,-1.1402; 5.8727,-1.1402; 5.9357,-1.1395; 5.9826,-1.1395;
          6.105,-1.1401; 6.1514,-1.1401; 6.2914,-1.1401; 6.3524,-1.1394;
          6.4761,-1.1395; 6.5537,-1.1395; 6.6954,-1.1398; 6.7588,-1.1398;
          6.8844,-1.1394; 6.9623,-1.1394; 7.0855,-1.14; 7.1333,-1.14;
          7.2726,-1.14; 7.3348,-1.1397; 7.4924,-1.1397; 7.5559,-1.14;
          7.6977,-1.1401; 7.7767,-1.1401; 7.8877,-1.1398; 7.9491,-1.1398;
          8.0867,-1.1398; 8.1497,-1.1407; 8.3168,-1.1401; 8.3793,-1.1401;
          8.4871,-1.1396; 8.5497,-1.1396],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.1315,1; 0.17779,1;
          0.31613,0.99998; 0.37821,0.99998; 0.48649,0.99998; 0.5345,0.99998;
          0.66053,0.99998; 0.74055,0.99999; 0.88155,0.99999; 0.94375,1;
          1.0853,1; 1.1483,0.99999; 1.3031,0.99999; 1.3658,0.99999; 1.4732,
          0.99999; 1.5354,1; 1.6574,1; 1.7362,0.99998; 1.7829,0.99998;
          1.9224,0.99999; 1.9854,0.99999; 2.1263,1; 2.1892,1; 2.3287,
          0.99998; 2.4519,0.99998; 2.5149,1; 2.5772,1; 2.7172,1; 2.8572,1;
          2.92,0.99998; 2.983,0.99998; 3.1216,0.99999; 3.1686,0.99999;
          3.3263,0.99999; 3.3872,0.99999; 3.4982,1; 3.5606,1; 3.6846,1;
          3.7625,0.99999; 3.9023,0.99999; 3.9658,0.99999; 4.0898,0.99999;
          4.1514,0.99998; 4.2926,0.99998; 4.3557,1; 4.4647,1; 4.5267,
          0.99998; 4.6495,0.99998; 4.7408,0.99732; 4.8767,0.99732; 4.9367,
          0.94631; 5.076,0.94631; 5.1382,0.94601; 5.2952,0.94601; 5.3413,
          0.94603; 5.4658,0.94603; 5.5451,0.94604; 5.6549,0.94604; 5.7328,
          0.94604; 5.8727,0.94604; 5.9357,0.94603; 5.9826,0.94603; 6.105,
          0.94603; 6.1514,0.94603; 6.2914,0.94603; 6.3524,0.94604; 6.4761,
          0.94604; 6.5537,0.94604; 6.6954,0.94604; 6.7588,0.94602; 6.8844,
          0.94602; 6.9623,0.94603; 7.0855,0.94603; 7.1333,0.94603; 7.2726,
          0.94603; 7.3348,0.94602; 7.4924,0.94602; 7.5559,0.94602; 7.6977,
          0.94602; 7.7767,0.94601; 7.8877,0.94601; 7.9491,0.94601; 8.0867,
          0.94601; 8.1497,0.94602; 8.3168,0.94602; 8.3793,0.946; 8.4871,
          0.946; 8.5497,0.946],            extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.1315,-1.1242;
          0.17779,-1.1242; 0.31613,-1.124; 0.37821,-1.124; 0.48649,-1.1228;
          0.5345,-1.1228; 0.66053,-1.1228; 0.74055,-1.1234; 0.88155,-1.1234;
          0.94375,-1.1236; 1.0853,-1.1236; 1.1483,-1.1238; 1.3031,-1.1234;
          1.3658,-1.1234; 1.4732,-1.1251; 1.5354,-1.1251; 1.6574,-1.1251;
          1.7362,-1.1231; 1.7829,-1.1231; 1.9224,-1.1237; 1.9854,-1.1237;
          2.1263,-1.1242; 2.1892,-1.1242; 2.3287,-1.1237; 2.4519,-1.1237;
          2.5149,-1.1233; 2.5772,-1.1233; 2.7172,-1.1244; 2.8572,-1.1244;
          2.92,-1.124; 2.983,-1.124; 3.1216,-1.124; 3.1686,-1.124; 3.3263,-1.1239;
          3.3872,-1.1239; 3.4982,-1.124; 3.5606,-1.124; 3.6846,-1.124;
          3.7625,-1.1237; 3.9023,-1.1234; 3.9658,-1.1234; 4.0898,-1.1231;
          4.1514,-1.1231; 4.2926,-1.1231; 4.3557,-1.1241; 4.4647,-1.1241;
          4.5267,-1.1233; 4.6495,-1.1233; 4.7408,-1.1208; 4.8767,-1.1208;
          4.9367,-1.1428; 5.076,-1.1428; 5.1382,-1.1387; 5.2952,-1.1387;
          5.3413,-1.1399; 5.4658,-1.1399; 5.5451,-1.1405; 5.6549,-1.1405;
          5.7328,-1.1402; 5.8727,-1.1402; 5.9357,-1.1395; 5.9826,-1.1395;
          6.105,-1.1401; 6.1514,-1.1401; 6.2914,-1.1401; 6.3524,-1.1394;
          6.4761,-1.1395; 6.5537,-1.1395; 6.6954,-1.1398; 6.7588,-1.1398;
          6.8844,-1.1394; 6.9623,-1.1394; 7.0855,-1.14; 7.1333,-1.14;
          7.2726,-1.14; 7.3348,-1.1397; 7.4924,-1.1397; 7.5559,-1.14;
          7.6977,-1.1401; 7.7767,-1.1401; 7.8877,-1.1398; 7.9491,-1.1398;
          8.0867,-1.1398; 8.1497,-1.1407; 8.3168,-1.1401; 8.3793,-1.1401;
          8.4871,-1.1396; 8.5497,-1.1396],                  extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.1315,3.0431; 0.17779,3.0431; 0.31613,3.0398; 0.37821,3.0398;
          0.48649,3.0398; 0.5345,3.0365; 0.66053,3.0365; 0.74055,3.0431;
          0.88155,3.0431; 0.94375,3.0431; 1.0853,3.0431; 1.1483,3.0431;
          1.3031,3.0431; 1.3658,3.0398; 1.4732,3.0398; 1.5354,3.0431;
          1.6574,3.0431; 1.7362,3.0398; 1.7829,3.0398; 1.9224,3.0398;
          1.9854,3.0398; 2.1263,3.0464; 2.1892,3.0464; 2.3287,3.0398;
          2.4519,3.0398; 2.5149,3.0431; 2.5772,3.0431; 2.7172,3.0431;
          2.8572,3.0431; 2.92,3.0398; 2.983,3.0398; 3.1216,3.0431; 3.1686,
          3.0431; 3.3263,3.0431; 3.3872,3.0398; 3.4982,3.0398; 3.5606,
          3.0398; 3.6846,3.0398; 3.7625,3.0431; 3.9023,3.0431; 3.9658,
          3.0398; 4.0898,3.0398; 4.1514,3.0398; 4.2926,3.0398; 4.3557,
          3.0431; 4.4647,3.0431; 4.5267,3.0398; 4.6495,3.0398; 4.7408,
          3.1331; 4.8767,3.1331; 4.9367,3.2932; 5.076,3.2932; 5.1382,3.2399;
          5.2952,3.2399; 5.3413,3.2399; 5.4658,3.2399; 5.5451,3.2365;
          5.6549,3.2365; 5.7328,3.2365; 5.8727,3.2365; 5.9357,3.2365;
          5.9826,3.2365; 6.105,3.2365; 6.1514,3.2365; 6.2914,3.2365; 6.3524,
          3.2365; 6.4761,3.2365; 6.5537,3.2365; 6.6954,3.2365; 6.7588,
          3.2365; 6.8844,3.2366; 6.9623,3.2366; 7.0855,3.2366; 7.1333,
          3.2399; 7.2726,3.2399; 7.3348,3.2365; 7.4924,3.2365; 7.5559,
          3.2365; 7.6977,3.2365; 7.7767,3.2365; 7.8877,3.2365; 7.9491,
          3.2365; 8.0867,3.2365; 8.1497,3.2399; 8.3168,3.2399; 8.3793,
          3.2365; 8.4871,3.2366; 8.5497,3.2399],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.1315,354.33;
          0.17779,354.33; 0.31613,354.32; 0.37821,354.32; 0.48649,354.32;
          0.5345,354.32; 0.66053,354.32; 0.74055,354.32; 0.88155,354.32;
          0.94375,354.33; 1.0853,354.33; 1.1483,354.32; 1.3031,354.32;
          1.3658,354.32; 1.4732,354.32; 1.5354,354.33; 1.6574,354.33;
          1.7362,354.32; 1.7829,354.32; 1.9224,354.32; 1.9854,354.32;
          2.1263,354.33; 2.1892,354.33; 2.3287,354.32; 2.4519,354.32;
          2.5149,354.33; 2.5772,354.33; 2.7172,354.33; 2.8572,354.33; 2.92,
          354.32; 2.983,354.32; 3.1216,354.32; 3.1686,354.32; 3.3263,354.32;
          3.3872,354.32; 3.4982,354.33; 3.5606,354.33; 3.6846,354.33;
          3.7625,354.32; 3.9023,354.32; 3.9658,354.32; 4.0898,354.32;
          4.1514,354.32; 4.2926,354.32; 4.3557,354.33; 4.4647,354.33;
          4.5267,354.32; 4.6495,354.32; 4.7408,353.38; 4.8767,353.38;
          4.9367,335.3; 5.076,335.3; 5.1382,335.2; 5.2952,335.2; 5.3413,
          335.2; 5.4658,335.2; 5.5451,335.21; 5.6549,335.21; 5.7328,335.21;
          5.8727,335.21; 5.9357,335.2; 5.9826,335.2; 6.105,335.2; 6.1514,
          335.2; 6.2914,335.2; 6.3524,335.21; 6.4761,335.21; 6.5537,335.21;
          6.6954,335.21; 6.7588,335.2; 6.8844,335.2; 6.9623,335.2; 7.0855,
          335.2; 7.1333,335.2; 7.2726,335.2; 7.3348,335.2; 7.4924,335.2;
          7.5559,335.2; 7.6977,335.2; 7.7767,335.2; 7.8877,335.2; 7.9491,
          335.2; 8.0867,335.2; 8.1497,335.2; 8.3168,335.2; 8.3793,335.19;
          8.4871,335.19; 8.5497,335.19],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_330_V;
end Over085PowerFactor;
