within OpenRESV.RES_Model_vs_PHIL_Inverter.ConstantPFTerminalVoltageVariance;
package Over090PowerFactor
  "Model validation for inverter experiment with constant power factor mode - 0.90 Overexcited."
  model VoltageVariation_350_to_340_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.16198,
          905.77; 0.20755,905.77; 0.33167,904.71; 0.40958,904.71; 0.54903,
          904.04; 0.6887,904.04; 0.75006,903.78; 0.81331,903.78; 0.95333,
          904.93; 1.0944,904.93; 1.1719,905.33; 1.3129,905.33; 1.3758,
          904.56; 1.5169,904.56; 1.5789,904.65; 1.7037,904.47; 1.767,904.46;
          1.8926,904.46; 1.9549,905; 2.0172,905; 2.1577,904.82; 2.2797,
          904.82; 2.3432,902.8; 2.4047,902.8; 2.5458,902.69; 2.6078,904.8;
          2.73,906.02; 2.7937,906.02; 2.9022,905.46; 2.9642,904.43; 3.1196,
          904.43; 3.1675,904.83; 3.2921,904.83; 3.3544,903; 3.477,903;
          3.5543,903.62; 3.6935,903.65; 3.7699,905.13; 3.8782,905.13;
          3.9405,905.42; 4.0023,905.42; 4.1261,905.66; 4.1881,903.57;
          4.3119,904.34; 4.374,904.33; 4.5148,904.33; 4.5783,904.86; 4.7024,
          904.95; 4.7803,904.94; 4.8898,904.94; 4.9524,904.93; 5.0945,
          904.93; 5.1567,904.88; 5.2805,904.88; 5.3445,903.57; 5.3906,
          903.57; 5.5138,903.72; 5.5774,905.82; 5.7015,905.83; 5.7796,
          903.73; 5.8894,903.73; 5.9511,905.62; 6.1071,905.62; 6.1712,
          905.02; 6.3104,905.02; 6.3563,904.7; 6.4806,904.7; 6.5429,904.94;
          6.6838,904.94; 6.7638,902.73; 6.8886,902.73; 6.9499,906.23;
          7.1059,906.23; 7.1669,904.3; 7.3059,904.3; 7.3685,928.5; 7.5104,
          928.44; 7.5575,902.69; 7.6965,902.75; 7.7577,903.59; 7.881,903.59;
          7.9452,902.81; 8.007,902.81; 8.1476,903.85; 8.2092,903.85; 8.3337,
          903.66; 8.4123,903.66; 8.5368,903.58; 8.6887,903.58; 8.7646,
          903.54; 8.8896,903.57; 8.95,903.98; 9.1032,903.98; 9.1646,903.7;
          9.3012,903.7; 9.3621,903.75; 9.5003,903.72; 9.5612,903.47; 9.7,
          903.5; 9.7769,903.56; 9.9003,903.36; 9.9619,903.36; 10.102,903.33;
          10.165,903.47; 10.307,903.47; 10.368,903.73; 10.492,903.73;
          10.554,903.73], extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.16198,
          480.1; 0.20755,480.1; 0.33167,479.53; 0.40958,479.53; 0.54903,
          478.27; 0.6887,478.27; 0.75006,478.78; 0.81331,478.78; 0.95333,
          479.17; 1.0944,479.17; 1.1719,478.37; 1.3129,478.37; 1.3758,
          479.85; 1.5169,479.85; 1.5789,479.7; 1.7037,480.01; 1.767,480;
          1.8926,480; 1.9549,479.01; 2.0172,479.01; 2.1577,479.38; 2.2797,
          479.38; 2.3432,478.05; 2.4047,478.05; 2.5458,478.25; 2.6078,
          479.37; 2.73,479.63; 2.7937,479.63; 2.9022,480.69; 2.9642,480.12;
          3.1196,480.12; 3.1675,479.32; 3.2921,479.32; 3.3544,477.68; 3.477,
          477.68; 3.5543,479.1; 3.6935,479.04; 3.7699,478.74; 3.8782,478.74;
          3.9405,480.73; 4.0023,480.73; 4.1261,480.32; 4.1881,479.17;
          4.3119,477.69; 4.374,477.72; 4.5148,477.72; 4.5783,479.28; 4.7024,
          479.12; 4.7803,479.12; 4.8898,479.12; 4.9524,479.16; 5.0945,
          479.16; 5.1567,479.21; 5.2805,479.21; 5.3445,479.15; 5.3906,
          479.15; 5.5138,478.89; 5.5774,480; 5.7015,480; 5.7796,478.85;
          5.8894,478.85; 5.9511,480.37; 6.1071,480.37; 6.1712,478.95;
          6.3104,478.95; 6.3563,479.59; 6.4806,479.59; 6.5429,479.11;
          6.6838,479.11; 6.7638,478.21; 6.8886,478.21; 6.9499,479.2; 7.1059,
          479.2; 7.1669,480.33; 7.3059,480.33; 7.3685,499.33; 7.5104,499.44;
          7.5575,487.9; 7.6965,487.8; 7.7577,488.61; 7.881,488.61; 7.9452,
          487.63; 8.007,487.63; 8.1476,488.14; 8.2092,488.14; 8.3337,488.51;
          8.4123,488.51; 8.5368,488.67; 8.6887,488.67; 8.7646,488.78;
          8.8896,488.73; 8.95,487.94; 9.1032,487.94; 9.1646,488.47; 9.3012,
          488.47; 9.3621,488.36; 9.5003,488.41; 9.5612,488.88; 9.7,488.83;
          9.7769,488.72; 9.9003,489.09; 9.9619,489.09; 10.102,489.15;
          10.165,488.88; 10.307,488.88; 10.368,488.41; 10.492,488.41;
          10.554,488.41],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.16198,1; 0.20755,1;
          0.33167,0.99998; 0.40958,0.99998; 0.54903,0.99997; 0.6887,0.99997;
          0.75006,0.99999; 0.81331,0.99999; 0.95333,0.99999; 1.0944,0.99999;
          1.1719,0.99998; 1.3129,0.99998; 1.3758,0.99999; 1.5169,0.99999;
          1.5789,0.99999; 1.7037,0.99999; 1.767,0.99998; 1.8926,0.99998;
          1.9549,0.99998; 2.0172,0.99998; 2.1577,1; 2.2797,1; 2.3432,
          0.99996; 2.4047,0.99996; 2.5458,0.99996; 2.6078,0.99998; 2.73,1;
          2.7937,1; 2.9022,1; 2.9642,1; 3.1196,1; 3.1675,0.99998; 3.2921,
          0.99998; 3.3544,0.99996; 3.477,0.99996; 3.5543,0.99999; 3.6935,
          0.99999; 3.7699,0.99997; 3.8782,0.99997; 3.9405,0.99999; 4.0023,
          0.99999; 4.1261,0.99999; 4.1881,0.99997; 4.3119,0.99997; 4.374,
          0.99998; 4.5148,0.99998; 4.5783,0.99999; 4.7024,0.99999; 4.7803,
          0.99999; 4.8898,0.99999; 4.9524,0.99999; 5.0945,0.99999; 5.1567,
          0.99997; 5.2805,0.99997; 5.3445,0.99998; 5.3906,0.99998; 5.5138,
          0.99998; 5.5774,1; 5.7015,1; 5.7796,0.99997; 5.8894,0.99997;
          5.9511,1; 6.1071,1; 6.1712,0.99998; 6.3104,0.99998; 6.3563,
          0.99999; 6.4806,0.99999; 6.5429,0.99998; 6.6838,0.99998; 6.7638,
          0.99998; 6.8886,0.99998; 6.9499,0.99999; 7.1059,0.99999; 7.1669,
          0.99999; 7.3059,0.99999; 7.3685,0.98204; 7.5104,0.98204; 7.5575,
          0.97294; 7.6965,0.97294; 7.7577,0.97292; 7.881,0.97292; 7.9452,
          0.97292; 8.007,0.97292; 8.1476,0.97292; 8.2092,0.97292; 8.3337,
          0.97293; 8.4123,0.97293; 8.5368,0.97293; 8.6887,0.97293; 8.7646,
          0.97295; 8.8896,0.97295; 8.95,0.97294; 9.1032,0.97294; 9.1646,
          0.97294; 9.3012,0.97294; 9.3621,0.97294; 9.5003,0.97294; 9.5612,
          0.97294; 9.7,0.97294; 9.7769,0.97294; 9.9003,0.97294; 9.9619,
          0.97294; 10.102,0.97294; 10.165,0.97294; 10.307,0.97294; 10.368,
          0.97294; 10.492,0.97294; 10.554,0.97294],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.16198,-0.52401;
          0.20755,-0.52401; 0.33167,-0.52401; 0.40958,-0.52401; 0.54903,-0.52401;
          0.6887,-0.52401; 0.75006,-0.52401; 0.81331,-0.52401; 0.95333,-0.52401;
          1.0944,-0.52401; 1.1719,-0.52401; 1.3129,-0.52401; 1.3758,-0.52401;
          1.5169,-0.52401; 1.5789,-0.52401; 1.7037,-0.52401; 1.767,-0.52401;
          1.8926,-0.52401; 1.9549,-0.52401; 2.0172,-0.52401; 2.1577,-0.52401;
          2.2797,-0.52401; 2.3432,-0.52401; 2.4047,-0.52401; 2.5458,-0.52401;
          2.6078,-0.52401; 2.73,-0.52401; 2.7937,-0.52401; 2.9022,-0.52401;
          2.9642,-0.52401; 3.1196,-0.52401; 3.1675,-0.52401; 3.2921,-0.52401;
          3.3544,-0.52401; 3.477,-0.52401; 3.5543,-0.52395; 3.6935,-0.52401;
          3.7699,-0.52401; 3.8782,-0.52401; 3.9405,-0.52401; 4.0023,-0.52401;
          4.1261,-0.52401; 4.1881,-0.52401; 4.3119,-0.52401; 4.374,-0.52401;
          4.5148,-0.52401; 4.5783,-0.52401; 4.7024,-0.52401; 4.7803,-0.52401;
          4.8898,-0.52401; 4.9524,-0.52401; 5.0945,-0.52401; 5.1567,-0.52401;
          5.2805,-0.52401; 5.3445,-0.52401; 5.3906,-0.52401; 5.5138,-0.52401;
          5.5774,-0.52401; 5.7015,-0.52401; 5.7796,-0.52401; 5.8894,-0.52401;
          5.9511,-0.52401; 6.1071,-0.52401; 6.1712,-0.52401; 6.3104,-0.52401;
          6.3563,-0.52401; 6.4806,-0.52401; 6.5429,-0.52401; 6.6838,-0.52401;
          6.7638,-0.52401; 6.8886,-0.52401; 6.9499,-0.52401; 7.1059,-0.52401;
          7.1669,-0.52401; 7.3059,-0.52401; 7.3685,-0.52401; 7.5104,-0.52389;
          7.5575,-0.52389; 7.6965,-0.52401; 7.7577,-0.52401; 7.881,-0.52401;
          7.9452,-0.52401; 8.007,-0.52401; 8.1476,-0.52406; 8.2092,-0.52406;
          8.3337,-0.52401; 8.4123,-0.52401; 8.5368,-0.52401; 8.6887,-0.52401;
          8.7646,-0.52401; 8.8896,-0.52406; 8.95,-0.52406; 9.1032,-0.52406;
          9.1646,-0.52406; 9.3012,-0.52406; 9.3621,-0.52406; 9.5003,-0.52401;
          9.5612,-0.52401; 9.7,-0.52406; 9.7769,-0.52406; 9.9003,-0.52406;
          9.9619,-0.52406; 10.102,-0.52401; 10.165,-0.52401; 10.307,-0.52401;
          10.368,-0.52401; 10.492,-0.52401; 10.554,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[0.16198,
          -1.0114; 0.20755,-1.0114; 0.33167,-1.0114; 0.40958,-1.0114;
          0.54903,-1.0106; 0.6887,-1.0106; 0.75006,-1.0112; 0.81331,-1.0112;
          0.95333,-1.011; 1.0944,-1.011; 1.1719,-1.0101; 1.3129,-1.0101;
          1.3758,-1.0117; 1.5169,-1.0117; 1.5789,-1.0116; 1.7037,-1.0119;
          1.767,-1.0119; 1.8926,-1.0119; 1.9549,-1.0108; 2.0172,-1.0108;
          2.1577,-1.0112; 2.2797,-1.0112; 2.3432,-1.011; 2.4047,-1.011;
          2.5458,-1.0112; 2.6078,-1.0112; 2.73,-1.0109; 2.7937,-1.0109;
          2.9022,-1.012; 2.9642,-1.012; 3.1196,-1.012; 3.1675,-1.0112;
          3.2921,-1.0112; 3.3544,-1.0106; 3.477,-1.0106; 3.5543,-1.0115;
          3.6935,-1.0115; 3.7699,-1.0105; 3.8782,-1.0105; 3.9405,-1.0121;
          4.0023,-1.0121; 4.1261,-1.0116; 4.1881,-1.0116; 4.3119,-1.01;
          4.374,-1.01; 4.5148,-1.01; 4.5783,-1.0111; 4.7024,-1.0109; 4.7803,
          -1.0109; 4.8898,-1.0109; 4.9524,-1.011; 5.0945,-1.011; 5.1567,-1.011;
          5.2805,-1.011; 5.3445,-1.0116; 5.3906,-1.0116; 5.5138,-1.0113;
          5.5774,-1.0113; 5.7015,-1.0113; 5.7796,-1.0113; 5.8894,-1.0113;
          5.9511,-1.0117; 6.1071,-1.0117; 6.1712,-1.0107; 6.3104,-1.0107;
          6.3563,-1.0114; 6.4806,-1.0114; 6.5429,-1.0109; 6.6838,-1.0109;
          6.7638,-1.0112; 6.8886,-1.0112; 6.9499,-1.0104; 7.1059,-1.0104;
          7.1669,-1.0123; 7.3059,-1.0123; 7.3685,-1.0174; 7.5104,-1.0174;
          7.5575,-1.0194; 7.6965,-1.0194; 7.7577,-1.0197; 7.881,-1.0197;
          7.9452,-1.0192; 8.007,-1.0192; 8.1476,-1.0192; 8.2092,-1.0192;
          8.3337,-1.0196; 8.4123,-1.0196; 8.5368,-1.0198; 8.6887,-1.0198;
          8.7646,-1.0199; 8.8896,-1.0199; 8.95,-1.019; 9.1032,-1.019;
          9.1646,-1.0196; 9.3012,-1.0196; 9.3621,-1.0195; 9.5003,-1.0195;
          9.5612,-1.02; 9.7,-1.02; 9.7769,-1.0199; 9.9003,-1.0203; 9.9619,-1.0203;
          10.102,-1.0203; 10.165,-1.02; 10.307,-1.02; 10.368,-1.0195;
          10.492,-1.0195; 10.554,-1.0195], extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.16198,1; 0.20755,1;
          0.33167,0.99998; 0.40958,0.99998; 0.54903,0.99997; 0.6887,0.99997;
          0.75006,0.99999; 0.81331,0.99999; 0.95333,0.99999; 1.0944,0.99999;
          1.1719,0.99998; 1.3129,0.99998; 1.3758,0.99999; 1.5169,0.99999;
          1.5789,0.99999; 1.7037,0.99999; 1.767,0.99998; 1.8926,0.99998;
          1.9549,0.99998; 2.0172,0.99998; 2.1577,1; 2.2797,1; 2.3432,
          0.99996; 2.4047,0.99996; 2.5458,0.99996; 2.6078,0.99998; 2.73,1;
          2.7937,1; 2.9022,1; 2.9642,1; 3.1196,1; 3.1675,0.99998; 3.2921,
          0.99998; 3.3544,0.99996; 3.477,0.99996; 3.5543,0.99999; 3.6935,
          0.99999; 3.7699,0.99997; 3.8782,0.99997; 3.9405,0.99999; 4.0023,
          0.99999; 4.1261,0.99999; 4.1881,0.99997; 4.3119,0.99997; 4.374,
          0.99998; 4.5148,0.99998; 4.5783,0.99999; 4.7024,0.99999; 4.7803,
          0.99999; 4.8898,0.99999; 4.9524,0.99999; 5.0945,0.99999; 5.1567,
          0.99997; 5.2805,0.99997; 5.3445,0.99998; 5.3906,0.99998; 5.5138,
          0.99998; 5.5774,1; 5.7015,1; 5.7796,0.99997; 5.8894,0.99997;
          5.9511,1; 6.1071,1; 6.1712,0.99998; 6.3104,0.99998; 6.3563,
          0.99999; 6.4806,0.99999; 6.5429,0.99998; 6.6838,0.99998; 6.7638,
          0.99998; 6.8886,0.99998; 6.9499,0.99999; 7.1059,0.99999; 7.1669,
          0.99999; 7.3059,0.99999; 7.3685,0.98204; 7.5104,0.98204; 7.5575,
          0.97294; 7.6965,0.97294; 7.7577,0.97292; 7.881,0.97292; 7.9452,
          0.97292; 8.007,0.97292; 8.1476,0.97292; 8.2092,0.97292; 8.3337,
          0.97293; 8.4123,0.97293; 8.5368,0.97293; 8.6887,0.97293; 8.7646,
          0.97295; 8.8896,0.97295; 8.95,0.97294; 9.1032,0.97294; 9.1646,
          0.97294; 9.3012,0.97294; 9.3621,0.97294; 9.5003,0.97294; 9.5612,
          0.97294; 9.7,0.97294; 9.7769,0.97294; 9.9003,0.97294; 9.9619,
          0.97294; 10.102,0.97294; 10.165,0.97294; 10.307,0.97294; 10.368,
          0.97294; 10.492,0.97294; 10.554,0.97294],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.16198,-0.52401;
          0.20755,-0.52401; 0.33167,-0.52401; 0.40958,-0.52401; 0.54903,-0.52401;
          0.6887,-0.52401; 0.75006,-0.52401; 0.81331,-0.52401; 0.95333,-0.52401;
          1.0944,-0.52401; 1.1719,-0.52401; 1.3129,-0.52401; 1.3758,-0.52401;
          1.5169,-0.52401; 1.5789,-0.52401; 1.7037,-0.52401; 1.767,-0.52401;
          1.8926,-0.52401; 1.9549,-0.52401; 2.0172,-0.52401; 2.1577,-0.52401;
          2.2797,-0.52401; 2.3432,-0.52401; 2.4047,-0.52401; 2.5458,-0.52401;
          2.6078,-0.52401; 2.73,-0.52401; 2.7937,-0.52401; 2.9022,-0.52401;
          2.9642,-0.52401; 3.1196,-0.52401; 3.1675,-0.52401; 3.2921,-0.52401;
          3.3544,-0.52401; 3.477,-0.52401; 3.5543,-0.52395; 3.6935,-0.52401;
          3.7699,-0.52401; 3.8782,-0.52401; 3.9405,-0.52401; 4.0023,-0.52401;
          4.1261,-0.52401; 4.1881,-0.52401; 4.3119,-0.52401; 4.374,-0.52401;
          4.5148,-0.52401; 4.5783,-0.52401; 4.7024,-0.52401; 4.7803,-0.52401;
          4.8898,-0.52401; 4.9524,-0.52401; 5.0945,-0.52401; 5.1567,-0.52401;
          5.2805,-0.52401; 5.3445,-0.52401; 5.3906,-0.52401; 5.5138,-0.52401;
          5.5774,-0.52401; 5.7015,-0.52401; 5.7796,-0.52401; 5.8894,-0.52401;
          5.9511,-0.52401; 6.1071,-0.52401; 6.1712,-0.52401; 6.3104,-0.52401;
          6.3563,-0.52401; 6.4806,-0.52401; 6.5429,-0.52401; 6.6838,-0.52401;
          6.7638,-0.52401; 6.8886,-0.52401; 6.9499,-0.52401; 7.1059,-0.52401;
          7.1669,-0.52401; 7.3059,-0.52401; 7.3685,-0.52401; 7.5104,-0.52389;
          7.5575,-0.52389; 7.6965,-0.52401; 7.7577,-0.52401; 7.881,-0.52401;
          7.9452,-0.52401; 8.007,-0.52401; 8.1476,-0.52406; 8.2092,-0.52406;
          8.3337,-0.52401; 8.4123,-0.52401; 8.5368,-0.52401; 8.6887,-0.52401;
          8.7646,-0.52401; 8.8896,-0.52406; 8.95,-0.52406; 9.1032,-0.52406;
          9.1646,-0.52406; 9.3012,-0.52406; 9.3621,-0.52406; 9.5003,-0.52401;
          9.5612,-0.52401; 9.7,-0.52406; 9.7769,-0.52406; 9.9003,-0.52406;
          9.9619,-0.52406; 10.102,-0.52401; 10.165,-0.52401; 10.307,-0.52401;
          10.368,-0.52401; 10.492,-0.52401; 10.554,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.16198,1; 0.20755,1;
          0.33167,0.99998; 0.40958,0.99998; 0.54903,0.99997; 0.6887,0.99997;
          0.75006,0.99999; 0.81331,0.99999; 0.95333,0.99999; 1.0944,0.99999;
          1.1719,0.99998; 1.3129,0.99998; 1.3758,0.99999; 1.5169,0.99999;
          1.5789,0.99999; 1.7037,0.99999; 1.767,0.99998; 1.8926,0.99998;
          1.9549,0.99998; 2.0172,0.99998; 2.1577,1; 2.2797,1; 2.3432,
          0.99996; 2.4047,0.99996; 2.5458,0.99996; 2.6078,0.99998; 2.73,1;
          2.7937,1; 2.9022,1; 2.9642,1; 3.1196,1; 3.1675,0.99998; 3.2921,
          0.99998; 3.3544,0.99996; 3.477,0.99996; 3.5543,0.99999; 3.6935,
          0.99999; 3.7699,0.99997; 3.8782,0.99997; 3.9405,0.99999; 4.0023,
          0.99999; 4.1261,0.99999; 4.1881,0.99997; 4.3119,0.99997; 4.374,
          0.99998; 4.5148,0.99998; 4.5783,0.99999; 4.7024,0.99999; 4.7803,
          0.99999; 4.8898,0.99999; 4.9524,0.99999; 5.0945,0.99999; 5.1567,
          0.99997; 5.2805,0.99997; 5.3445,0.99998; 5.3906,0.99998; 5.5138,
          0.99998; 5.5774,1; 5.7015,1; 5.7796,0.99997; 5.8894,0.99997;
          5.9511,1; 6.1071,1; 6.1712,0.99998; 6.3104,0.99998; 6.3563,
          0.99999; 6.4806,0.99999; 6.5429,0.99998; 6.6838,0.99998; 6.7638,
          0.99998; 6.8886,0.99998; 6.9499,0.99999; 7.1059,0.99999; 7.1669,
          0.99999; 7.3059,0.99999; 7.3685,0.98204; 7.5104,0.98204; 7.5575,
          0.97294; 7.6965,0.97294; 7.7577,0.97292; 7.881,0.97292; 7.9452,
          0.97292; 8.007,0.97292; 8.1476,0.97292; 8.2092,0.97292; 8.3337,
          0.97293; 8.4123,0.97293; 8.5368,0.97293; 8.6887,0.97293; 8.7646,
          0.97295; 8.8896,0.97295; 8.95,0.97294; 9.1032,0.97294; 9.1646,
          0.97294; 9.3012,0.97294; 9.3621,0.97294; 9.5003,0.97294; 9.5612,
          0.97294; 9.7,0.97294; 9.7769,0.97294; 9.9003,0.97294; 9.9619,
          0.97294; 10.102,0.97294; 10.165,0.97294; 10.307,0.97294; 10.368,
          0.97294; 10.492,0.97294; 10.554,0.97294],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.16198,-0.52401;
          0.20755,-0.52401; 0.33167,-0.52401; 0.40958,-0.52401; 0.54903,-0.52401;
          0.6887,-0.52401; 0.75006,-0.52401; 0.81331,-0.52401; 0.95333,-0.52401;
          1.0944,-0.52401; 1.1719,-0.52401; 1.3129,-0.52401; 1.3758,-0.52401;
          1.5169,-0.52401; 1.5789,-0.52401; 1.7037,-0.52401; 1.767,-0.52401;
          1.8926,-0.52401; 1.9549,-0.52401; 2.0172,-0.52401; 2.1577,-0.52401;
          2.2797,-0.52401; 2.3432,-0.52401; 2.4047,-0.52401; 2.5458,-0.52401;
          2.6078,-0.52401; 2.73,-0.52401; 2.7937,-0.52401; 2.9022,-0.52401;
          2.9642,-0.52401; 3.1196,-0.52401; 3.1675,-0.52401; 3.2921,-0.52401;
          3.3544,-0.52401; 3.477,-0.52401; 3.5543,-0.52395; 3.6935,-0.52401;
          3.7699,-0.52401; 3.8782,-0.52401; 3.9405,-0.52401; 4.0023,-0.52401;
          4.1261,-0.52401; 4.1881,-0.52401; 4.3119,-0.52401; 4.374,-0.52401;
          4.5148,-0.52401; 4.5783,-0.52401; 4.7024,-0.52401; 4.7803,-0.52401;
          4.8898,-0.52401; 4.9524,-0.52401; 5.0945,-0.52401; 5.1567,-0.52401;
          5.2805,-0.52401; 5.3445,-0.52401; 5.3906,-0.52401; 5.5138,-0.52401;
          5.5774,-0.52401; 5.7015,-0.52401; 5.7796,-0.52401; 5.8894,-0.52401;
          5.9511,-0.52401; 6.1071,-0.52401; 6.1712,-0.52401; 6.3104,-0.52401;
          6.3563,-0.52401; 6.4806,-0.52401; 6.5429,-0.52401; 6.6838,-0.52401;
          6.7638,-0.52401; 6.8886,-0.52401; 6.9499,-0.52401; 7.1059,-0.52401;
          7.1669,-0.52401; 7.3059,-0.52401; 7.3685,-0.52401; 7.5104,-0.52389;
          7.5575,-0.52389; 7.6965,-0.52401; 7.7577,-0.52401; 7.881,-0.52401;
          7.9452,-0.52401; 8.007,-0.52401; 8.1476,-0.52406; 8.2092,-0.52406;
          8.3337,-0.52401; 8.4123,-0.52401; 8.5368,-0.52401; 8.6887,-0.52401;
          8.7646,-0.52401; 8.8896,-0.52406; 8.95,-0.52406; 9.1032,-0.52406;
          9.1646,-0.52406; 9.3012,-0.52406; 9.3621,-0.52406; 9.5003,-0.52401;
          9.5612,-0.52401; 9.7,-0.52406; 9.7769,-0.52406; 9.9003,-0.52406;
          9.9619,-0.52406; 10.102,-0.52401; 10.165,-0.52401; 10.307,-0.52401;
          10.368,-0.52401; 10.492,-0.52401; 10.554,-0.52401],
                                                            extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.16198,2.8964; 0.20755,2.8964; 0.33167,2.8931; 0.40958,2.8931;
          0.54903,2.8898; 0.6887,2.8898; 0.75006,2.8897; 0.81331,2.8897;
          0.95333,2.8931; 1.0944,2.8931; 1.1719,2.8931; 1.3129,2.8931;
          1.3758,2.8931; 1.5169,2.8931; 1.5789,2.8931; 1.7037,2.8931; 1.767,
          2.8931; 1.8926,2.8931; 1.9549,2.8931; 2.0172,2.8931; 2.1577,
          2.8931; 2.2797,2.8931; 2.3432,2.8864; 2.4047,2.8864; 2.5458,
          2.8864; 2.6078,2.8931; 2.73,2.8964; 2.7937,2.8964; 2.9022,2.8964;
          2.9642,2.8931; 3.1196,2.8931; 3.1675,2.8931; 3.2921,2.8931;
          3.3544,2.8865; 3.477,2.8865; 3.5543,2.8898; 3.6935,2.8898; 3.7699,
          2.8931; 3.8782,2.8931; 3.9405,2.8964; 4.0023,2.8964; 4.1261,
          2.8965; 4.1881,2.8898; 4.3119,2.8898; 4.374,2.8898; 4.5148,2.8898;
          4.5783,2.8931; 4.7024,2.8931; 4.7803,2.8931; 4.8898,2.8931;
          4.9524,2.8931; 5.0945,2.8931; 5.1567,2.8931; 5.2805,2.8931;
          5.3445,2.8898; 5.3906,2.8898; 5.5138,2.8898; 5.5774,2.8964;
          5.7015,2.8964; 5.7796,2.8898; 5.8894,2.8898; 5.9511,2.8964;
          6.1071,2.8964; 6.1712,2.8931; 6.3104,2.8931; 6.3563,2.8931;
          6.4806,2.8931; 6.5429,2.8931; 6.6838,2.8931; 6.7638,2.8864;
          6.8886,2.8864; 6.9499,2.8964; 7.1059,2.8964; 7.1669,2.8931;
          7.3059,2.8931; 7.3685,3.0332; 7.5104,3.0332; 7.5575,2.9798;
          7.6965,2.9798; 7.7577,2.9831; 7.881,2.9831; 7.9452,2.9798; 8.007,
          2.9798; 8.1476,2.9832; 8.2092,2.9832; 8.3337,2.9832; 8.4123,
          2.9832; 8.5368,2.9832; 8.6887,2.9832; 8.7646,2.9831; 8.8896,
          2.9831; 8.95,2.9832; 9.1032,2.9832; 9.1646,2.9832; 9.3012,2.9832;
          9.3621,2.9831; 9.5003,2.9831; 9.5612,2.9831; 9.7,2.9831; 9.7769,
          2.9831; 9.9003,2.9831; 9.9619,2.9831; 10.102,2.9831; 10.165,
          2.9831; 10.307,2.9831; 10.368,2.9832; 10.492,2.9832; 10.554,
          2.9832], extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.16198,353.93;
          0.20755,353.93; 0.33167,353.92; 0.40958,353.92; 0.54903,353.92;
          0.6887,353.92; 0.75006,353.93; 0.81331,353.93; 0.95333,353.93;
          1.0944,353.93; 1.1719,353.93; 1.3129,353.93; 1.3758,353.93;
          1.5169,353.93; 1.5789,353.93; 1.7037,353.93; 1.767,353.93; 1.8926,
          353.93; 1.9549,353.93; 2.0172,353.93; 2.1577,353.93; 2.2797,
          353.93; 2.3432,353.92; 2.4047,353.92; 2.5458,353.92; 2.6078,
          353.93; 2.73,353.93; 2.7937,353.93; 2.9022,353.93; 2.9642,353.93;
          3.1196,353.93; 3.1675,353.92; 3.2921,353.92; 3.3544,353.92; 3.477,
          353.92; 3.5543,353.93; 3.6935,353.93; 3.7699,353.92; 3.8782,
          353.92; 3.9405,353.93; 4.0023,353.93; 4.1261,353.93; 4.1881,
          353.92; 4.3119,353.92; 4.374,353.92; 4.5148,353.92; 4.5783,353.93;
          4.7024,353.93; 4.7803,353.93; 4.8898,353.93; 4.9524,353.93;
          5.0945,353.93; 5.1567,353.92; 5.2805,353.92; 5.3445,353.92;
          5.3906,353.92; 5.5138,353.92; 5.5774,353.93; 5.7015,353.93;
          5.7796,353.92; 5.8894,353.92; 5.9511,353.93; 6.1071,353.93;
          6.1712,353.92; 6.3104,353.92; 6.3563,353.93; 6.4806,353.93;
          6.5429,353.93; 6.6838,353.93; 6.7638,353.92; 6.8886,353.92;
          6.9499,353.93; 7.1059,353.93; 7.1669,353.93; 7.3059,353.93;
          7.3685,347.58; 7.5104,347.58; 7.5575,344.35; 7.6965,344.35;
          7.7577,344.35; 7.881,344.35; 7.9452,344.35; 8.007,344.35; 8.1476,
          344.35; 8.2092,344.35; 8.3337,344.35; 8.4123,344.35; 8.5368,
          344.35; 8.6887,344.35; 8.7646,344.36; 8.8896,344.36; 8.95,344.35;
          9.1032,344.35; 9.1646,344.36; 9.3012,344.36; 9.3621,344.35;
          9.5003,344.35; 9.5612,344.35; 9.7,344.35; 9.7769,344.36; 9.9003,
          344.36; 9.9619,344.36; 10.102,344.36; 10.165,344.36; 10.307,
          344.36; 10.368,344.35; 10.492,344.35; 10.554,344.35],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_340_V;

  model VoltageVariation_350_to_335_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.15595,
          905.43; 0.21738,904.94; 0.26377,904.94; 0.37103,904.98; 0.41692,
          904.98; 0.52794,904.98; 0.60443,903.83; 0.7304,903.83; 0.7925,
          905.18; 0.85511,905.18; 0.96638,904.83; 1.0134,904.82; 1.1664,
          904.82; 1.2144,904.46; 1.3533,904.46; 1.4149,904.46; 1.5512,
          904.46; 1.6119,904.84; 1.6588,904.84; 1.7829,903.7; 1.8598,903.7;
          1.9813,904.46; 2.0587,904.46; 2.1831,904.56; 2.2457,904.56;
          2.3707,905.18; 2.4331,904.14; 2.5875,903.52; 2.6341,903.5; 2.7594,
          903.38; 2.8381,905.5; 2.9624,905.67; 3.0084,904.63; 3.1654,904.63;
          3.2295,904.13; 3.3696,903.33; 3.4321,905.43; 3.5882,905.93;
          3.6507,904.88; 3.7601,905.2; 3.8388,905.19; 3.9631,904.83; 4.0253,
          905.89; 4.1653,906.17; 4.2273,904.05; 4.3528,904.05; 4.4152,904.8;
          4.5548,904.8; 4.6318,903.74; 4.7567,903.55; 4.8364,905.66; 4.9596,
          906.28; 5.0206,904.18; 5.1612,904.18; 5.2075,904.71; 5.3317,
          904.71; 5.394,904.56; 5.5347,904.56; 5.6134,903.81; 5.7384,903.81;
          5.8014,905.7; 5.8634,905.7; 5.9729,904.14; 6.0202,904.14; 6.1439,
          904.11; 6.2062,905.51; 6.3473,905.54; 6.395,905.09; 6.4579,905.09;
          6.5979,904.67; 6.6451,904.67; 6.7716,905.13; 6.8191,904.07;
          6.9411,904.07; 7.0031,903.88; 7.1558,903.88; 7.2172,904.55;
          7.3404,904.58; 7.4023,920.21; 7.4494,920.21; 7.6037,916.5; 7.7287,
          918.2; 7.7912,903.76; 7.8382,903.76; 7.9617,903.87; 8.0087,903.86;
          8.147,903.86; 8.1943,902.7; 8.3319,902.7; 8.3941,903.75; 8.4563,
          903.75; 8.5963,903.45; 8.6578,903.45; 8.7826,904.12; 8.8456,
          904.12; 8.9542,903.63; 9.032,903.64; 9.172,903.81; 9.2192,902.82;
          9.3411,902.82; 9.4026,903.87; 9.4635,903.87; 9.6036,903.19;
          9.6651,903.19; 9.7753,903.67; 9.8352,903.67],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.15595,
          480.67; 0.21738,479.11; 0.26377,479.11; 0.37103,479; 0.41692,479;
          0.52794,479; 0.60443,478.62; 0.7304,478.62; 0.7925,478.69;
          0.85511,478.69; 0.96638,479.32; 1.0134,479.32; 1.1664,479.32;
          1.2144,480; 1.3533,480; 1.4149,479.94; 1.5512,479.94; 1.6119,
          479.32; 1.6588,479.32; 1.7829,478.88; 1.8598,478.88; 1.9813,480;
          2.0587,480; 2.1831,479.79; 2.2457,479.79; 2.3707,478.63; 2.4331,
          478.1; 2.5875,479.25; 2.6341,479.24; 2.7594,479.45; 2.8381,480.57;
          2.9624,480.26; 3.0084,479.69; 3.1654,479.69; 3.2295,478.06;
          3.3696,479.52; 3.4321,480.68; 3.5882,479.78; 3.6507,479.21;
          3.7601,478.58; 3.8388,478.57; 3.9631,479.25; 4.0253,479.84;
          4.1653,479.32; 4.2273,478.16; 4.3528,478.16; 4.4152,479.37;
          4.5548,479.37; 4.6318,478.77; 4.7567,479.13; 4.8364,480.25;
          4.9596,479.1; 5.0206,477.98; 5.1612,477.98; 5.2075,479.53; 5.3317,
          479.53; 5.394,479.79; 5.5347,479.79; 5.6134,478.67; 5.7384,478.67;
          5.8014,480.15; 5.8634,480.15; 5.9729,478.06; 6.0202,478.06;
          6.1439,478.11; 6.2062,480.51; 6.3473,480.46; 6.395,478.79; 6.4579,
          478.79; 6.5979,479.58; 6.6451,479.58; 6.7716,478.74; 6.8191,
          478.19; 6.9411,478.19; 7.0031,478.5; 7.1558,478.5; 7.2172,479.78;
          7.3404,479.73; 7.4023,488.44; 7.4494,488.44; 7.6037,495.4; 7.7287,
          496.29; 7.7912,493.93; 7.8382,493.93; 7.9617,493.73; 8.0087,
          493.72; 8.147,493.72; 8.1943,493.48; 8.3319,493.48; 8.3941,493.99;
          8.4563,493.99; 8.5963,494.52; 8.6578,494.52; 8.7826,493.31;
          8.8456,493.31; 8.9542,494.21; 9.032,494.21; 9.172,493.9; 9.2192,
          493.34; 9.3411,493.34; 9.4026,493.8; 9.4635,493.8; 9.6036,495.06;
          9.6651,495.06; 9.7753,494.15; 9.8352,494.15],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.15595,1; 0.21738,1;
          0.26377,1; 0.37103,0.99999; 0.41692,0.99999; 0.52794,0.99999;
          0.60443,0.99998; 0.7304,0.99998; 0.7925,1; 0.85511,1; 0.96638,1;
          1.0134,1; 1.1664,1; 1.2144,1; 1.3533,1; 1.4149,0.99999; 1.5512,
          0.99999; 1.6119,1; 1.6588,1; 1.7829,0.99999; 1.8598,0.99999;
          1.9813,1; 2.0587,1; 2.1831,0.99999; 2.2457,0.99999; 2.3707,
          0.99999; 2.4331,1; 2.5875,1; 2.6341,0.99997; 2.7594,0.99997;
          2.8381,1; 2.9624,1; 3.0084,1; 3.1654,1; 3.2295,0.99997; 3.3696,
          0.99997; 3.4321,1; 3.5882,1; 3.6507,0.99999; 3.7601,0.99999;
          3.8388,0.99998; 3.9631,0.99998; 4.0253,1; 4.1653,1; 4.2273,
          0.99996; 4.3528,0.99996; 4.4152,1; 4.5548,1; 4.6318,0.99997;
          4.7567,0.99997; 4.8364,1; 4.9596,1; 5.0206,0.99998; 5.1612,
          0.99998; 5.2075,1; 5.3317,1; 5.394,0.99999; 5.5347,0.99999;
          5.6134,0.99998; 5.7384,0.99998; 5.8014,0.99999; 5.8634,0.99999;
          5.9729,0.99998; 6.0202,0.99998; 6.1439,0.99998; 6.2062,1; 6.3473,
          1; 6.395,0.99998; 6.4579,0.99998; 6.5979,0.99999; 6.6451,0.99999;
          6.7716,0.99999; 6.8191,0.99998; 6.9411,0.99998; 7.0031,0.99996;
          7.1558,0.99996; 7.2172,0.99998; 7.3404,0.99998; 7.4023,0.99903;
          7.4494,0.99903; 7.6037,0.99903; 7.7287,0.95961; 7.7912,0.9594;
          7.8382,0.9594; 7.9617,0.9594; 8.0087,0.95939; 8.147,0.95939;
          8.1943,0.95939; 8.3319,0.95939; 8.3941,0.95941; 8.4563,0.95941;
          8.5963,0.95941; 8.6578,0.95941; 8.7826,0.95941; 8.8456,0.95941;
          8.9542,0.95941; 9.032,0.95943; 9.172,0.95943; 9.2192,0.95942;
          9.3411,0.95942; 9.4026,0.95943; 9.4635,0.95943; 9.6036,0.95944;
          9.6651,0.95944; 9.7753,0.95942; 9.8352,0.95942],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.15595,-0.52401;
          0.21738,-0.52401; 0.26377,-0.52401; 0.37103,-0.52401; 0.41692,-0.52401;
          0.52794,-0.52401; 0.60443,-0.52401; 0.7304,-0.52401; 0.7925,-0.52401;
          0.85511,-0.52401; 0.96638,-0.52401; 1.0134,-0.52401; 1.1664,-0.52401;
          1.2144,-0.52401; 1.3533,-0.52401; 1.4149,-0.52401; 1.5512,-0.52401;
          1.6119,-0.52401; 1.6588,-0.52401; 1.7829,-0.52401; 1.8598,-0.52401;
          1.9813,-0.52401; 2.0587,-0.52401; 2.1831,-0.52401; 2.2457,-0.52401;
          2.3707,-0.52401; 2.4331,-0.52401; 2.5875,-0.52401; 2.6341,-0.52401;
          2.7594,-0.52401; 2.8381,-0.52401; 2.9624,-0.52401; 3.0084,-0.52401;
          3.1654,-0.52401; 3.2295,-0.52401; 3.3696,-0.52395; 3.4321,-0.52395;
          3.5882,-0.52401; 3.6507,-0.52401; 3.7601,-0.52401; 3.8388,-0.52401;
          3.9631,-0.52395; 4.0253,-0.52395; 4.1653,-0.52401; 4.2273,-0.52401;
          4.3528,-0.52401; 4.4152,-0.52401; 4.5548,-0.52401; 4.6318,-0.52401;
          4.7567,-0.52401; 4.8364,-0.52401; 4.9596,-0.52401; 5.0206,-0.52401;
          5.1612,-0.52401; 5.2075,-0.52401; 5.3317,-0.52401; 5.394,-0.52401;
          5.5347,-0.52401; 5.6134,-0.52401; 5.7384,-0.52401; 5.8014,-0.52401;
          5.8634,-0.52401; 5.9729,-0.52401; 6.0202,-0.52401; 6.1439,-0.52395;
          6.2062,-0.52395; 6.3473,-0.52401; 6.395,-0.52401; 6.4579,-0.52401;
          6.5979,-0.52401; 6.6451,-0.52401; 6.7716,-0.52401; 6.8191,-0.52401;
          6.9411,-0.52401; 7.0031,-0.52401; 7.1558,-0.52401; 7.2172,-0.52401;
          7.3404,-0.52406; 7.4023,-0.52406; 7.4494,-0.52406; 7.6037,-0.52435;
          7.7287,-0.52435; 7.7912,-0.52389; 7.8382,-0.52389; 7.9617,-0.52401;
          8.0087,-0.52401; 8.147,-0.52401; 8.1943,-0.52401; 8.3319,-0.52401;
          8.3941,-0.52401; 8.4563,-0.52401; 8.5963,-0.52401; 8.6578,-0.52401;
          8.7826,-0.52401; 8.8456,-0.52401; 8.9542,-0.52401; 9.032,-0.52401;
          9.172,-0.52401; 9.2192,-0.52401; 9.3411,-0.52401; 9.4026,-0.52401;
          9.4635,-0.52401; 9.6036,-0.52401; 9.6651,-0.52401; 9.7753,-0.52401;
          9.8352,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[0.15595,
          -1.0121; 0.21738,-1.0109; 0.26377,-1.0109; 0.37103,-1.0108;
          0.41692,-1.0108; 0.52794,-1.0108; 0.60443,-1.011; 0.7304,-1.011;
          0.7925,-1.0105; 0.85511,-1.0105; 0.96638,-1.0112; 1.0134,-1.0112;
          1.1664,-1.0112; 1.2144,-1.0119; 1.3533,-1.0119; 1.4149,-1.0119;
          1.5512,-1.0119; 1.6119,-1.0112; 1.6588,-1.0112; 1.7829,-1.0113;
          1.8598,-1.0113; 1.9813,-1.0119; 2.0587,-1.0119; 2.1831,-1.0117;
          2.2457,-1.0117; 2.3707,-1.0104; 2.4331,-1.0104; 2.5875,-1.0117;
          2.6341,-1.0117; 2.7594,-1.0119; 2.8381,-1.0119; 2.9624,-1.0116;
          3.0084,-1.0116; 3.1654,-1.0116; 3.2295,-1.0104; 3.3696,-1.012;
          3.4321,-1.012; 3.5882,-1.0111; 3.6507,-1.011; 3.7601,-1.0103;
          3.8388,-1.0103; 3.9631,-1.011; 4.0253,-1.0111; 4.1653,-1.0105;
          4.2273,-1.0105; 4.3528,-1.0105; 4.4152,-1.0112; 4.5548,-1.0112;
          4.6318,-1.0112; 4.7567,-1.0116; 4.8364,-1.0116; 4.9596,-1.0103;
          5.0206,-1.0103; 5.1612,-1.0103; 5.2075,-1.0114; 5.3317,-1.0114;
          5.394,-1.0117; 5.5347,-1.0117; 5.6134,-1.0111; 5.7384,-1.0111;
          5.8014,-1.0115; 5.8634,-1.0115; 5.9729,-1.0104; 6.0202,-1.0104;
          6.1439,-1.0104; 6.2062,-1.0118; 6.3473,-1.0118; 6.395,-1.0106;
          6.4579,-1.0106; 6.5979,-1.0115; 6.6451,-1.0115; 6.7716,-1.0105;
          6.8191,-1.0105; 6.9411,-1.0105; 7.0031,-1.0109; 7.1558,-1.0109;
          7.2172,-1.0117; 7.3404,-1.0117; 7.4023,-1.012; 7.4494,-1.012;
          7.6037,-1.0199; 7.7287,-1.0199; 7.7912,-1.0241; 7.8382,-1.0241;
          7.9617,-1.024; 8.0087,-1.024; 8.147,-1.024; 8.1943,-1.0243;
          8.3319,-1.0243; 8.3941,-1.0242; 8.4563,-1.0242; 8.5963,-1.0248;
          8.6578,-1.0248; 8.7826,-1.0235; 8.8456,-1.0235; 8.9542,-1.0245;
          9.032,-1.0245; 9.172,-1.0241; 9.2192,-1.0241; 9.3411,-1.0241;
          9.4026,-1.024; 9.4635,-1.024; 9.6036,-1.0254; 9.6651,-1.0254;
          9.7753,-1.0244; 9.8352,-1.0244], extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.15595,1; 0.21738,1;
          0.26377,1; 0.37103,0.99999; 0.41692,0.99999; 0.52794,0.99999;
          0.60443,0.99998; 0.7304,0.99998; 0.7925,1; 0.85511,1; 0.96638,1;
          1.0134,1; 1.1664,1; 1.2144,1; 1.3533,1; 1.4149,0.99999; 1.5512,
          0.99999; 1.6119,1; 1.6588,1; 1.7829,0.99999; 1.8598,0.99999;
          1.9813,1; 2.0587,1; 2.1831,0.99999; 2.2457,0.99999; 2.3707,
          0.99999; 2.4331,1; 2.5875,1; 2.6341,0.99997; 2.7594,0.99997;
          2.8381,1; 2.9624,1; 3.0084,1; 3.1654,1; 3.2295,0.99997; 3.3696,
          0.99997; 3.4321,1; 3.5882,1; 3.6507,0.99999; 3.7601,0.99999;
          3.8388,0.99998; 3.9631,0.99998; 4.0253,1; 4.1653,1; 4.2273,
          0.99996; 4.3528,0.99996; 4.4152,1; 4.5548,1; 4.6318,0.99997;
          4.7567,0.99997; 4.8364,1; 4.9596,1; 5.0206,0.99998; 5.1612,
          0.99998; 5.2075,1; 5.3317,1; 5.394,0.99999; 5.5347,0.99999;
          5.6134,0.99998; 5.7384,0.99998; 5.8014,0.99999; 5.8634,0.99999;
          5.9729,0.99998; 6.0202,0.99998; 6.1439,0.99998; 6.2062,1; 6.3473,
          1; 6.395,0.99998; 6.4579,0.99998; 6.5979,0.99999; 6.6451,0.99999;
          6.7716,0.99999; 6.8191,0.99998; 6.9411,0.99998; 7.0031,0.99996;
          7.1558,0.99996; 7.2172,0.99998; 7.3404,0.99998; 7.4023,0.99903;
          7.4494,0.99903; 7.6037,0.99903; 7.7287,0.95961; 7.7912,0.9594;
          7.8382,0.9594; 7.9617,0.9594; 8.0087,0.95939; 8.147,0.95939;
          8.1943,0.95939; 8.3319,0.95939; 8.3941,0.95941; 8.4563,0.95941;
          8.5963,0.95941; 8.6578,0.95941; 8.7826,0.95941; 8.8456,0.95941;
          8.9542,0.95941; 9.032,0.95943; 9.172,0.95943; 9.2192,0.95942;
          9.3411,0.95942; 9.4026,0.95943; 9.4635,0.95943; 9.6036,0.95944;
          9.6651,0.95944; 9.7753,0.95942; 9.8352,0.95942],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.15595,-0.52401;
          0.21738,-0.52401; 0.26377,-0.52401; 0.37103,-0.52401; 0.41692,-0.52401;
          0.52794,-0.52401; 0.60443,-0.52401; 0.7304,-0.52401; 0.7925,-0.52401;
          0.85511,-0.52401; 0.96638,-0.52401; 1.0134,-0.52401; 1.1664,-0.52401;
          1.2144,-0.52401; 1.3533,-0.52401; 1.4149,-0.52401; 1.5512,-0.52401;
          1.6119,-0.52401; 1.6588,-0.52401; 1.7829,-0.52401; 1.8598,-0.52401;
          1.9813,-0.52401; 2.0587,-0.52401; 2.1831,-0.52401; 2.2457,-0.52401;
          2.3707,-0.52401; 2.4331,-0.52401; 2.5875,-0.52401; 2.6341,-0.52401;
          2.7594,-0.52401; 2.8381,-0.52401; 2.9624,-0.52401; 3.0084,-0.52401;
          3.1654,-0.52401; 3.2295,-0.52401; 3.3696,-0.52395; 3.4321,-0.52395;
          3.5882,-0.52401; 3.6507,-0.52401; 3.7601,-0.52401; 3.8388,-0.52401;
          3.9631,-0.52395; 4.0253,-0.52395; 4.1653,-0.52401; 4.2273,-0.52401;
          4.3528,-0.52401; 4.4152,-0.52401; 4.5548,-0.52401; 4.6318,-0.52401;
          4.7567,-0.52401; 4.8364,-0.52401; 4.9596,-0.52401; 5.0206,-0.52401;
          5.1612,-0.52401; 5.2075,-0.52401; 5.3317,-0.52401; 5.394,-0.52401;
          5.5347,-0.52401; 5.6134,-0.52401; 5.7384,-0.52401; 5.8014,-0.52401;
          5.8634,-0.52401; 5.9729,-0.52401; 6.0202,-0.52401; 6.1439,-0.52395;
          6.2062,-0.52395; 6.3473,-0.52401; 6.395,-0.52401; 6.4579,-0.52401;
          6.5979,-0.52401; 6.6451,-0.52401; 6.7716,-0.52401; 6.8191,-0.52401;
          6.9411,-0.52401; 7.0031,-0.52401; 7.1558,-0.52401; 7.2172,-0.52401;
          7.3404,-0.52406; 7.4023,-0.52406; 7.4494,-0.52406; 7.6037,-0.52435;
          7.7287,-0.52435; 7.7912,-0.52389; 7.8382,-0.52389; 7.9617,-0.52401;
          8.0087,-0.52401; 8.147,-0.52401; 8.1943,-0.52401; 8.3319,-0.52401;
          8.3941,-0.52401; 8.4563,-0.52401; 8.5963,-0.52401; 8.6578,-0.52401;
          8.7826,-0.52401; 8.8456,-0.52401; 8.9542,-0.52401; 9.032,-0.52401;
          9.172,-0.52401; 9.2192,-0.52401; 9.3411,-0.52401; 9.4026,-0.52401;
          9.4635,-0.52401; 9.6036,-0.52401; 9.6651,-0.52401; 9.7753,-0.52401;
          9.8352,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.15595,1; 0.21738,1;
          0.26377,1; 0.37103,0.99999; 0.41692,0.99999; 0.52794,0.99999;
          0.60443,0.99998; 0.7304,0.99998; 0.7925,1; 0.85511,1; 0.96638,1;
          1.0134,1; 1.1664,1; 1.2144,1; 1.3533,1; 1.4149,0.99999; 1.5512,
          0.99999; 1.6119,1; 1.6588,1; 1.7829,0.99999; 1.8598,0.99999;
          1.9813,1; 2.0587,1; 2.1831,0.99999; 2.2457,0.99999; 2.3707,
          0.99999; 2.4331,1; 2.5875,1; 2.6341,0.99997; 2.7594,0.99997;
          2.8381,1; 2.9624,1; 3.0084,1; 3.1654,1; 3.2295,0.99997; 3.3696,
          0.99997; 3.4321,1; 3.5882,1; 3.6507,0.99999; 3.7601,0.99999;
          3.8388,0.99998; 3.9631,0.99998; 4.0253,1; 4.1653,1; 4.2273,
          0.99996; 4.3528,0.99996; 4.4152,1; 4.5548,1; 4.6318,0.99997;
          4.7567,0.99997; 4.8364,1; 4.9596,1; 5.0206,0.99998; 5.1612,
          0.99998; 5.2075,1; 5.3317,1; 5.394,0.99999; 5.5347,0.99999;
          5.6134,0.99998; 5.7384,0.99998; 5.8014,0.99999; 5.8634,0.99999;
          5.9729,0.99998; 6.0202,0.99998; 6.1439,0.99998; 6.2062,1; 6.3473,
          1; 6.395,0.99998; 6.4579,0.99998; 6.5979,0.99999; 6.6451,0.99999;
          6.7716,0.99999; 6.8191,0.99998; 6.9411,0.99998; 7.0031,0.99996;
          7.1558,0.99996; 7.2172,0.99998; 7.3404,0.99998; 7.4023,0.99903;
          7.4494,0.99903; 7.6037,0.99903; 7.7287,0.95961; 7.7912,0.9594;
          7.8382,0.9594; 7.9617,0.9594; 8.0087,0.95939; 8.147,0.95939;
          8.1943,0.95939; 8.3319,0.95939; 8.3941,0.95941; 8.4563,0.95941;
          8.5963,0.95941; 8.6578,0.95941; 8.7826,0.95941; 8.8456,0.95941;
          8.9542,0.95941; 9.032,0.95943; 9.172,0.95943; 9.2192,0.95942;
          9.3411,0.95942; 9.4026,0.95943; 9.4635,0.95943; 9.6036,0.95944;
          9.6651,0.95944; 9.7753,0.95942; 9.8352,0.95942],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.15595,-0.52401;
          0.21738,-0.52401; 0.26377,-0.52401; 0.37103,-0.52401; 0.41692,-0.52401;
          0.52794,-0.52401; 0.60443,-0.52401; 0.7304,-0.52401; 0.7925,-0.52401;
          0.85511,-0.52401; 0.96638,-0.52401; 1.0134,-0.52401; 1.1664,-0.52401;
          1.2144,-0.52401; 1.3533,-0.52401; 1.4149,-0.52401; 1.5512,-0.52401;
          1.6119,-0.52401; 1.6588,-0.52401; 1.7829,-0.52401; 1.8598,-0.52401;
          1.9813,-0.52401; 2.0587,-0.52401; 2.1831,-0.52401; 2.2457,-0.52401;
          2.3707,-0.52401; 2.4331,-0.52401; 2.5875,-0.52401; 2.6341,-0.52401;
          2.7594,-0.52401; 2.8381,-0.52401; 2.9624,-0.52401; 3.0084,-0.52401;
          3.1654,-0.52401; 3.2295,-0.52401; 3.3696,-0.52395; 3.4321,-0.52395;
          3.5882,-0.52401; 3.6507,-0.52401; 3.7601,-0.52401; 3.8388,-0.52401;
          3.9631,-0.52395; 4.0253,-0.52395; 4.1653,-0.52401; 4.2273,-0.52401;
          4.3528,-0.52401; 4.4152,-0.52401; 4.5548,-0.52401; 4.6318,-0.52401;
          4.7567,-0.52401; 4.8364,-0.52401; 4.9596,-0.52401; 5.0206,-0.52401;
          5.1612,-0.52401; 5.2075,-0.52401; 5.3317,-0.52401; 5.394,-0.52401;
          5.5347,-0.52401; 5.6134,-0.52401; 5.7384,-0.52401; 5.8014,-0.52401;
          5.8634,-0.52401; 5.9729,-0.52401; 6.0202,-0.52401; 6.1439,-0.52395;
          6.2062,-0.52395; 6.3473,-0.52401; 6.395,-0.52401; 6.4579,-0.52401;
          6.5979,-0.52401; 6.6451,-0.52401; 6.7716,-0.52401; 6.8191,-0.52401;
          6.9411,-0.52401; 7.0031,-0.52401; 7.1558,-0.52401; 7.2172,-0.52401;
          7.3404,-0.52406; 7.4023,-0.52406; 7.4494,-0.52406; 7.6037,-0.52435;
          7.7287,-0.52435; 7.7912,-0.52389; 7.8382,-0.52389; 7.9617,-0.52401;
          8.0087,-0.52401; 8.147,-0.52401; 8.1943,-0.52401; 8.3319,-0.52401;
          8.3941,-0.52401; 8.4563,-0.52401; 8.5963,-0.52401; 8.6578,-0.52401;
          8.7826,-0.52401; 8.8456,-0.52401; 8.9542,-0.52401; 9.032,-0.52401;
          9.172,-0.52401; 9.2192,-0.52401; 9.3411,-0.52401; 9.4026,-0.52401;
          9.4635,-0.52401; 9.6036,-0.52401; 9.6651,-0.52401; 9.7753,-0.52401;
          9.8352,-0.52401],                                 extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.15595,2.8964; 0.21738,2.8931; 0.26377,2.8931; 0.37103,2.8931;
          0.41692,2.8931; 0.52794,2.8931; 0.60443,2.8898; 0.7304,2.8898;
          0.7925,2.8931; 0.85511,2.8931; 0.96638,2.8931; 1.0134,2.8931;
          1.1664,2.8931; 1.2144,2.8931; 1.3533,2.8931; 1.4149,2.8931;
          1.5512,2.8931; 1.6119,2.8931; 1.6588,2.8931; 1.7829,2.8898;
          1.8598,2.8898; 1.9813,2.8931; 2.0587,2.8931; 2.1831,2.8931;
          2.2457,2.8931; 2.3707,2.8931; 2.4331,2.8898; 2.5875,2.8898;
          2.6341,2.8898; 2.7594,2.8898; 2.8381,2.8964; 2.9624,2.8964;
          3.0084,2.8931; 3.1654,2.8931; 3.2295,2.8898; 3.3696,2.8897;
          3.4321,2.8964; 3.5882,2.8965; 3.6507,2.8931; 3.7601,2.8931;
          3.8388,2.8931; 3.9631,2.8931; 4.0253,2.8964; 4.1653,2.8964;
          4.2273,2.8898; 4.3528,2.8898; 4.4152,2.8931; 4.5548,2.8931;
          4.6318,2.8897; 4.7567,2.8898; 4.8364,2.8964; 4.9596,2.8965;
          5.0206,2.8898; 5.1612,2.8898; 5.2075,2.8931; 5.3317,2.8931; 5.394,
          2.8931; 5.5347,2.8931; 5.6134,2.8898; 5.7384,2.8898; 5.8014,
          2.8964; 5.8634,2.8964; 5.9729,2.8898; 6.0202,2.8898; 6.1439,
          2.8898; 6.2062,2.8964; 6.3473,2.8964; 6.395,2.8931; 6.4579,2.8931;
          6.5979,2.8931; 6.6451,2.8931; 6.7716,2.8931; 6.8191,2.8898;
          6.9411,2.8898; 7.0031,2.8898; 7.1558,2.8898; 7.2172,2.8931;
          7.3404,2.8931; 7.4023,2.9465; 7.4494,2.9465; 7.6037,2.9465;
          7.7287,3.0732; 7.7912,3.0332; 7.8382,3.0332; 7.9617,3.0332;
          8.0087,3.0332; 8.147,3.0332; 8.1943,3.0298; 8.3319,3.0298; 8.3941,
          3.0332; 8.4563,3.0332; 8.5963,3.0332; 8.6578,3.0332; 8.7826,
          3.0332; 8.8456,3.0332; 8.9542,3.0332; 9.032,3.0332; 9.172,3.0332;
          9.2192,3.0298; 9.3411,3.0298; 9.4026,3.0332; 9.4635,3.0332;
          9.6036,3.0331; 9.6651,3.0331; 9.7753,3.0332; 9.8352,3.0332],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.15595,353.92;
          0.21738,353.93; 0.26377,353.93; 0.37103,353.92; 0.41692,353.92;
          0.52794,353.92; 0.60443,353.92; 0.7304,353.92; 0.7925,353.93;
          0.85511,353.93; 0.96638,353.93; 1.0134,353.93; 1.1664,353.93;
          1.2144,353.92; 1.3533,353.92; 1.4149,353.92; 1.5512,353.92;
          1.6119,353.93; 1.6588,353.93; 1.7829,353.92; 1.8598,353.92;
          1.9813,353.93; 2.0587,353.93; 2.1831,353.92; 2.2457,353.92;
          2.3707,353.92; 2.4331,353.92; 2.5875,353.92; 2.6341,353.91;
          2.7594,353.91; 2.8381,353.93; 2.9624,353.93; 3.0084,353.92;
          3.1654,353.92; 3.2295,353.91; 3.3696,353.91; 3.4321,353.93;
          3.5882,353.93; 3.6507,353.92; 3.7601,353.92; 3.8388,353.92;
          3.9631,353.92; 4.0253,353.93; 4.1653,353.93; 4.2273,353.91;
          4.3528,353.91; 4.4152,353.92; 4.5548,353.92; 4.6318,353.91;
          4.7567,353.91; 4.8364,353.92; 4.9596,353.92; 5.0206,353.92;
          5.1612,353.92; 5.2075,353.92; 5.3317,353.92; 5.394,353.92; 5.5347,
          353.92; 5.6134,353.92; 5.7384,353.92; 5.8014,353.92; 5.8634,
          353.92; 5.9729,353.92; 6.0202,353.92; 6.1439,353.92; 6.2062,
          353.92; 6.3473,353.92; 6.395,353.92; 6.4579,353.92; 6.5979,353.92;
          6.6451,353.92; 6.7716,353.92; 6.8191,353.92; 6.9411,353.92;
          7.0031,353.91; 7.1558,353.91; 7.2172,353.92; 7.3404,353.92;
          7.4023,353.58; 7.4494,353.58; 7.6037,353.58; 7.7287,339.63;
          7.7912,339.55; 7.8382,339.55; 7.9617,339.55; 8.0087,339.55; 8.147,
          339.55; 8.1943,339.55; 8.3319,339.55; 8.3941,339.56; 8.4563,
          339.56; 8.5963,339.56; 8.6578,339.56; 8.7826,339.56; 8.8456,
          339.56; 8.9542,339.56; 9.032,339.57; 9.172,339.57; 9.2192,339.56;
          9.3411,339.56; 9.4026,339.57; 9.4635,339.57; 9.6036,339.57;
          9.6651,339.57; 9.7753,339.56; 9.8352,339.56],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_335_V;

  model VoltageVariation_350_to_330_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.12689,904.73; 0.18793,
          903.56; 0.32603,903.56; 0.38918,904.18; 0.54505,904.18; 0.60702,904.98;
          0.7326,904.98; 0.81161,904.74; 0.95393,904.71; 1.033,905.84; 1.1576,905.64;
          1.2519,903.55; 1.376,904.09; 1.4541,905.14; 1.6103,904.67; 1.6571,904.67;
          1.7989,906.03; 1.8622,906.03; 2.0169,903.6; 2.1403,903.6; 2.1874,904.53;
          2.3267,904.53; 2.3894,904.79; 2.5443,904.79; 2.6228,904.07; 2.7629,904.07;
          2.8255,905.46; 2.9354,905.46; 3.0291,904.18; 3.1528,903.79; 3.2314,904.86;
          3.3571,904.74; 3.418,903.68; 3.5729,903.71; 3.6349,904.61; 3.7734,904.61;
          3.8341,903.78; 3.9728,904.24; 4.0487,904.21; 4.1896,903.33; 4.329,905.46;
          4.3916,905.21; 4.4538,905.21; 4.6258,938.76; 4.7838,922.63; 4.8601,905.8;
          5.002,902.52; 5.1423,902.55; 5.2048,902.88; 5.3286,902.88; 5.3897,902.49;
          5.4512,902.49; 5.6073,902.55; 5.7335,901.56; 5.7951,902.94; 5.8581,902.94;
          5.9667,902.58; 6.1208,902.58; 6.1827,901.23; 6.2609,901.23; 6.3689,902.51;
          6.4161,902.51; 6.5548,902.48; 6.6314,902.49; 6.7698,902.43; 6.8169,902.43;
          6.9436,902.43; 7.0066,901.49; 7.1456,901.49; 7.2079,902.35; 7.3309,902.38;
          7.3946,902.8; 7.4415,902.8; 7.5828,901.9; 7.6459,900.92; 7.7726,901.71;
          7.8333,902.66], extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.12689,479.47; 0.18793,
          479.14; 0.32603,479.14; 0.38918,480.46; 0.54505,480.46; 0.60702,478.99;
          0.7326,478.99; 0.81161,479.41; 0.95393,479.46; 1.033,479.88; 1.1576,480.25;
          1.2519,479.14; 1.376,478.14; 1.4541,478.67; 1.6103,479.57; 1.6571,479.57;
          1.7989,479.57; 1.8622,479.57; 2.0169,479.02; 2.1403,479.02; 2.1874,479.83;
          2.3267,479.83; 2.3894,479.31; 2.5443,479.31; 2.6228,478.19; 2.7629,478.19;
          2.8255,480.62; 2.9354,480.62; 3.0291,477.91; 3.1528,478.65; 3.2314,479.2;
          3.3571,479.41; 3.418,478.87; 3.5729,478.81; 3.6349,479.68; 3.7734,479.68;
          3.8341,478.72; 3.9728,477.88; 4.0487,477.87; 4.1896,479.49; 4.329,480.62;
          4.3916,478.51; 4.4538,478.51; 4.6258,486.83; 4.7838,516.66; 4.8601,507.21;
          5.002,498.51; 5.1423,498.46; 5.2048,497.76; 5.3286,497.76; 5.3897,498.5;
          5.4512,498.5; 5.6073,498.39; 5.7335,497.86; 5.7951,497.72; 5.8581,497.72;
          5.9667,498.35; 6.1208,498.35; 6.1827,498.51; 6.2609,498.51; 6.3689,498.52;
          6.4161,498.52; 6.5548,498.57; 6.6314,498.57; 6.7698,498.68; 6.8169,498.68;
          6.9436,498.68; 7.0066,498.04; 7.1456,498.04; 7.2079,498.83; 7.3309,498.78;
          7.3946,497.99; 7.4415,497.99; 7.5828,499.61; 7.6459,499.08; 7.7726,497.67;
          7.8333,498.19],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.12689,1; 0.18793,0.99999; 0.32603,
          0.99999; 0.38918,0.99999; 0.54505,0.99999; 0.60702,0.99999; 0.7326,0.99999;
          0.81161,0.99998; 0.95393,0.99998; 1.033,1; 1.1576,1; 1.2519,0.99999; 1.376,
          0.99999; 1.4541,0.99999; 1.6103,0.99999; 1.6571,0.99999; 1.7989,1; 1.8622,
          1; 2.0169,0.99998; 2.1403,0.99998; 2.1874,0.99999; 2.3267,0.99999; 2.3894,
          0.99998; 2.5443,0.99998; 2.6228,0.99999; 2.7629,0.99999; 2.8255,1; 2.9354,
          1; 3.0291,0.99996; 3.1528,0.99996; 3.2314,0.99999; 3.3571,0.99999; 3.418,
          0.99998; 3.5729,0.99998; 3.6349,0.99999; 3.7734,0.99999; 3.8341,0.99999;
          3.9728,0.99999; 4.0487,0.99996; 4.1896,0.99996; 4.329,1; 4.3916,0.99998;
          4.4538,0.99998; 4.6258,0.996; 4.7838,0.996; 4.8601,0.94628; 5.002,0.9459;
          5.1423,0.9459; 5.2048,0.94584; 5.3286,0.94584; 5.3897,0.94586; 5.4512,0.94586;
          5.6073,0.94586; 5.7335,0.94586; 5.7951,0.94587; 5.8581,0.94587; 5.9667,0.94587;
          6.1208,0.94587; 6.1827,0.94588; 6.2609,0.94588; 6.3689,0.94589; 6.4161,0.94589;
          6.5548,0.94589; 6.6314,0.9459; 6.7698,0.9459; 6.8169,0.9459; 6.9436,0.9459;
          7.0066,0.94588; 7.1456,0.94588; 7.2079,0.9459; 7.3309,0.9459; 7.3946,0.94588;
          7.4415,0.94588; 7.5828,0.94588; 7.6459,0.94589; 7.7726,0.94589; 7.8333,0.94586],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.12689,-0.52401; 0.18793,-0.52401;
          0.32603,-0.52401; 0.38918,-0.52401; 0.54505,-0.52401; 0.60702,-0.52401;
          0.7326,-0.52401; 0.81161,-0.52401; 0.95393,-0.52395; 1.033,-0.52395; 1.1576,
          -0.52401; 1.2519,-0.52401; 1.376,-0.52395; 1.4541,-0.52395; 1.6103,-0.52401;
          1.6571,-0.52401; 1.7989,-0.52401; 1.8622,-0.52401; 2.0169,-0.52401; 2.1403,
          -0.52401; 2.1874,-0.52401; 2.3267,-0.52401; 2.3894,-0.52401; 2.5443,-0.52401;
          2.6228,-0.52401; 2.7629,-0.52401; 2.8255,-0.52401; 2.9354,-0.52401; 3.0291,
          -0.52401; 3.1528,-0.52401; 3.2314,-0.52401; 3.3571,-0.52395; 3.418,-0.52395;
          3.5729,-0.52401; 3.6349,-0.52401; 3.7734,-0.52401; 3.8341,-0.52401; 3.9728,
          -0.52401; 4.0487,-0.52401; 4.1896,-0.52395; 4.329,-0.52395; 4.3916,-0.52401;
          4.4538,-0.52401; 4.6258,-0.52447; 4.7838,-0.52377; 4.8601,-0.52377; 5.002,
          -0.52395; 5.1423,-0.52401; 5.2048,-0.52401; 5.3286,-0.52401; 5.3897,-0.52401;
          5.4512,-0.52401; 5.6073,-0.52401; 5.7335,-0.52401; 5.7951,-0.52401; 5.8581,
          -0.52401; 5.9667,-0.52401; 6.1208,-0.52401; 6.1827,-0.52401; 6.2609,-0.52401;
          6.3689,-0.52406; 6.4161,-0.52406; 6.5548,-0.52401; 6.6314,-0.52401; 6.7698,
          -0.52401; 6.8169,-0.52401; 6.9436,-0.52401; 7.0066,-0.52401; 7.1456,-0.52401;
          7.2079,-0.52401; 7.3309,-0.52406; 7.3946,-0.52406; 7.4415,-0.52406; 7.5828,
          -0.52395; 7.6459,-0.52395; 7.7726,-0.52401; 7.8333,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[0.12689,-1.0113;
          0.18793,-1.0116; 0.32603,-1.0116; 0.38918,-1.0124; 0.54505,-1.0124; 0.60702,
          -1.0108; 0.7326,-1.0108; 0.81161,-1.0113; 0.95393,-1.0113; 1.033,-1.0111;
          1.1576,-1.0116; 1.2519,-1.0116; 1.376,-1.0104; 1.4541,-1.0104; 1.6103,-1.0114;
          1.6571,-1.0114; 1.7989,-1.0108; 1.8622,-1.0108; 2.0169,-1.0115; 2.1403,-1.0115;
          2.1874,-1.0117; 2.3267,-1.0117; 2.3894,-1.0112; 2.5443,-1.0112; 2.6228,-1.0105;
          2.7629,-1.0105; 2.8255,-1.012; 2.9354,-1.012; 3.0291,-1.0102; 3.1528,-1.0111;
          3.2314,-1.011; 3.3571,-1.0112; 3.418,-1.0112; 3.5729,-1.0112; 3.6349,-1.0116;
          3.7734,-1.0116; 3.8341,-1.0111; 3.9728,-1.0102; 4.0487,-1.0102; 4.1896,-1.0119;
          4.329,-1.0119; 4.3916,-1.0103; 4.4538,-1.0103; 4.6258,-1.0029; 4.7838,-1.0343;
          4.8601,-1.0342; 5.002,-1.0286; 5.1423,-1.0286; 5.2048,-1.0278; 5.3286,-1.0278;
          5.3897,-1.0287; 5.4512,-1.0287; 5.6073,-1.0285; 5.7335,-1.0286; 5.7951,-1.0278;
          5.8581,-1.0278; 5.9667,-1.0285; 6.1208,-1.0285; 6.1827,-1.0293; 6.2609,-1.0293;
          6.3689,-1.0287; 6.4161,-1.0287; 6.5548,-1.0287; 6.6314,-1.0287; 6.7698,-1.0288;
          6.8169,-1.0288; 6.9436,-1.0288; 7.0066,-1.0287; 7.1456,-1.0287; 7.2079,-1.029;
          7.3309,-1.029; 7.3946,-1.0281; 7.4415,-1.0281; 7.5828,-1.0298; 7.6459,-1.0298;
          7.7726,-1.0283; 7.8333,-1.0283], extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.12689,1; 0.18793,0.99999; 0.32603,
          0.99999; 0.38918,0.99999; 0.54505,0.99999; 0.60702,0.99999; 0.7326,0.99999;
          0.81161,0.99998; 0.95393,0.99998; 1.033,1; 1.1576,1; 1.2519,0.99999; 1.376,
          0.99999; 1.4541,0.99999; 1.6103,0.99999; 1.6571,0.99999; 1.7989,1; 1.8622,
          1; 2.0169,0.99998; 2.1403,0.99998; 2.1874,0.99999; 2.3267,0.99999; 2.3894,
          0.99998; 2.5443,0.99998; 2.6228,0.99999; 2.7629,0.99999; 2.8255,1; 2.9354,
          1; 3.0291,0.99996; 3.1528,0.99996; 3.2314,0.99999; 3.3571,0.99999; 3.418,
          0.99998; 3.5729,0.99998; 3.6349,0.99999; 3.7734,0.99999; 3.8341,0.99999;
          3.9728,0.99999; 4.0487,0.99996; 4.1896,0.99996; 4.329,1; 4.3916,0.99998;
          4.4538,0.99998; 4.6258,0.996; 4.7838,0.996; 4.8601,0.94628; 5.002,0.9459;
          5.1423,0.9459; 5.2048,0.94584; 5.3286,0.94584; 5.3897,0.94586; 5.4512,0.94586;
          5.6073,0.94586; 5.7335,0.94586; 5.7951,0.94587; 5.8581,0.94587; 5.9667,0.94587;
          6.1208,0.94587; 6.1827,0.94588; 6.2609,0.94588; 6.3689,0.94589; 6.4161,0.94589;
          6.5548,0.94589; 6.6314,0.9459; 6.7698,0.9459; 6.8169,0.9459; 6.9436,0.9459;
          7.0066,0.94588; 7.1456,0.94588; 7.2079,0.9459; 7.3309,0.9459; 7.3946,0.94588;
          7.4415,0.94588; 7.5828,0.94588; 7.6459,0.94589; 7.7726,0.94589; 7.8333,0.94586],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.12689,-0.52401; 0.18793,-0.52401;
          0.32603,-0.52401; 0.38918,-0.52401; 0.54505,-0.52401; 0.60702,-0.52401;
          0.7326,-0.52401; 0.81161,-0.52401; 0.95393,-0.52395; 1.033,-0.52395; 1.1576,
          -0.52401; 1.2519,-0.52401; 1.376,-0.52395; 1.4541,-0.52395; 1.6103,-0.52401;
          1.6571,-0.52401; 1.7989,-0.52401; 1.8622,-0.52401; 2.0169,-0.52401; 2.1403,
          -0.52401; 2.1874,-0.52401; 2.3267,-0.52401; 2.3894,-0.52401; 2.5443,-0.52401;
          2.6228,-0.52401; 2.7629,-0.52401; 2.8255,-0.52401; 2.9354,-0.52401; 3.0291,
          -0.52401; 3.1528,-0.52401; 3.2314,-0.52401; 3.3571,-0.52395; 3.418,-0.52395;
          3.5729,-0.52401; 3.6349,-0.52401; 3.7734,-0.52401; 3.8341,-0.52401; 3.9728,
          -0.52401; 4.0487,-0.52401; 4.1896,-0.52395; 4.329,-0.52395; 4.3916,-0.52401;
          4.4538,-0.52401; 4.6258,-0.52447; 4.7838,-0.52377; 4.8601,-0.52377; 5.002,
          -0.52395; 5.1423,-0.52401; 5.2048,-0.52401; 5.3286,-0.52401; 5.3897,-0.52401;
          5.4512,-0.52401; 5.6073,-0.52401; 5.7335,-0.52401; 5.7951,-0.52401; 5.8581,
          -0.52401; 5.9667,-0.52401; 6.1208,-0.52401; 6.1827,-0.52401; 6.2609,-0.52401;
          6.3689,-0.52406; 6.4161,-0.52406; 6.5548,-0.52401; 6.6314,-0.52401; 6.7698,
          -0.52401; 6.8169,-0.52401; 6.9436,-0.52401; 7.0066,-0.52401; 7.1456,-0.52401;
          7.2079,-0.52401; 7.3309,-0.52406; 7.3946,-0.52406; 7.4415,-0.52406; 7.5828,
          -0.52395; 7.6459,-0.52395; 7.7726,-0.52401; 7.8333,-0.52401],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.12689,1; 0.18793,0.99999; 0.32603,
          0.99999; 0.38918,0.99999; 0.54505,0.99999; 0.60702,0.99999; 0.7326,0.99999;
          0.81161,0.99998; 0.95393,0.99998; 1.033,1; 1.1576,1; 1.2519,0.99999; 1.376,
          0.99999; 1.4541,0.99999; 1.6103,0.99999; 1.6571,0.99999; 1.7989,1; 1.8622,
          1; 2.0169,0.99998; 2.1403,0.99998; 2.1874,0.99999; 2.3267,0.99999; 2.3894,
          0.99998; 2.5443,0.99998; 2.6228,0.99999; 2.7629,0.99999; 2.8255,1; 2.9354,
          1; 3.0291,0.99996; 3.1528,0.99996; 3.2314,0.99999; 3.3571,0.99999; 3.418,
          0.99998; 3.5729,0.99998; 3.6349,0.99999; 3.7734,0.99999; 3.8341,0.99999;
          3.9728,0.99999; 4.0487,0.99996; 4.1896,0.99996; 4.329,1; 4.3916,0.99998;
          4.4538,0.99998; 4.6258,0.996; 4.7838,0.996; 4.8601,0.94628; 5.002,0.9459;
          5.1423,0.9459; 5.2048,0.94584; 5.3286,0.94584; 5.3897,0.94586; 5.4512,0.94586;
          5.6073,0.94586; 5.7335,0.94586; 5.7951,0.94587; 5.8581,0.94587; 5.9667,0.94587;
          6.1208,0.94587; 6.1827,0.94588; 6.2609,0.94588; 6.3689,0.94589; 6.4161,0.94589;
          6.5548,0.94589; 6.6314,0.9459; 6.7698,0.9459; 6.8169,0.9459; 6.9436,0.9459;
          7.0066,0.94588; 7.1456,0.94588; 7.2079,0.9459; 7.3309,0.9459; 7.3946,0.94588;
          7.4415,0.94588; 7.5828,0.94588; 7.6459,0.94589; 7.7726,0.94589; 7.8333,0.94586],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.12689,-0.52401; 0.18793,-0.52401;
          0.32603,-0.52401; 0.38918,-0.52401; 0.54505,-0.52401; 0.60702,-0.52401;
          0.7326,-0.52401; 0.81161,-0.52401; 0.95393,-0.52395; 1.033,-0.52395; 1.1576,
          -0.52401; 1.2519,-0.52401; 1.376,-0.52395; 1.4541,-0.52395; 1.6103,-0.52401;
          1.6571,-0.52401; 1.7989,-0.52401; 1.8622,-0.52401; 2.0169,-0.52401; 2.1403,
          -0.52401; 2.1874,-0.52401; 2.3267,-0.52401; 2.3894,-0.52401; 2.5443,-0.52401;
          2.6228,-0.52401; 2.7629,-0.52401; 2.8255,-0.52401; 2.9354,-0.52401; 3.0291,
          -0.52401; 3.1528,-0.52401; 3.2314,-0.52401; 3.3571,-0.52395; 3.418,-0.52395;
          3.5729,-0.52401; 3.6349,-0.52401; 3.7734,-0.52401; 3.8341,-0.52401; 3.9728,
          -0.52401; 4.0487,-0.52401; 4.1896,-0.52395; 4.329,-0.52395; 4.3916,-0.52401;
          4.4538,-0.52401; 4.6258,-0.52447; 4.7838,-0.52377; 4.8601,-0.52377; 5.002,
          -0.52395; 5.1423,-0.52401; 5.2048,-0.52401; 5.3286,-0.52401; 5.3897,-0.52401;
          5.4512,-0.52401; 5.6073,-0.52401; 5.7335,-0.52401; 5.7951,-0.52401; 5.8581,
          -0.52401; 5.9667,-0.52401; 6.1208,-0.52401; 6.1827,-0.52401; 6.2609,-0.52401;
          6.3689,-0.52406; 6.4161,-0.52406; 6.5548,-0.52401; 6.6314,-0.52401; 6.7698,
          -0.52401; 6.8169,-0.52401; 6.9436,-0.52401; 7.0066,-0.52401; 7.1456,-0.52401;
          7.2079,-0.52401; 7.3309,-0.52406; 7.3946,-0.52406; 7.4415,-0.52406; 7.5828,
          -0.52395; 7.6459,-0.52395; 7.7726,-0.52401; 7.8333,-0.52401],
                                                            extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[0.12689,2.8931;
          0.18793,2.8898; 0.32603,2.8898; 0.38918,2.8931; 0.54505,2.8931; 0.60702,
          2.8931; 0.7326,2.8931; 0.81161,2.8931; 0.95393,2.8931; 1.033,2.8964; 1.1576,
          2.8964; 1.2519,2.8897; 1.376,2.8898; 1.4541,2.8931; 1.6103,2.8931; 1.6571,
          2.8931; 1.7989,2.8964; 1.8622,2.8964; 2.0169,2.8897; 2.1403,2.8897; 2.1874,
          2.8931; 2.3267,2.8931; 2.3894,2.8931; 2.5443,2.8931; 2.6228,2.8898; 2.7629,
          2.8898; 2.8255,2.8964; 2.9354,2.8964; 3.0291,2.8898; 3.1528,2.8898; 3.2314,
          2.8931; 3.3571,2.8931; 3.418,2.8897; 3.5729,2.8897; 3.6349,2.8931; 3.7734,
          2.8931; 3.8341,2.8897; 3.9728,2.8898; 4.0487,2.8898; 4.1896,2.8898; 4.329,
          2.8964; 4.3916,2.8931; 4.4538,2.8931; 4.6258,2.9999; 4.7838,2.9998; 4.8601,
          3.0998; 5.002,3.0799; 5.1423,3.0799; 5.2048,3.0799; 5.3286,3.0799; 5.3897,
          3.0799; 5.4512,3.0799; 5.6073,3.0799; 5.7335,3.0765; 5.7951,3.0799; 5.8581,
          3.0799; 5.9667,3.0799; 6.1208,3.0799; 6.1827,3.0765; 6.2609,3.0765; 6.3689,
          3.0799; 6.4161,3.0799; 6.5548,3.0799; 6.6314,3.0799; 6.7698,3.0799; 6.8169,
          3.0799; 6.9436,3.0799; 7.0066,3.0765; 7.1456,3.0765; 7.2079,3.0799; 7.3309,
          3.0799; 7.3946,3.0799; 7.4415,3.0799; 7.5828,3.0798; 7.6459,3.0765; 7.7726,
          3.0765; 7.8333,3.0799],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.12689,353.92; 0.18793,
          353.92; 0.32603,353.92; 0.38918,353.92; 0.54505,353.92; 0.60702,353.92;
          0.7326,353.92; 0.81161,353.91; 0.95393,353.91; 1.033,353.92; 1.1576,353.92;
          1.2519,353.92; 1.376,353.92; 1.4541,353.92; 1.6103,353.92; 1.6571,353.92;
          1.7989,353.92; 1.8622,353.92; 2.0169,353.91; 2.1403,353.91; 2.1874,353.92;
          2.3267,353.92; 2.3894,353.91; 2.5443,353.91; 2.6228,353.92; 2.7629,353.92;
          2.8255,353.92; 2.9354,353.92; 3.0291,353.91; 3.1528,353.91; 3.2314,353.92;
          3.3571,353.92; 3.418,353.91; 3.5729,353.91; 3.6349,353.92; 3.7734,353.92;
          3.8341,353.92; 3.9728,353.92; 4.0487,353.91; 4.1896,353.91; 4.329,353.92;
          4.3916,353.91; 4.4538,353.91; 4.6258,352.51; 4.7838,352.51; 4.8601,334.91;
          5.002,334.77; 5.1423,334.77; 5.2048,334.75; 5.3286,334.75; 5.3897,334.76;
          5.4512,334.76; 5.6073,334.76; 5.7335,334.76; 5.7951,334.76; 5.8581,334.76;
          5.9667,334.76; 6.1208,334.76; 6.1827,334.77; 6.2609,334.77; 6.3689,334.77;
          6.4161,334.77; 6.5548,334.77; 6.6314,334.77; 6.7698,334.77; 6.8169,334.77;
          6.9436,334.77; 7.0066,334.77; 7.1456,334.77; 7.2079,334.77; 7.3309,334.77;
          7.3946,334.77; 7.4415,334.77; 7.5828,334.77; 7.6459,334.77; 7.7726,334.77;
          7.8333,334.76], extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_330_V;
end Over090PowerFactor;
