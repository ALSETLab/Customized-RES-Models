within OpenRESV.RES_Model_vs_PHIL_Inverter.ConstantPFTerminalVoltageVariance;
package Over095PowerFactor
  "Model validation for inverter experiment with constant power factor mode - 0.95 Overexcited."
  model VoltageVariation_350_to_340_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.1422,920.8;
          0.18922,920.8; 0.314,920.8; 0.37572,921.95; 0.51682,921.95;
          0.56396,920.86; 0.70518,920.86; 0.78404,921.1; 0.94075,921.09;
          0.98797,921.68; 1.1291,921.7; 1.1921,920.66; 1.3013,920.66;
          1.3644,920.77; 1.5244,920.77; 1.6024,921.71; 1.7125,921.71;
          1.7754,921.99; 1.9167,921.99; 1.979,921.06; 2.106,921.06; 2.1692,
          921.02; 2.231,921.02; 2.357,920.6; 2.405,920.6; 2.531,920.62;
          2.594,921.74; 2.7195,921.74; 2.7823,920.95; 2.9061,920.95; 2.9683,
          921.94; 3.0312,921.94; 3.1561,919.88; 3.2034,919.88; 3.3457,
          919.62; 3.4085,921.86; 3.5358,922.14; 3.613,921.02; 3.7231,921;
          3.7859,920.99; 3.9235,920.97; 3.9849,920.85; 4.1221,920.85;
          4.1841,920.69; 4.3064,920.69; 4.367,921.06; 4.5013,921.06; 4.5623,
          921.9; 4.624,921.9; 4.7444,921.92; 4.8379,920.83; 4.98,921.75;
          5.106,921.75; 5.1844,945.3; 5.31,945.18; 5.4045,921.63; 5.5437,
          922.1; 5.6199,918.85; 5.7589,918.85; 5.8199,918.85; 5.9618,918.32;
          6.0242,920.51; 6.1634,920.82; 6.2247,919.69; 6.332,919.91; 6.4086,
          919.96; 6.5463,919.42; 6.6232,921.58; 6.7454,918.44; 6.8055,
          918.44; 6.9586,918.62; 7.0976,919.68; 7.1897,921.88; 7.3107,
          921.88; 7.403,918.66; 7.5581,918.67; 7.7106,920.82; 7.7725,921.45;
          7.8345,921.45; 7.9737,918.44; 8.1136,918.44; 8.1916,919.78],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.1422,
          333.05; 0.18922,333.04; 0.314,333.04; 0.37572,333.36; 0.51682,
          333.36; 0.56396,332.83; 0.70518,332.83; 0.78404,332.25; 0.94075,
          332.3; 0.98797,334.05; 1.1291,334; 1.1921,333.43; 1.3013,333.43;
          1.3644,333.04; 1.5244,333.04; 1.6024,334; 1.7125,334; 1.7754,
          333.19; 1.9167,333.19; 1.979,332.24; 2.106,332.24; 2.1692,332.51;
          2.231,332.51; 2.357,333.52; 2.405,333.52; 2.531,333.47; 2.594,
          333.9; 2.7195,333.9; 2.7823,332.56; 2.9061,332.56; 2.9683,333.35;
          3.0312,333.35; 3.1561,332.07; 3.2034,332.07; 3.3457,332.76;
          3.4085,333.57; 3.5358,332.83; 3.613,332.4; 3.7231,332.46; 3.7859,
          332.46; 3.9235,332.51; 3.9849,332.88; 4.1221,332.88; 4.1841,
          333.36; 4.3064,333.36; 4.367,332.29; 4.5013,332.29; 4.5623,333.4;
          4.624,333.4; 4.7444,333.3; 4.8379,332.88; 4.98,333.89; 5.106,
          333.89; 5.1844,351.32; 5.31,351.65; 5.4045,343.39; 5.5437,342.15;
          5.6199,340.95; 5.7589,340.96; 5.8199,340.96; 5.9618,342.33;
          6.0242,343.17; 6.1634,342.37; 6.2247,341.94; 6.332,341.35; 6.4086,
          341.35; 6.5463,342.78; 6.6232,343.6; 6.7454,342.14; 6.8055,342.14;
          6.9586,341.66; 7.0976,342.06; 7.1897,342.81; 7.3107,342.81; 7.403,
          341.56; 7.5581,341.56; 7.7106,342.34; 7.7725,343.99; 7.8345,
          343.99; 7.9737,342.2; 8.1136,342.2; 8.1916,341.9],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.1422,1; 0.18922,
          0.99999; 0.314,0.99999; 0.37572,1; 0.51682,1; 0.56396,0.99999;
          0.70518,0.99999; 0.78404,1; 0.94075,1; 0.98797,0.99999; 1.1291,
          0.99999; 1.1921,1; 1.3013,1; 1.3644,0.99996; 1.5244,0.99996;
          1.6024,1; 1.7125,1; 1.7754,0.99999; 1.9167,0.99999; 1.979,0.99997;
          2.106,0.99997; 2.1692,1; 2.231,1; 2.357,0.99998; 2.405,0.99998;
          2.531,0.99998; 2.594,1; 2.7195,1; 2.7823,0.99998; 2.9061,0.99998;
          2.9683,1; 3.0312,1; 3.1561,0.99997; 3.2034,0.99997; 3.3457,
          0.99997; 3.4085,1; 3.5358,1; 3.613,0.99999; 3.7231,0.99999;
          3.7859,0.99998; 3.9235,0.99998; 3.9849,0.99999; 4.1221,0.99999;
          4.1841,1; 4.3064,1; 4.367,0.99998; 4.5013,0.99998; 4.5623,0.99997;
          4.624,0.99997; 4.7444,0.99997; 4.8379,0.99998; 4.98,1; 5.106,1;
          5.1844,0.97587; 5.31,0.97587; 5.4045,0.97281; 5.5437,0.97281;
          5.6199,0.97279; 5.7589,0.97278; 5.8199,0.97278; 5.9618,0.97278;
          6.0242,0.97284; 6.1634,0.97284; 6.2247,0.97277; 6.332,0.97277;
          6.4086,0.97281; 6.5463,0.97281; 6.6232,0.97283; 6.7454,0.97282;
          6.8055,0.97282; 6.9586,0.97282; 7.0976,0.97281; 7.1897,0.97284;
          7.3107,0.97284; 7.403,0.97282; 7.5581,0.97282; 7.7106,0.97282;
          7.7725,0.97285; 7.8345,0.97285; 7.9737,0.97284; 8.1136,0.97284;
          8.1916,0.97284],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.1422,-0.52377;
          0.18922,-0.52377; 0.314,-0.52377; 0.37572,-0.52377; 0.51682,-0.52377;
          0.56396,-0.52377; 0.70518,-0.52377; 0.78404,-0.52377; 0.94075,-0.52372;
          0.98797,-0.52372; 1.1291,-0.52377; 1.1921,-0.52377; 1.3013,-0.52377;
          1.3644,-0.52377; 1.5244,-0.52377; 1.6024,-0.52377; 1.7125,-0.52377;
          1.7754,-0.52377; 1.9167,-0.52377; 1.979,-0.52377; 2.106,-0.52377;
          2.1692,-0.52372; 2.231,-0.52372; 2.357,-0.52377; 2.405,-0.52377;
          2.531,-0.52377; 2.594,-0.52377; 2.7195,-0.52377; 2.7823,-0.52377;
          2.9061,-0.52377; 2.9683,-0.52372; 3.0312,-0.52372; 3.1561,-0.52377;
          3.2034,-0.52377; 3.3457,-0.52377; 3.4085,-0.52377; 3.5358,-0.52377;
          3.613,-0.52377; 3.7231,-0.52383; 3.7859,-0.52383; 3.9235,-0.52377;
          3.9849,-0.52377; 4.1221,-0.52377; 4.1841,-0.52377; 4.3064,-0.52377;
          4.367,-0.52377; 4.5013,-0.52377; 4.5623,-0.52377; 4.624,-0.52377;
          4.7444,-0.52377; 4.8379,-0.52377; 4.98,-0.52372; 5.106,-0.52372;
          5.1844,-0.52418; 5.31,-0.52383; 5.4045,-0.52383; 5.5437,-0.52383;
          5.6199,-0.52383; 5.7589,-0.52383; 5.8199,-0.52383; 5.9618,-0.52377;
          6.0242,-0.52377; 6.1634,-0.52383; 6.2247,-0.52383; 6.332,-0.52383;
          6.4086,-0.52383; 6.5463,-0.52377; 6.6232,-0.52377; 6.7454,-0.52383;
          6.8055,-0.52383; 6.9586,-0.52383; 7.0976,-0.52383; 7.1897,-0.52383;
          7.3107,-0.52383; 7.403,-0.52383; 7.5581,-0.52383; 7.7106,-0.52383;
          7.7725,-0.52377; 7.8345,-0.52377; 7.9737,-0.52383; 8.1136,-0.52383;
          8.1916,-0.52383],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[0.1422,
          -0.87082; 0.18922,-0.87082; 0.314,-0.87082; 0.37572,-0.87073;
          0.51682,-0.87073; 0.56396,-0.8706; 0.70518,-0.8706; 0.78404,-0.86996;
          0.94075,-0.86996; 0.98797,-0.87143; 1.1291,-0.87143; 1.1921,-0.87124;
          1.3013,-0.87124; 1.3644,-0.87083; 1.5244,-0.87083; 1.6024,-0.87143;
          1.7125,-0.87143; 1.7754,-0.87055; 1.9167,-0.87055; 1.979,-0.86996;
          2.106,-0.86996; 2.1692,-0.87018; 2.231,-0.87018; 2.357,-0.87135;
          2.405,-0.87135; 2.531,-0.8713; 2.594,-0.87132; 2.7195,-0.87132;
          2.7823,-0.8703; 2.9061,-0.8703; 2.9683,-0.87066; 3.0312,-0.87066;
          3.1561,-0.87021; 3.2034,-0.87021; 3.3457,-0.87096; 3.4085,-0.87096;
          3.5358,-0.87015; 3.613,-0.87013; 3.7231,-0.87025; 3.7859,-0.87025;
          3.9235,-0.87025; 3.9849,-0.87065; 4.1221,-0.87065; 4.1841,-0.87117;
          4.3064,-0.87117; 4.367,-0.87001; 4.5013,-0.87001; 4.5623,-0.87078;
          4.624,-0.87078; 4.7444,-0.87068; 4.8379,-0.87066; 4.98,-0.87125;
          5.106,-0.87125; 5.1844,-0.88001; 5.31,-0.88001; 5.4045,-0.88049;
          5.5437,-0.87914; 5.6199,-0.87914; 5.7589,-0.87915; 5.8199,-0.87915;
          5.9618,-0.8806; 6.0242,-0.88061; 6.1634,-0.87981; 6.2247,-0.87979;
          6.332,-0.87915; 6.4086,-0.87914; 6.5463,-0.88064; 6.6232,-0.88065;
          6.7454,-0.88043; 6.8055,-0.88043; 6.9586,-0.87991; 7.0976,-0.87991;
          7.1897,-0.87985; 7.3107,-0.87985; 7.403,-0.8798; 7.5581,-0.87979;
          7.7106,-0.87977; 7.7725,-0.88106; 7.8345,-0.88106; 7.9737,-0.88048;
          8.1136,-0.88048; 8.1916,-0.87972],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.1422,1; 0.18922,
          0.99999; 0.314,0.99999; 0.37572,1; 0.51682,1; 0.56396,0.99999;
          0.70518,0.99999; 0.78404,1; 0.94075,1; 0.98797,0.99999; 1.1291,
          0.99999; 1.1921,1; 1.3013,1; 1.3644,0.99996; 1.5244,0.99996;
          1.6024,1; 1.7125,1; 1.7754,0.99999; 1.9167,0.99999; 1.979,0.99997;
          2.106,0.99997; 2.1692,1; 2.231,1; 2.357,0.99998; 2.405,0.99998;
          2.531,0.99998; 2.594,1; 2.7195,1; 2.7823,0.99998; 2.9061,0.99998;
          2.9683,1; 3.0312,1; 3.1561,0.99997; 3.2034,0.99997; 3.3457,
          0.99997; 3.4085,1; 3.5358,1; 3.613,0.99999; 3.7231,0.99999;
          3.7859,0.99998; 3.9235,0.99998; 3.9849,0.99999; 4.1221,0.99999;
          4.1841,1; 4.3064,1; 4.367,0.99998; 4.5013,0.99998; 4.5623,0.99997;
          4.624,0.99997; 4.7444,0.99997; 4.8379,0.99998; 4.98,1; 5.106,1;
          5.1844,0.97587; 5.31,0.97587; 5.4045,0.97281; 5.5437,0.97281;
          5.6199,0.97279; 5.7589,0.97278; 5.8199,0.97278; 5.9618,0.97278;
          6.0242,0.97284; 6.1634,0.97284; 6.2247,0.97277; 6.332,0.97277;
          6.4086,0.97281; 6.5463,0.97281; 6.6232,0.97283; 6.7454,0.97282;
          6.8055,0.97282; 6.9586,0.97282; 7.0976,0.97281; 7.1897,0.97284;
          7.3107,0.97284; 7.403,0.97282; 7.5581,0.97282; 7.7106,0.97282;
          7.7725,0.97285; 7.8345,0.97285; 7.9737,0.97284; 8.1136,0.97284;
          8.1916,0.97284],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.1422,-0.52377;
          0.18922,-0.52377; 0.314,-0.52377; 0.37572,-0.52377; 0.51682,-0.52377;
          0.56396,-0.52377; 0.70518,-0.52377; 0.78404,-0.52377; 0.94075,-0.52372;
          0.98797,-0.52372; 1.1291,-0.52377; 1.1921,-0.52377; 1.3013,-0.52377;
          1.3644,-0.52377; 1.5244,-0.52377; 1.6024,-0.52377; 1.7125,-0.52377;
          1.7754,-0.52377; 1.9167,-0.52377; 1.979,-0.52377; 2.106,-0.52377;
          2.1692,-0.52372; 2.231,-0.52372; 2.357,-0.52377; 2.405,-0.52377;
          2.531,-0.52377; 2.594,-0.52377; 2.7195,-0.52377; 2.7823,-0.52377;
          2.9061,-0.52377; 2.9683,-0.52372; 3.0312,-0.52372; 3.1561,-0.52377;
          3.2034,-0.52377; 3.3457,-0.52377; 3.4085,-0.52377; 3.5358,-0.52377;
          3.613,-0.52377; 3.7231,-0.52383; 3.7859,-0.52383; 3.9235,-0.52377;
          3.9849,-0.52377; 4.1221,-0.52377; 4.1841,-0.52377; 4.3064,-0.52377;
          4.367,-0.52377; 4.5013,-0.52377; 4.5623,-0.52377; 4.624,-0.52377;
          4.7444,-0.52377; 4.8379,-0.52377; 4.98,-0.52372; 5.106,-0.52372;
          5.1844,-0.52418; 5.31,-0.52383; 5.4045,-0.52383; 5.5437,-0.52383;
          5.6199,-0.52383; 5.7589,-0.52383; 5.8199,-0.52383; 5.9618,-0.52377;
          6.0242,-0.52377; 6.1634,-0.52383; 6.2247,-0.52383; 6.332,-0.52383;
          6.4086,-0.52383; 6.5463,-0.52377; 6.6232,-0.52377; 6.7454,-0.52383;
          6.8055,-0.52383; 6.9586,-0.52383; 7.0976,-0.52383; 7.1897,-0.52383;
          7.3107,-0.52383; 7.403,-0.52383; 7.5581,-0.52383; 7.7106,-0.52383;
          7.7725,-0.52377; 7.8345,-0.52377; 7.9737,-0.52383; 8.1136,-0.52383;
          8.1916,-0.52383],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.1422,1; 0.18922,
          0.99999; 0.314,0.99999; 0.37572,1; 0.51682,1; 0.56396,0.99999;
          0.70518,0.99999; 0.78404,1; 0.94075,1; 0.98797,0.99999; 1.1291,
          0.99999; 1.1921,1; 1.3013,1; 1.3644,0.99996; 1.5244,0.99996;
          1.6024,1; 1.7125,1; 1.7754,0.99999; 1.9167,0.99999; 1.979,0.99997;
          2.106,0.99997; 2.1692,1; 2.231,1; 2.357,0.99998; 2.405,0.99998;
          2.531,0.99998; 2.594,1; 2.7195,1; 2.7823,0.99998; 2.9061,0.99998;
          2.9683,1; 3.0312,1; 3.1561,0.99997; 3.2034,0.99997; 3.3457,
          0.99997; 3.4085,1; 3.5358,1; 3.613,0.99999; 3.7231,0.99999;
          3.7859,0.99998; 3.9235,0.99998; 3.9849,0.99999; 4.1221,0.99999;
          4.1841,1; 4.3064,1; 4.367,0.99998; 4.5013,0.99998; 4.5623,0.99997;
          4.624,0.99997; 4.7444,0.99997; 4.8379,0.99998; 4.98,1; 5.106,1;
          5.1844,0.97587; 5.31,0.97587; 5.4045,0.97281; 5.5437,0.97281;
          5.6199,0.97279; 5.7589,0.97278; 5.8199,0.97278; 5.9618,0.97278;
          6.0242,0.97284; 6.1634,0.97284; 6.2247,0.97277; 6.332,0.97277;
          6.4086,0.97281; 6.5463,0.97281; 6.6232,0.97283; 6.7454,0.97282;
          6.8055,0.97282; 6.9586,0.97282; 7.0976,0.97281; 7.1897,0.97284;
          7.3107,0.97284; 7.403,0.97282; 7.5581,0.97282; 7.7106,0.97282;
          7.7725,0.97285; 7.8345,0.97285; 7.9737,0.97284; 8.1136,0.97284;
          8.1916,0.97284],                 extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.1422,-0.52377;
          0.18922,-0.52377; 0.314,-0.52377; 0.37572,-0.52377; 0.51682,-0.52377;
          0.56396,-0.52377; 0.70518,-0.52377; 0.78404,-0.52377; 0.94075,-0.52372;
          0.98797,-0.52372; 1.1291,-0.52377; 1.1921,-0.52377; 1.3013,-0.52377;
          1.3644,-0.52377; 1.5244,-0.52377; 1.6024,-0.52377; 1.7125,-0.52377;
          1.7754,-0.52377; 1.9167,-0.52377; 1.979,-0.52377; 2.106,-0.52377;
          2.1692,-0.52372; 2.231,-0.52372; 2.357,-0.52377; 2.405,-0.52377;
          2.531,-0.52377; 2.594,-0.52377; 2.7195,-0.52377; 2.7823,-0.52377;
          2.9061,-0.52377; 2.9683,-0.52372; 3.0312,-0.52372; 3.1561,-0.52377;
          3.2034,-0.52377; 3.3457,-0.52377; 3.4085,-0.52377; 3.5358,-0.52377;
          3.613,-0.52377; 3.7231,-0.52383; 3.7859,-0.52383; 3.9235,-0.52377;
          3.9849,-0.52377; 4.1221,-0.52377; 4.1841,-0.52377; 4.3064,-0.52377;
          4.367,-0.52377; 4.5013,-0.52377; 4.5623,-0.52377; 4.624,-0.52377;
          4.7444,-0.52377; 4.8379,-0.52377; 4.98,-0.52372; 5.106,-0.52372;
          5.1844,-0.52418; 5.31,-0.52383; 5.4045,-0.52383; 5.5437,-0.52383;
          5.6199,-0.52383; 5.7589,-0.52383; 5.8199,-0.52383; 5.9618,-0.52377;
          6.0242,-0.52377; 6.1634,-0.52383; 6.2247,-0.52383; 6.332,-0.52383;
          6.4086,-0.52383; 6.5463,-0.52377; 6.6232,-0.52377; 6.7454,-0.52383;
          6.8055,-0.52383; 6.9586,-0.52383; 7.0976,-0.52383; 7.1897,-0.52383;
          7.3107,-0.52383; 7.403,-0.52383; 7.5581,-0.52383; 7.7106,-0.52383;
          7.7725,-0.52377; 7.8345,-0.52377; 7.9737,-0.52383; 8.1136,-0.52383;
          8.1916,-0.52383],                                 extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.1422,2.7697; 0.18922,2.7697; 0.314,2.7697; 0.37572,2.7731;
          0.51682,2.7731; 0.56396,2.7697; 0.70518,2.7697; 0.78404,2.7698;
          0.94075,2.7698; 0.98797,2.7731; 1.1291,2.7731; 1.1921,2.7697;
          1.3013,2.7697; 1.3644,2.7697; 1.5244,2.7697; 1.6024,2.7731;
          1.7125,2.7731; 1.7754,2.7731; 1.9167,2.7731; 1.979,2.7697; 2.106,
          2.7697; 2.1692,2.7698; 2.231,2.7698; 2.357,2.7697; 2.405,2.7697;
          2.531,2.7697; 2.594,2.7731; 2.7195,2.7731; 2.7823,2.7697; 2.9061,
          2.7697; 2.9683,2.7731; 3.0312,2.7731; 3.1561,2.7664; 3.2034,
          2.7664; 3.3457,2.7664; 3.4085,2.773; 3.5358,2.7731; 3.613,2.7697;
          3.7231,2.7697; 3.7859,2.7697; 3.9235,2.7697; 3.9849,2.7697;
          4.1221,2.7697; 4.1841,2.7697; 4.3064,2.7697; 4.367,2.7697; 4.5013,
          2.7697; 4.5623,2.7731; 4.624,2.7731; 4.7444,2.773; 4.8379,2.7697;
          4.98,2.7731; 5.106,2.7731; 5.1844,2.9231; 5.31,2.9231; 5.4045,
          2.8598; 5.5437,2.8598; 5.6199,2.8498; 5.7589,2.8498; 5.8199,
          2.8498; 5.9618,2.8498; 6.0242,2.8564; 6.1634,2.8565; 6.2247,
          2.8531; 6.332,2.8531; 6.4086,2.8531; 6.5463,2.8531; 6.6232,2.8598;
          6.7454,2.8498; 6.8055,2.8498; 6.9586,2.8498; 7.0976,2.8531;
          7.1897,2.8598; 7.3107,2.8598; 7.403,2.8498; 7.5581,2.8498; 7.7106,
          2.8565; 7.7725,2.8598; 7.8345,2.8598; 7.9737,2.8498; 8.1136,
          2.8498; 8.1916,2.8531],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.1422,353.53;
          0.18922,353.53; 0.314,353.53; 0.37572,353.53; 0.51682,353.53;
          0.56396,353.52; 0.70518,353.52; 0.78404,353.53; 0.94075,353.53;
          0.98797,353.52; 1.1291,353.52; 1.1921,353.53; 1.3013,353.53;
          1.3644,353.51; 1.5244,353.51; 1.6024,353.53; 1.7125,353.53;
          1.7754,353.53; 1.9167,353.53; 1.979,353.52; 2.106,353.52; 2.1692,
          353.53; 2.231,353.53; 2.357,353.52; 2.405,353.52; 2.531,353.52;
          2.594,353.53; 2.7195,353.53; 2.7823,353.52; 2.9061,353.52; 2.9683,
          353.53; 3.0312,353.53; 3.1561,353.52; 3.2034,353.52; 3.3457,
          353.52; 3.4085,353.53; 3.5358,353.53; 3.613,353.52; 3.7231,353.52;
          3.7859,353.52; 3.9235,353.52; 3.9849,353.52; 4.1221,353.52;
          4.1841,353.53; 4.3064,353.53; 4.367,353.52; 4.5013,353.52; 4.5623,
          353.52; 4.624,353.52; 4.7444,353.52; 4.8379,353.52; 4.98,353.53;
          5.106,353.53; 5.1844,345; 5.31,345; 5.4045,343.92; 5.5437,343.92;
          5.6199,343.91; 5.7589,343.91; 5.8199,343.91; 5.9618,343.91;
          6.0242,343.92; 6.1634,343.92; 6.2247,343.9; 6.332,343.9; 6.4086,
          343.92; 6.5463,343.92; 6.6232,343.92; 6.7454,343.92; 6.8055,
          343.92; 6.9586,343.92; 7.0976,343.92; 7.1897,343.92; 7.3107,
          343.92; 7.403,343.92; 7.5581,343.92; 7.7106,343.92; 7.7725,343.93;
          7.8345,343.93; 7.9737,343.92; 8.1136,343.92; 8.1916,343.92],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_340_V;

  model VoltageVariation_350_to_335_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.082026,
          920.95; 0.14304,920.95; 0.27007,921.13; 0.33409,921.13; 0.4751,
          920.61; 0.53679,921.72; 0.66282,921.75; 0.71083,921.73; 0.84926,
          921.75; 0.89624,920.97; 1.037,920.97; 1.0988,921.96; 1.1461,
          921.96; 1.2698,922.13; 1.3325,921.01; 1.4726,921.01; 1.551,922.13;
          1.691,922.1; 1.7683,920.99; 1.8755,920.56; 1.9536,920.56; 2.0781,
          920.51; 2.1393,921.59; 2.2481,921.59; 2.3094,920.97; 2.4334,
          920.97; 2.5113,921.94; 2.6511,921.94; 2.7122,920.73; 2.8511,
          920.73; 2.9139,921.83; 3.0388,921.83; 3.1011,921.98; 3.1642,
          921.98; 3.2893,922.01; 3.3351,922.01; 3.475,921.97; 3.5364,921.98;
          3.6609,921.72; 3.755,920.61; 3.8961,920.55; 4.0516,921.63; 4.1281,
          935.69; 4.2678,930.98; 4.3452,934.1; 4.4684,933.72; 4.5306,918.63;
          4.6719,919; 4.734,920.06; 4.8873,920.17; 4.965,920.14; 5.1173,
          919.89; 5.2404,919.89; 5.318,918.55; 5.4421,918.55; 5.5206,919.98;
          5.6608,919.98; 5.7383,920.09; 5.8631,920.09; 5.925,918.93; 6.062,
          918.93; 6.1398,920.84; 6.2496,920.84; 6.3275,919.82; 6.4663,
          919.82; 6.5285,919.92; 6.6698,919.91; 6.7307,919.92],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.082026,
          332.37; 0.14304,332.37; 0.27007,331.89; 0.33409,331.89; 0.4751,
          333.33; 0.53679,333.76; 0.66282,333.65; 0.71083,333.64; 0.84926,
          333.59; 0.89624,332.32; 1.037,332.32; 1.0988,333.11; 1.1461,
          333.11; 1.2698,332.65; 1.3325,332.22; 1.4726,332.2; 1.551,332.63;
          1.691,332.75; 1.7683,332.32; 1.8755,333.5; 1.9536,333.5; 2.0781,
          333.66; 2.1393,334.08; 2.2481,334.08; 2.3094,332.32; 2.4334,
          332.32; 2.5113,333.17; 2.6511,333.17; 2.7122,333.02; 2.8511,
          333.02; 2.9139,333.39; 3.0388,333.39; 3.1011,333.06; 3.1642,
          333.06; 3.2893,332.95; 3.3351,332.95; 3.475,333.05; 3.5364,333.05;
          3.6609,333.76; 3.755,333.33; 3.8961,333.45; 4.0516,333.98; 4.1281,
          338.31; 4.2678,351.19; 4.3452,352.35; 4.4684,353.32; 4.5306,
          347.62; 4.6719,346.66; 4.734,347.06; 4.8873,346.74; 4.965,346.73;
          5.1173,347.48; 5.2404,347.48; 5.318,347.78; 5.4421,347.78; 5.5206,
          347.28; 5.6608,347.28; 5.7383,346.9; 5.8631,346.9; 5.925,346.82;
          6.062,346.82; 6.1398,348.23; 6.2496,348.23; 6.3275,347.71; 6.4663,
          347.71; 6.5285,347.44; 6.6698,347.44; 6.7307,347.44],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.082026,1; 0.14304,1;
          0.27007,1; 0.33409,1; 0.4751,1; 0.53679,1; 0.66282,1; 0.71083,
          0.99999; 0.84926,0.99999; 0.89624,1; 1.037,1; 1.0988,1; 1.1461,1;
          1.2698,1; 1.3325,1; 1.4726,1; 1.551,1; 1.691,1; 1.7683,1; 1.8755,
          1; 1.9536,1; 2.0781,1; 2.1393,1; 2.2481,1; 2.3094,1; 2.4334,1;
          2.5113,1; 2.6511,1; 2.7122,1; 2.8511,1; 2.9139,1; 3.0388,1;
          3.1011,1; 3.1642,1; 3.2893,1; 3.3351,1; 3.475,1; 3.5364,1; 3.6609,
          1; 3.755,1; 3.8961,1; 4.0516,1; 4.1281,0.99938; 4.2678,0.99938;
          4.3452,0.95957; 4.4684,0.95957; 4.5306,0.95928; 4.6719,0.95928;
          4.734,0.95928; 4.8873,0.95928; 4.965,0.95924; 5.1173,0.95927;
          5.2404,0.95927; 5.318,0.95926; 5.4421,0.95926; 5.5206,0.95929;
          5.6608,0.95929; 5.7383,0.95926; 5.8631,0.95926; 5.925,0.95928;
          6.062,0.95928; 6.1398,0.9593; 6.2496,0.9593; 6.3275,0.95929;
          6.4663,0.95929; 6.5285,0.95929; 6.6698,0.95929; 6.7307,0.9593],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.082026,-0.52377;
          0.14304,-0.52377; 0.27007,-0.52383; 0.33409,-0.52383; 0.4751,-0.52377;
          0.53679,-0.52377; 0.66282,-0.52377; 0.71083,-0.52377; 0.84926,-0.52383;
          0.89624,-0.52383; 1.037,-0.52383; 1.0988,-0.52377; 1.1461,-0.52377;
          1.2698,-0.52383; 1.3325,-0.52383; 1.4726,-0.52377; 1.551,-0.52377;
          1.691,-0.52383; 1.7683,-0.52383; 1.8755,-0.52383; 1.9536,-0.52383;
          2.0781,-0.52377; 2.1393,-0.52377; 2.2481,-0.52377; 2.3094,-0.52377;
          2.4334,-0.52377; 2.5113,-0.52383; 2.6511,-0.52383; 2.7122,-0.52383;
          2.8511,-0.52383; 2.9139,-0.52383; 3.0388,-0.52383; 3.1011,-0.52377;
          3.1642,-0.52377; 3.2893,-0.52377; 3.3351,-0.52377; 3.475,-0.52377;
          3.5364,-0.52377; 3.6609,-0.52377; 3.755,-0.52377; 3.8961,-0.52389;
          4.0516,-0.52377; 4.1281,-0.52377; 4.2678,-0.52383; 4.3452,-0.52383;
          4.4684,-0.52366; 4.5306,-0.52366; 4.6719,-0.52383; 4.734,-0.52383;
          4.8873,-0.52389; 4.965,-0.52389; 5.1173,-0.52383; 5.2404,-0.52383;
          5.318,-0.52383; 5.4421,-0.52383; 5.5206,-0.52383; 5.6608,-0.52383;
          5.7383,-0.52383; 5.8631,-0.52383; 5.925,-0.52383; 6.062,-0.52383;
          6.1398,-0.52383; 6.2496,-0.52383; 6.3275,-0.52383; 6.4663,-0.52383;
          6.5285,-0.52383; 6.6698,-0.52383; 6.7307,-0.52383],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[
          0.082026,-0.87012; 0.14304,-0.87012; 0.27007,-0.86966; 0.33409,-0.86966;
          0.4751,-0.87117; 0.53679,-0.87119; 0.66282,-0.87108; 0.71083,-0.87108;
          0.84926,-0.87108; 0.89624,-0.87013; 1.037,-0.87013; 1.0988,-0.87049;
          1.1461,-0.87049; 1.2698,-0.87004; 1.3325,-0.87002; 1.4726,-0.86994;
          1.551,-0.86996; 1.691,-0.87014; 1.7683,-0.87013; 1.8755,-0.87141;
          1.9536,-0.87141; 2.0781,-0.87152; 2.1393,-0.87154; 2.2481,-0.87154;
          2.3094,-0.87007; 2.4334,-0.87007; 2.5113,-0.87061; 2.6511,-0.87061;
          2.7122,-0.87088; 2.8511,-0.87088; 2.9139,-0.87086; 3.0388,-0.87086;
          3.1011,-0.87043; 3.1642,-0.87043; 3.2893,-0.87031; 3.3351,-0.87031;
          3.475,-0.87043; 3.5364,-0.87043; 3.6609,-0.87119; 3.755,-0.87117;
          3.8961,-0.87141; 4.0516,-0.87143; 4.1281,-0.87071; 4.2678,-0.88455;
          4.3452,-0.88453; 4.4684,-0.8854; 4.5306,-0.88542; 4.6719,-0.88455;
          4.734,-0.88454; 4.8873,-0.88426; 4.965,-0.88426; 5.1173,-0.88501;
          5.2404,-0.88501; 5.318,-0.88577; 5.4421,-0.88577; 5.5206,-0.88478;
          5.6608,-0.88478; 5.7383,-0.88438; 5.8631,-0.88438; 5.925,-0.88473;
          6.062,-0.88473; 6.1398,-0.88538; 6.2496,-0.88538; 6.3275,-0.88524;
          6.4663,-0.88524; 6.5285,-0.88495; 6.6698,-0.88496; 6.7307,-0.88496],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.082026,1; 0.14304,1;
          0.27007,1; 0.33409,1; 0.4751,1; 0.53679,1; 0.66282,1; 0.71083,
          0.99999; 0.84926,0.99999; 0.89624,1; 1.037,1; 1.0988,1; 1.1461,1;
          1.2698,1; 1.3325,1; 1.4726,1; 1.551,1; 1.691,1; 1.7683,1; 1.8755,
          1; 1.9536,1; 2.0781,1; 2.1393,1; 2.2481,1; 2.3094,1; 2.4334,1;
          2.5113,1; 2.6511,1; 2.7122,1; 2.8511,1; 2.9139,1; 3.0388,1;
          3.1011,1; 3.1642,1; 3.2893,1; 3.3351,1; 3.475,1; 3.5364,1; 3.6609,
          1; 3.755,1; 3.8961,1; 4.0516,1; 4.1281,0.99938; 4.2678,0.99938;
          4.3452,0.95957; 4.4684,0.95957; 4.5306,0.95928; 4.6719,0.95928;
          4.734,0.95928; 4.8873,0.95928; 4.965,0.95924; 5.1173,0.95927;
          5.2404,0.95927; 5.318,0.95926; 5.4421,0.95926; 5.5206,0.95929;
          5.6608,0.95929; 5.7383,0.95926; 5.8631,0.95926; 5.925,0.95928;
          6.062,0.95928; 6.1398,0.9593; 6.2496,0.9593; 6.3275,0.95929;
          6.4663,0.95929; 6.5285,0.95929; 6.6698,0.95929; 6.7307,0.9593],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.082026,-0.52377;
          0.14304,-0.52377; 0.27007,-0.52383; 0.33409,-0.52383; 0.4751,-0.52377;
          0.53679,-0.52377; 0.66282,-0.52377; 0.71083,-0.52377; 0.84926,-0.52383;
          0.89624,-0.52383; 1.037,-0.52383; 1.0988,-0.52377; 1.1461,-0.52377;
          1.2698,-0.52383; 1.3325,-0.52383; 1.4726,-0.52377; 1.551,-0.52377;
          1.691,-0.52383; 1.7683,-0.52383; 1.8755,-0.52383; 1.9536,-0.52383;
          2.0781,-0.52377; 2.1393,-0.52377; 2.2481,-0.52377; 2.3094,-0.52377;
          2.4334,-0.52377; 2.5113,-0.52383; 2.6511,-0.52383; 2.7122,-0.52383;
          2.8511,-0.52383; 2.9139,-0.52383; 3.0388,-0.52383; 3.1011,-0.52377;
          3.1642,-0.52377; 3.2893,-0.52377; 3.3351,-0.52377; 3.475,-0.52377;
          3.5364,-0.52377; 3.6609,-0.52377; 3.755,-0.52377; 3.8961,-0.52389;
          4.0516,-0.52377; 4.1281,-0.52377; 4.2678,-0.52383; 4.3452,-0.52383;
          4.4684,-0.52366; 4.5306,-0.52366; 4.6719,-0.52383; 4.734,-0.52383;
          4.8873,-0.52389; 4.965,-0.52389; 5.1173,-0.52383; 5.2404,-0.52383;
          5.318,-0.52383; 5.4421,-0.52383; 5.5206,-0.52383; 5.6608,-0.52383;
          5.7383,-0.52383; 5.8631,-0.52383; 5.925,-0.52383; 6.062,-0.52383;
          6.1398,-0.52383; 6.2496,-0.52383; 6.3275,-0.52383; 6.4663,-0.52383;
          6.5285,-0.52383; 6.6698,-0.52383; 6.7307,-0.52383],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.082026,1; 0.14304,1;
          0.27007,1; 0.33409,1; 0.4751,1; 0.53679,1; 0.66282,1; 0.71083,
          0.99999; 0.84926,0.99999; 0.89624,1; 1.037,1; 1.0988,1; 1.1461,1;
          1.2698,1; 1.3325,1; 1.4726,1; 1.551,1; 1.691,1; 1.7683,1; 1.8755,
          1; 1.9536,1; 2.0781,1; 2.1393,1; 2.2481,1; 2.3094,1; 2.4334,1;
          2.5113,1; 2.6511,1; 2.7122,1; 2.8511,1; 2.9139,1; 3.0388,1;
          3.1011,1; 3.1642,1; 3.2893,1; 3.3351,1; 3.475,1; 3.5364,1; 3.6609,
          1; 3.755,1; 3.8961,1; 4.0516,1; 4.1281,0.99938; 4.2678,0.99938;
          4.3452,0.95957; 4.4684,0.95957; 4.5306,0.95928; 4.6719,0.95928;
          4.734,0.95928; 4.8873,0.95928; 4.965,0.95924; 5.1173,0.95927;
          5.2404,0.95927; 5.318,0.95926; 5.4421,0.95926; 5.5206,0.95929;
          5.6608,0.95929; 5.7383,0.95926; 5.8631,0.95926; 5.925,0.95928;
          6.062,0.95928; 6.1398,0.9593; 6.2496,0.9593; 6.3275,0.95929;
          6.4663,0.95929; 6.5285,0.95929; 6.6698,0.95929; 6.7307,0.9593],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.082026,-0.52377;
          0.14304,-0.52377; 0.27007,-0.52383; 0.33409,-0.52383; 0.4751,-0.52377;
          0.53679,-0.52377; 0.66282,-0.52377; 0.71083,-0.52377; 0.84926,-0.52383;
          0.89624,-0.52383; 1.037,-0.52383; 1.0988,-0.52377; 1.1461,-0.52377;
          1.2698,-0.52383; 1.3325,-0.52383; 1.4726,-0.52377; 1.551,-0.52377;
          1.691,-0.52383; 1.7683,-0.52383; 1.8755,-0.52383; 1.9536,-0.52383;
          2.0781,-0.52377; 2.1393,-0.52377; 2.2481,-0.52377; 2.3094,-0.52377;
          2.4334,-0.52377; 2.5113,-0.52383; 2.6511,-0.52383; 2.7122,-0.52383;
          2.8511,-0.52383; 2.9139,-0.52383; 3.0388,-0.52383; 3.1011,-0.52377;
          3.1642,-0.52377; 3.2893,-0.52377; 3.3351,-0.52377; 3.475,-0.52377;
          3.5364,-0.52377; 3.6609,-0.52377; 3.755,-0.52377; 3.8961,-0.52389;
          4.0516,-0.52377; 4.1281,-0.52377; 4.2678,-0.52383; 4.3452,-0.52383;
          4.4684,-0.52366; 4.5306,-0.52366; 4.6719,-0.52383; 4.734,-0.52383;
          4.8873,-0.52389; 4.965,-0.52389; 5.1173,-0.52383; 5.2404,-0.52383;
          5.318,-0.52383; 5.4421,-0.52383; 5.5206,-0.52383; 5.6608,-0.52383;
          5.7383,-0.52383; 5.8631,-0.52383; 5.925,-0.52383; 6.062,-0.52383;
          6.1398,-0.52383; 6.2496,-0.52383; 6.3275,-0.52383; 6.4663,-0.52383;
          6.5285,-0.52383; 6.6698,-0.52383; 6.7307,-0.52383],
                                                            extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.082026,2.7697; 0.14304,2.7697; 0.27007,2.7698; 0.33409,2.7698;
          0.4751,2.7698; 0.53679,2.7731; 0.66282,2.7731; 0.71083,2.7731;
          0.84926,2.7731; 0.89624,2.7697; 1.037,2.7697; 1.0988,2.7731;
          1.1461,2.7731; 1.2698,2.7731; 1.3325,2.7698; 1.4726,2.7697; 1.551,
          2.7731; 1.691,2.7731; 1.7683,2.7698; 1.8755,2.7697; 1.9536,2.7697;
          2.0781,2.7697; 2.1393,2.7731; 2.2481,2.7731; 2.3094,2.7697;
          2.4334,2.7697; 2.5113,2.7731; 2.6511,2.7731; 2.7122,2.7697;
          2.8511,2.7697; 2.9139,2.773; 3.0388,2.773; 3.1011,2.7731; 3.1642,
          2.7731; 3.2893,2.7731; 3.3351,2.7731; 3.475,2.7731; 3.5364,2.7731;
          3.6609,2.7731; 3.755,2.7697; 3.8961,2.7697; 4.0516,2.773; 4.1281,
          2.8164; 4.2678,2.8165; 4.3452,2.9432; 4.4684,2.9431; 4.5306,
          2.8965; 4.6719,2.8965; 4.734,2.8998; 4.8873,2.8998; 4.965,2.8998;
          5.1173,2.8998; 5.2404,2.8998; 5.318,2.8965; 5.4421,2.8965; 5.5206,
          2.8998; 5.6608,2.8998; 5.7383,2.8998; 5.8631,2.8998; 5.925,2.8965;
          6.062,2.8965; 6.1398,2.9032; 6.2496,2.9032; 6.3275,2.8998; 6.4663,
          2.8998; 6.5285,2.8998; 6.6698,2.8998; 6.7307,2.8998],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.082026,353.5;
          0.14304,353.5; 0.27007,353.5; 0.33409,353.5; 0.4751,353.5;
          0.53679,353.5; 0.66282,353.5; 0.71083,353.49; 0.84926,353.49;
          0.89624,353.5; 1.037,353.5; 1.0988,353.5; 1.1461,353.5; 1.2698,
          353.5; 1.3325,353.5; 1.4726,353.5; 1.551,353.5; 1.691,353.5;
          1.7683,353.5; 1.8755,353.5; 1.9536,353.5; 2.0781,353.5; 2.1393,
          353.5; 2.2481,353.5; 2.3094,353.5; 2.4334,353.5; 2.5113,353.5;
          2.6511,353.5; 2.7122,353.5; 2.8511,353.5; 2.9139,353.5; 3.0388,
          353.5; 3.1011,353.5; 3.1642,353.5; 3.2893,353.5; 3.3351,353.5;
          3.475,353.5; 3.5364,353.5; 3.6609,353.5; 3.755,353.5; 3.8961,
          353.5; 4.0516,353.5; 4.1281,353.28; 4.2678,353.28; 4.3452,339.2;
          4.4684,339.2; 4.5306,339.1; 4.6719,339.1; 4.734,339.1; 4.8873,
          339.1; 4.965,339.09; 5.1173,339.1; 5.2404,339.1; 5.318,339.09;
          5.4421,339.09; 5.5206,339.1; 5.6608,339.1; 5.7383,339.09; 5.8631,
          339.09; 5.925,339.1; 6.062,339.1; 6.1398,339.11; 6.2496,339.11;
          6.3275,339.11; 6.4663,339.11; 6.5285,339.1; 6.6698,339.1; 6.7307,
          339.11],        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_335_V;

  model VoltageVariation_350_to_330_V
    extends Modelica.Icons.Example;
    OpenIPSL.Electrical.Renewables.PSSE.PV pV1(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.00001,
        dbd2=0.00001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-120,
              110},{-100,130}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus1(V_b=353.92049703035, angle_0
        =0)
      annotation (Placement(transformation(extent={{-80,110},{-60,130}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,110},{10,130}})));
    inner OpenIPSL.Electrical.SystemBase SysData(fn=60, S_b(displayUnit=
            "V.A") = 30000)
      annotation (Placement(transformation(extent={{-128,194},{-88,214}})));
    OpenIPSL.Electrical.Buses.Bus GridBus2(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,110},{0,130}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine1(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,110},{-30,130}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB
      annotation (Placement(transformation(extent={{-44,74},{-24,94}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECB(y=pwLine1.is.im/
          pwLine1.is.re)
      annotation (Placement(transformation(extent={{-88,74},{-68,94}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_P(table=[0.071127,
          921.67; 0.19514,921.67; 0.25713,920.82; 0.32015,920.82; 0.44515,
          920.65; 0.50815,921.75; 0.61667,921.79; 0.67969,921.8; 0.81674,
          921.82; 0.90878,920.73; 1.0468,920.99; 1.1989,922.1; 1.2598,
          921.74; 1.3078,921.74; 1.4757,921.56; 1.6018,920.46; 1.6954,
          920.66; 1.8212,920.93; 1.9,920.93; 2.0261,920.65; 2.0897,921.75;
          2.2312,921.93; 2.2951,921.93; 2.4041,921.95; 2.4986,921.99;
          2.6069,921.99; 2.6842,921.54; 2.7925,921.54; 2.8868,920.73;
          3.0287,920.73; 3.0757,921.94; 3.2012,921.94; 3.2642,921.7; 3.3266,
          921.7; 3.4816,921.62; 3.6055,921.72; 3.6843,964.79; 3.7921,964.79;
          3.8845,917.86; 4.0262,917.84; 4.0886,919.99; 4.2282,919.83;
          4.2739,919.85; 4.3206,919.85; 4.4885,919.73; 4.6301,919.74;
          4.6928,919.72; 4.8308,919.74; 4.9085,920.02; 5.0465,920; 5.1387,
          920; 5.2469,918.89; 5.3089,918.89; 5.4359,918.8; 5.5146,919.87;
          5.6534,920.05; 5.7297,920.05; 5.8535,918.78; 5.9162,918.78;
          6.0566,918.72; 6.1329,918.73; 6.2436,919.97],
                          extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-68,180},{-48,200}})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_Q(table=[0.071127,
          333.8; 0.19514,333.8; 0.25713,332.68; 0.32015,332.68; 0.44515,
          333.11; 0.50815,333.53; 0.61667,333.41; 0.67969,333.42; 0.81674,
          333.36; 0.90878,332.89; 1.0468,332.19; 1.1989,332.61; 1.2598,
          333.52; 1.3078,333.52; 1.4757,334.06; 1.6018,333.64; 1.6954,
          333.11; 1.8212,332.36; 1.9,332.35; 2.0261,333.1; 2.0897,333.52;
          2.2312,333.04; 2.2951,333.04; 2.4041,332.99; 2.4986,332.88;
          2.6069,332.88; 2.6842,334.12; 2.7925,334.12; 2.8868,332.95;
          3.0287,332.95; 3.0757,332.98; 3.2012,332.98; 3.2642,333.69;
          3.3266,333.69; 3.4816,333.91; 3.6055,333.64; 3.6843,343.23;
          3.7921,343.23; 3.8845,357.13; 4.0262,357.18; 4.0886,351.63;
          4.2282,352.05; 4.2739,352.06; 4.3206,352.06; 4.4885,352.38;
          4.6301,352.39; 4.6928,352.44; 4.8308,352.39; 4.9085,351.69;
          5.0465,351.75; 5.1387,351.75; 5.2469,351.53; 5.3089,351.53;
          5.4359,351.79; 5.5146,352.19; 5.6534,351.71; 5.7297,351.71;
          5.8535,351.91; 5.9162,351.91; 6.0566,352.07; 6.1329,352.07;
          6.2436,351.99],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-38,180},{-18,200}})));
    Modelica.Blocks.Sources.CombiTimeTable V(table=[0.071127,1; 0.19514,1;
          0.25713,0.99998; 0.32015,0.99998; 0.44515,0.99998; 0.50815,
          0.99998; 0.61667,0.99998; 0.67969,0.99999; 0.81674,0.99999;
          0.90878,0.99998; 1.0468,0.99998; 1.1989,0.99999; 1.2598,0.99998;
          1.3078,0.99998; 1.4757,0.99998; 1.6018,0.99998; 1.6954,0.99998;
          1.8212,0.99998; 1.9,0.99998; 2.0261,0.99998; 2.0897,0.99998;
          2.2312,0.99998; 2.2951,0.99998; 2.4041,0.99998; 2.4986,0.99998;
          2.6069,0.99998; 2.6842,0.99999; 2.7925,0.99999; 2.8868,0.99999;
          3.0287,0.99999; 3.0757,0.99997; 3.2012,0.99997; 3.2642,0.99999;
          3.3266,0.99999; 3.4816,0.99999; 3.6055,0.99999; 3.6843,0.98873;
          3.7921,0.98873; 3.8845,0.94558; 4.0262,0.94558; 4.0886,0.94559;
          4.2282,0.94559; 4.2739,0.94562; 4.3206,0.94562; 4.4885,0.94562;
          4.6301,0.94562; 4.6928,0.94563; 4.8308,0.94563; 4.9085,0.94564;
          5.0465,0.94564; 5.1387,0.94564; 5.2469,0.94564; 5.3089,0.94564;
          5.4359,0.94564; 5.5146,0.94567; 5.6534,0.94567; 5.7297,0.94567;
          5.8535,0.94567; 5.9162,0.94567; 6.0566,0.94567; 6.1329,0.94568;
          6.2436,0.94569],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,120},{80,140}})));
    Modelica.Blocks.Sources.CombiTimeTable A(table=[0.071127,-0.8713;
          0.19514,-0.8713; 0.25713,-0.87053; 0.32015,-0.87053; 0.44515,-0.871;
          0.50815,-0.87102; 0.61667,-0.87083; 0.67969,-0.87083; 0.81674,-0.87083;
          0.90878,-0.87076; 1.0468,-0.87; 1.1989,-0.87002; 1.2598,-0.87096;
          1.3078,-0.87096; 1.4757,-0.8716; 1.6018,-0.87158; 1.6954,-0.871;
          1.8212,-0.87017; 1.9,-0.87017; 2.0261,-0.87099; 2.0897,-0.87101;
          2.2312,-0.87043; 2.2951,-0.87043; 2.4041,-0.87043; 2.4986,-0.87031;
          2.6069,-0.87031; 2.6842,-0.87165; 2.7925,-0.87165; 2.8868,-0.87082;
          3.0287,-0.87082; 3.0757,-0.87043; 3.2012,-0.87043; 3.2642,-0.87119;
          3.3266,-0.87119; 3.4816,-0.87142; 3.6055,-0.87142; 3.6843,-0.86591;
          3.7921,-0.86591; 3.8845,-0.89507; 4.0262,-0.89507; 4.0886,-0.88902;
          4.2282,-0.88943; 4.2739,-0.88943; 4.3206,-0.88943; 4.4885,-0.88978;
          4.6301,-0.88978; 4.6928,-0.88983; 4.8308,-0.88983; 4.9085,-0.88908;
          5.0465,-0.88914; 5.1387,-0.88914; 5.2469,-0.88927; 5.3089,-0.88927;
          5.4359,-0.88955; 5.5146,-0.88954; 5.6534,-0.88902; 5.7297,-0.88902;
          5.8535,-0.88967; 5.9162,-0.88967; 6.0566,-0.88984; 6.1329,-0.88984;
          6.2436,-0.88937],
        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,100},{80,120}})));
    Modelica.Blocks.Math.Cos COS
      annotation (Placement(transformation(extent={{60,84},{52,92}})));
    Modelica.Blocks.Math.Sin SIN
      annotation (Placement(transformation(extent={{60,96},{52,104}})));
    Modelica.Blocks.Math.Product product1 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,131})));
    Modelica.Blocks.Math.Product product2 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,111})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IAngle(table=[
          0.071127,-0.8713; 0.19514,-0.8713; 0.25713,-0.87053; 0.32015,-0.87053;
          0.44515,-0.871; 0.50815,-0.87102; 0.61667,-0.87083; 0.67969,-0.87083;
          0.81674,-0.87083; 0.90878,-0.87076; 1.0468,-0.87; 1.1989,-0.87002;
          1.2598,-0.87096; 1.3078,-0.87096; 1.4757,-0.8716; 1.6018,-0.87158;
          1.6954,-0.871; 1.8212,-0.87017; 1.9,-0.87017; 2.0261,-0.87099;
          2.0897,-0.87101; 2.2312,-0.87043; 2.2951,-0.87043; 2.4041,-0.87043;
          2.4986,-0.87031; 2.6069,-0.87031; 2.6842,-0.87165; 2.7925,-0.87165;
          2.8868,-0.87082; 3.0287,-0.87082; 3.0757,-0.87043; 3.2012,-0.87043;
          3.2642,-0.87119; 3.3266,-0.87119; 3.4816,-0.87142; 3.6055,-0.87142;
          3.6843,-0.86591; 3.7921,-0.86591; 3.8845,-0.89507; 4.0262,-0.89507;
          4.0886,-0.88902; 4.2282,-0.88943; 4.2739,-0.88943; 4.3206,-0.88943;
          4.4885,-0.88978; 4.6301,-0.88978; 4.6928,-0.88983; 4.8308,-0.88983;
          4.9085,-0.88908; 5.0465,-0.88914; 5.1387,-0.88914; 5.2469,-0.88927;
          5.3089,-0.88927; 5.4359,-0.88955; 5.5146,-0.88954; 5.6534,-0.88902;
          5.7297,-0.88902; 5.8535,-0.88967; 5.9162,-0.88967; 6.0566,-0.88984;
          6.1329,-0.88984; 6.2436,-0.88937],
                                           extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{20,180},{40,200}})));
    Modelica.Blocks.Sources.RealExpression EXPERIMENT_PF(y=EXPERIMENT_P.y[1]/sqrt(
           EXPERIMENT_P.y[1]^2 + EXPERIMENT_Q.y[1]^2))
      annotation (Placement(transformation(extent={{66,186},{86,206}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB(y=pwLine1.P12/sqrt(
           pwLine1.P12^2 + pwLine1.Q12^2))
      annotation (Placement(transformation(extent={{66,194},{86,174}})));
    OpenIPSL.Electrical.Renewables.PSSE.Wind wind(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECA1
        RenewableController(
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0.011,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController,
      redeclare OpenIPSL.Electrical.Renewables.PSSE.WindDriveTrain.WTDTA1
        DriveTrain,
      W0=0)
      annotation (Placement(transformation(extent={{-130,-10},{-110,10}})));

    OpenIPSL.Electrical.Buses.Bus InverterBus2(V_b=352.01, angle_0=0)
      annotation (Placement(transformation(extent={{-80,-10},{-60,10}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput1(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-10},{10,10}})));
    OpenIPSL.Electrical.Buses.Bus GridBus1(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine2(
      R=0,
      X=0.00000000001,
      G=0,
      B=0)
      annotation (Placement(transformation(extent={{-50,-10},{-30,10}})));
    Modelica.Blocks.Sources.CombiTimeTable V1(table=[0.071127,1; 0.19514,1;
          0.25713,0.99998; 0.32015,0.99998; 0.44515,0.99998; 0.50815,
          0.99998; 0.61667,0.99998; 0.67969,0.99999; 0.81674,0.99999;
          0.90878,0.99998; 1.0468,0.99998; 1.1989,0.99999; 1.2598,0.99998;
          1.3078,0.99998; 1.4757,0.99998; 1.6018,0.99998; 1.6954,0.99998;
          1.8212,0.99998; 1.9,0.99998; 2.0261,0.99998; 2.0897,0.99998;
          2.2312,0.99998; 2.2951,0.99998; 2.4041,0.99998; 2.4986,0.99998;
          2.6069,0.99998; 2.6842,0.99999; 2.7925,0.99999; 2.8868,0.99999;
          3.0287,0.99999; 3.0757,0.99997; 3.2012,0.99997; 3.2642,0.99999;
          3.3266,0.99999; 3.4816,0.99999; 3.6055,0.99999; 3.6843,0.98873;
          3.7921,0.98873; 3.8845,0.94558; 4.0262,0.94558; 4.0886,0.94559;
          4.2282,0.94559; 4.2739,0.94562; 4.3206,0.94562; 4.4885,0.94562;
          4.6301,0.94562; 4.6928,0.94563; 4.8308,0.94563; 4.9085,0.94564;
          5.0465,0.94564; 5.1387,0.94564; 5.2469,0.94564; 5.3089,0.94564;
          5.4359,0.94564; 5.5146,0.94567; 5.6534,0.94567; 5.7297,0.94567;
          5.8535,0.94567; 5.9162,0.94567; 6.0566,0.94567; 6.1329,0.94568;
          6.2436,0.94569],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,0},{80,20}})));
    Modelica.Blocks.Sources.CombiTimeTable A1(table=[0.071127,-0.8713;
          0.19514,-0.8713; 0.25713,-0.87053; 0.32015,-0.87053; 0.44515,-0.871;
          0.50815,-0.87102; 0.61667,-0.87083; 0.67969,-0.87083; 0.81674,-0.87083;
          0.90878,-0.87076; 1.0468,-0.87; 1.1989,-0.87002; 1.2598,-0.87096;
          1.3078,-0.87096; 1.4757,-0.8716; 1.6018,-0.87158; 1.6954,-0.871;
          1.8212,-0.87017; 1.9,-0.87017; 2.0261,-0.87099; 2.0897,-0.87101;
          2.2312,-0.87043; 2.2951,-0.87043; 2.4041,-0.87043; 2.4986,-0.87031;
          2.6069,-0.87031; 2.6842,-0.87165; 2.7925,-0.87165; 2.8868,-0.87082;
          3.0287,-0.87082; 3.0757,-0.87043; 3.2012,-0.87043; 3.2642,-0.87119;
          3.3266,-0.87119; 3.4816,-0.87142; 3.6055,-0.87142; 3.6843,-0.86591;
          3.7921,-0.86591; 3.8845,-0.89507; 4.0262,-0.89507; 4.0886,-0.88902;
          4.2282,-0.88943; 4.2739,-0.88943; 4.3206,-0.88943; 4.4885,-0.88978;
          4.6301,-0.88978; 4.6928,-0.88983; 4.8308,-0.88983; 4.9085,-0.88908;
          5.0465,-0.88914; 5.1387,-0.88914; 5.2469,-0.88927; 5.3089,-0.88927;
          5.4359,-0.88955; 5.5146,-0.88954; 5.6534,-0.88902; 5.7297,-0.88902;
          5.8535,-0.88967; 5.9162,-0.88967; 6.0566,-0.88984; 6.1329,-0.88984;
          6.2436,-0.88937],
        extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{100,-20},{80,0}})));
    Modelica.Blocks.Math.Cos COS1
      annotation (Placement(transformation(extent={{60,-36},{52,-28}})));
    Modelica.Blocks.Math.Sin SIN1
      annotation (Placement(transformation(extent={{60,-24},{52,-16}})));
    Modelica.Blocks.Math.Product product3 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,11})));
    Modelica.Blocks.Math.Product product4 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-9})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECA(y=pwLine1.P12/sqrt(
           pwLine2.P12^2 + pwLine2.Q12^2))
      annotation (Placement(transformation(extent={{100,194},{120,174}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECA
      annotation (Placement(transformation(extent={{-48,-40},{-28,-20}})));
    OpenIPSL.Electrical.Renewables.PSSE.PV pV2(
      V_b=353.92049703035,
      P_0(displayUnit="W") = EXPERIMENT_P.table[1, 2],
      Q_0(displayUnit="V.A") = EXPERIMENT_Q.table[1, 2],
      angle_0(displayUnit="rad"),
      QFunctionality=0,
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.InverterInterface.REGCA1
        RenewableGenerator(Tg=0.01, Tfltr=0.01),
      redeclare
        OpenIPSL.Electrical.Renewables.PSSE.ElectricalController.REECB1_modified
        RenewableController(
        Trv=0.01,
        dbd1=-0.0001,
        dbd2=0.0001,
        Kqv=0,
        Tp=0.01,
        Tiq=0.01,
        Tpord=0.01),
      redeclare OpenIPSL.Electrical.Renewables.PSSE.PlantController.REPCA1
        PlantController) annotation (Placement(transformation(extent={{-130,
              -130},{-110,-110}})));
    OpenIPSL.Electrical.Buses.Bus InverterBus3(V_b=353.92049703035, angle_0
        =0) annotation (Placement(transformation(extent={{-80,-130},{-60,-110}})));
    OpenIPSL.Electrical.Sources.VoltageSourceReImInput voltageSourceReImInput2(V_b=
          353.920497030345)
      annotation (Placement(transformation(extent={{30,-130},{10,-110}})));
    OpenIPSL.Electrical.Buses.Bus GridBus3(V_b=353.92049703035, angle_0=0)
      annotation (Placement(transformation(extent={{-20,-130},{0,-110}})));
    OpenIPSL.Electrical.Branches.PwLine pwLine3(
      R=0,
      X=0.0000000000001,
      G=0,
      B=0) annotation (Placement(transformation(extent={{-50,-130},{-30,-110}})));
    Modelica.Blocks.Math.Atan SIMULATION_IAng_REECB_NO_Kqv
      annotation (Placement(transformation(extent={{-48,-160},{-28,-140}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA_NO_Kqv(y=pwLine3.is.im
          /pwLine3.is.re)
      annotation (Placement(transformation(extent={{-88,-160},{-68,-140}})));
    Modelica.Blocks.Sources.CombiTimeTable V2(table=[0.071127,1; 0.19514,1;
          0.25713,0.99998; 0.32015,0.99998; 0.44515,0.99998; 0.50815,
          0.99998; 0.61667,0.99998; 0.67969,0.99999; 0.81674,0.99999;
          0.90878,0.99998; 1.0468,0.99998; 1.1989,0.99999; 1.2598,0.99998;
          1.3078,0.99998; 1.4757,0.99998; 1.6018,0.99998; 1.6954,0.99998;
          1.8212,0.99998; 1.9,0.99998; 2.0261,0.99998; 2.0897,0.99998;
          2.2312,0.99998; 2.2951,0.99998; 2.4041,0.99998; 2.4986,0.99998;
          2.6069,0.99998; 2.6842,0.99999; 2.7925,0.99999; 2.8868,0.99999;
          3.0287,0.99999; 3.0757,0.99997; 3.2012,0.99997; 3.2642,0.99999;
          3.3266,0.99999; 3.4816,0.99999; 3.6055,0.99999; 3.6843,0.98873;
          3.7921,0.98873; 3.8845,0.94558; 4.0262,0.94558; 4.0886,0.94559;
          4.2282,0.94559; 4.2739,0.94562; 4.3206,0.94562; 4.4885,0.94562;
          4.6301,0.94562; 4.6928,0.94563; 4.8308,0.94563; 4.9085,0.94564;
          5.0465,0.94564; 5.1387,0.94564; 5.2469,0.94564; 5.3089,0.94564;
          5.4359,0.94564; 5.5146,0.94567; 5.6534,0.94567; 5.7297,0.94567;
          5.8535,0.94567; 5.9162,0.94567; 6.0566,0.94567; 6.1329,0.94568;
          6.2436,0.94569],                 extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-120},{80,-100}})));
    Modelica.Blocks.Sources.CombiTimeTable A2(table=[0.071127,-0.8713;
          0.19514,-0.8713; 0.25713,-0.87053; 0.32015,-0.87053; 0.44515,-0.871;
          0.50815,-0.87102; 0.61667,-0.87083; 0.67969,-0.87083; 0.81674,-0.87083;
          0.90878,-0.87076; 1.0468,-0.87; 1.1989,-0.87002; 1.2598,-0.87096;
          1.3078,-0.87096; 1.4757,-0.8716; 1.6018,-0.87158; 1.6954,-0.871;
          1.8212,-0.87017; 1.9,-0.87017; 2.0261,-0.87099; 2.0897,-0.87101;
          2.2312,-0.87043; 2.2951,-0.87043; 2.4041,-0.87043; 2.4986,-0.87031;
          2.6069,-0.87031; 2.6842,-0.87165; 2.7925,-0.87165; 2.8868,-0.87082;
          3.0287,-0.87082; 3.0757,-0.87043; 3.2012,-0.87043; 3.2642,-0.87119;
          3.3266,-0.87119; 3.4816,-0.87142; 3.6055,-0.87142; 3.6843,-0.86591;
          3.7921,-0.86591; 3.8845,-0.89507; 4.0262,-0.89507; 4.0886,-0.88902;
          4.2282,-0.88943; 4.2739,-0.88943; 4.3206,-0.88943; 4.4885,-0.88978;
          4.6301,-0.88978; 4.6928,-0.88983; 4.8308,-0.88983; 4.9085,-0.88908;
          5.0465,-0.88914; 5.1387,-0.88914; 5.2469,-0.88927; 5.3089,-0.88927;
          5.4359,-0.88955; 5.5146,-0.88954; 5.6534,-0.88902; 5.7297,-0.88902;
          5.8535,-0.88967; 5.9162,-0.88967; 6.0566,-0.88984; 6.1329,-0.88984;
          6.2436,-0.88937],                                 extrapolation=
          Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{100,-140},{80,-120}})));
    Modelica.Blocks.Math.Cos COS2
      annotation (Placement(transformation(extent={{60,-156},{52,-148}})));
    Modelica.Blocks.Math.Sin SIN2
      annotation (Placement(transformation(extent={{60,-144},{52,-136}})));
    Modelica.Blocks.Math.Product product5 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-109})));
    Modelica.Blocks.Math.Product product6 annotation (Placement(transformation(
          extent={{-3,-3},{3,3}},
          rotation=180,
          origin={41,-129})));
    Modelica.Blocks.Sources.CombiTimeTable EXPERIMENT_IMagnitude(table=[
          0.071127,2.7731; 0.19514,2.7731; 0.25713,2.7698; 0.32015,2.7698;
          0.44515,2.7697; 0.50815,2.7731; 0.61667,2.7731; 0.67969,2.7731;
          0.81674,2.7731; 0.90878,2.7697; 1.0468,2.7698; 1.1989,2.7731;
          1.2598,2.773; 1.3078,2.773; 1.4757,2.7731; 1.6018,2.7697; 1.6954,
          2.7697; 1.8212,2.7698; 1.9,2.7698; 2.0261,2.7697; 2.0897,2.7731;
          2.2312,2.7731; 2.2951,2.7731; 2.4041,2.7731; 2.4986,2.7731;
          2.6069,2.7731; 2.6842,2.7731; 2.7925,2.7731; 2.8868,2.7698;
          3.0287,2.7698; 3.0757,2.7731; 3.2012,2.7731; 3.2642,2.773; 3.3266,
          2.773; 3.4816,2.7731; 3.6055,2.7731; 3.6843,2.9299; 3.7921,2.9299;
          3.8845,2.9465; 4.0262,2.9465; 4.0886,2.9465; 4.2282,2.9465;
          4.2739,2.9465; 4.3206,2.9465; 4.4885,2.9465; 4.6301,2.9465;
          4.6928,2.9465; 4.8308,2.9465; 4.9085,2.9465; 5.0465,2.9465;
          5.1387,2.9465; 5.2469,2.9432; 5.3089,2.9432; 5.4359,2.9432;
          5.5146,2.9465; 5.6534,2.9465; 5.7297,2.9465; 5.8535,2.9432;
          5.9162,2.9432; 6.0566,2.9432; 6.1329,2.9432; 6.2436,2.9465],
                   extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint)
      annotation (Placement(transformation(extent={{-8,180},{12,200}})));
    Modelica.Blocks.Sources.RealExpression PF_Simulation_REECB_NO_Kqv(y=pwLine3.P12
          /sqrt(pwLine3.P12^2 + pwLine3.Q12^2))
      annotation (Placement(transformation(extent={{100,186},{120,206}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB(y=sqrt(pwLine1.p.ir
          ^2 + pwLine1.p.ii^2))
      annotation (Placement(transformation(extent={{-120,74},{-100,54}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Ang_REECA(y=pwLine2.is.im/
          pwLine2.is.re)
      annotation (Placement(transformation(extent={{-88,-40},{-68,-20}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECA(y=sqrt(pwLine2.p.ir
          ^2 + pwLine2.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-46},{-100,-66}})));
    Modelica.Blocks.Sources.RealExpression SIMULATION_I_Mag_REECB_NO_Kqv(y=sqrt(
          pwLine3.p.ir^2 + pwLine3.p.ii^2))
      annotation (Placement(transformation(extent={{-120,-160},{-100,-180}})));
    Modelica.Blocks.Sources.CombiTimeTable VOLTAGE(table=[0.071127,353.49;
          0.19514,353.49; 0.25713,353.49; 0.32015,353.49; 0.44515,353.49;
          0.50815,353.49; 0.61667,353.49; 0.67969,353.49; 0.81674,353.49;
          0.90878,353.49; 1.0468,353.49; 1.1989,353.49; 1.2598,353.49;
          1.3078,353.49; 1.4757,353.49; 1.6018,353.49; 1.6954,353.49;
          1.8212,353.49; 1.9,353.48; 2.0261,353.48; 2.0897,353.48; 2.2312,
          353.48; 2.2951,353.48; 2.4041,353.48; 2.4986,353.49; 2.6069,
          353.49; 2.6842,353.49; 2.7925,353.49; 2.8868,353.49; 3.0287,
          353.49; 3.0757,353.48; 3.2012,353.48; 3.2642,353.49; 3.3266,
          353.49; 3.4816,353.49; 3.6055,353.49; 3.6843,349.51; 3.7921,
          349.51; 3.8845,334.26; 4.0262,334.26; 4.0886,334.26; 4.2282,
          334.26; 4.2739,334.27; 4.3206,334.27; 4.4885,334.27; 4.6301,
          334.27; 4.6928,334.27; 4.8308,334.27; 4.9085,334.28; 5.0465,
          334.28; 5.1387,334.28; 5.2469,334.28; 5.3089,334.28; 5.4359,
          334.28; 5.5146,334.29; 5.6534,334.29; 5.7297,334.29; 5.8535,
          334.29; 5.9162,334.29; 6.0566,334.29; 6.1329,334.29; 6.2436,
          334.29],        extrapolation=Modelica.Blocks.Types.Extrapolation.LastTwoPoints)
      annotation (Placement(transformation(extent={{-68,152},{-48,172}})));
    Modelica.Blocks.Sources.RealExpression Im1(y=sqrt(pwLine1.p.ir^2 +
          pwLine1.p.ii^2)*30000/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,56},{-100,36}})));
    Modelica.Blocks.Sources.RealExpression Im2(y=sqrt(pwLine2.p.ir^2 +
          pwLine2.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-66},{-100,-86}})));
    Modelica.Blocks.Sources.RealExpression Im3(y=sqrt(pwLine3.p.ir^2 +
          pwLine3.p.ii^2)*SysData.S_b/VOLTAGE.table[1, 2])
      annotation (Placement(transformation(extent={{-120,-180},{-100,-200}})));
    Modelica.Blocks.Sources.RealExpression VR(y=VOLTAGE.y[1]*COS.y)
      annotation (Placement(transformation(extent={{-36,174},{-16,154}})));
    Modelica.Blocks.Sources.RealExpression VI(y=VOLTAGE.y[1]*SIN.y)
      annotation (Placement(transformation(extent={{-8,174},{12,154}})));
    Modelica.Blocks.Sources.RealExpression Ir1(y=Im1.y*cos(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,74},{-68,54}})));
    Modelica.Blocks.Sources.RealExpression Ii1(y=Im1.y*sin(
          SIMULATION_IAng_REECB.y))
      annotation (Placement(transformation(extent={{-88,56},{-68,36}})));
    Modelica.Blocks.Sources.RealExpression Ir2(y=Im2.y*cos(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-46},{-72,-66}})));
    Modelica.Blocks.Sources.RealExpression Ii2(y=Im2.y*sin(
          SIMULATION_IAng_REECA.y))
      annotation (Placement(transformation(extent={{-92,-66},{-72,-86}})));
    Modelica.Blocks.Sources.RealExpression Ir3(y=Im3.y*cos(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-160},{-70,-180}})));
    Modelica.Blocks.Sources.RealExpression Ii3(y=Im3.y*sin(
          SIMULATION_IAng_REECB_NO_Kqv.y))
      annotation (Placement(transformation(extent={{-90,-180},{-70,-200}})));
  equation
    connect(pV1.pwPin,InverterBus1. p)
      annotation (Line(points={{-100,120},{-70,120}},color={0,0,255}));
    connect(GridBus2.p,voltageSourceReImInput. p)
      annotation (Line(points={{-10,120},{9,120}}, color={0,0,255}));
    connect(pwLine1.p,InverterBus1. p)
      annotation (Line(points={{-49,120},{-70,120}}, color={0,0,255}));
    connect(SIMULATION_I_Ang_REECB.y, SIMULATION_IAng_REECB.u)
      annotation (Line(points={{-67,84},{-46,84}}, color={0,0,127}));
    connect(A.y[1],COS. u) annotation (Line(points={{79,110},{78,110},{78,
            88},{60.8,88}},
                  color={0,0,127}));
    connect(SIN.u, A.y[1]) annotation (Line(points={{60.8,100},{78,100},{78,
            110},{79,110}},
                  color={0,0,127}));
    connect(voltageSourceReImInput.vRe, product1.y)
      annotation (Line(points={{32,124},{32,131},{37.7,131}},
                                                           color={0,0,127}));
    connect(voltageSourceReImInput.vIm, product2.y)
      annotation (Line(points={{32,116},{32,111},{37.7,111}},
                                                           color={0,0,127}));
    connect(COS.y, product1.u2) annotation (Line(points={{51.6,88},{44,88},
            {44,66},{112,66},{112,152},{44.6,152},{44.6,132.8}},
                                                     color={0,0,127}));
    connect(V.y[1], product1.u1) annotation (Line(points={{79,130},{50,130},
            {50,129.2},{44.6,129.2}},
                          color={0,0,127}));
    connect(SIN.y, product2.u1) annotation (Line(points={{51.6,100},{48,100},
            {48,109.2},{44.6,109.2}},
                          color={0,0,127}));
    connect(product2.u2, V.y[1])
      annotation (Line(points={{44.6,112.8},{79,112.8},{79,130}},
                                                               color={0,0,127}));
    connect(pwLine1.n, GridBus2.p)
      annotation (Line(points={{-31,120},{-10,120}},
                                                 color={0,0,255}));
    connect(wind.pwPin, InverterBus2.p)
      annotation (Line(points={{-110,0},{-70,0}},     color={0,0,255}));
    connect(GridBus1.p, voltageSourceReImInput1.p)
      annotation (Line(points={{-10,0},{9,0}},    color={0,0,255}));
    connect(pwLine2.p,InverterBus2. p)
      annotation (Line(points={{-49,0},{-70,0}},     color={0,0,255}));
    connect(A1.y[1],COS1. u) annotation (Line(points={{79,-10},{78,-10},{78,
            -32},{60.8,-32}},
                        color={0,0,127}));
    connect(SIN1.u, A1.y[1]) annotation (Line(points={{60.8,-20},{78,-20},{
            78,-10},{79,-10}},
                       color={0,0,127}));
    connect(voltageSourceReImInput1.vRe, product3.y)
      annotation (Line(points={{32,4},{32,11},{37.7,11}},     color={0,0,127}));
    connect(voltageSourceReImInput1.vIm, product4.y)
      annotation (Line(points={{32,-4},{32,-9},{37.7,-9}},    color={0,0,127}));
    connect(COS1.y, product3.u2) annotation (Line(points={{51.6,-32},{44,
            -32},{44,-54},{112,-54},{112,32},{44.6,32},{44.6,12.8}},
                                                                 color={0,0,127}));
    connect(V1.y[1], product3.u1) annotation (Line(points={{79,10},{50,10},
            {50,9.2},{44.6,9.2}},
                           color={0,0,127}));
    connect(SIN1.y, product4.u1) annotation (Line(points={{51.6,-20},{48,
            -20},{48,-10.8},{44.6,-10.8}},
                                  color={0,0,127}));
    connect(product4.u2, V1.y[1]) annotation (Line(points={{44.6,-7.2},{79,
            -7.2},{79,10}},
                       color={0,0,127}));
    connect(pwLine2.n, GridBus1.p)
      annotation (Line(points={{-31,0},{-10,0}},   color={0,0,255}));
    connect(pV2.pwPin,InverterBus3. p)
      annotation (Line(points={{-110,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(GridBus3.p, voltageSourceReImInput2.p)
      annotation (Line(points={{-10,-120},{9,-120}},color={0,0,255}));
    connect(pwLine3.p,InverterBus3. p)
      annotation (Line(points={{-49,-120},{-70,-120}},
                                                     color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA_NO_Kqv.y, SIMULATION_IAng_REECB_NO_Kqv.u)
      annotation (Line(points={{-67,-150},{-50,-150}}, color={0,0,127}));
    connect(A2.y[1],COS2. u) annotation (Line(points={{79,-130},{78,-130},{
            78,-152},{60.8,-152}},
                                color={0,0,127}));
    connect(SIN2.u, A2.y[1]) annotation (Line(points={{60.8,-140},{78,-140},
            {78,-130},{79,-130}},color={0,0,127}));
    connect(voltageSourceReImInput2.vRe, product5.y) annotation (Line(points={{32,-116},
            {32,-109},{37.7,-109}},            color={0,0,127}));
    connect(voltageSourceReImInput2.vIm, product6.y) annotation (Line(points={{32,-124},
            {32,-129},{37.7,-129}},            color={0,0,127}));
    connect(COS2.y, product5.u2) annotation (Line(points={{51.6,-152},{44,
            -152},{44,-174},{112,-174},{112,-88},{44.6,-88},{44.6,-107.2}},
          color={0,0,127}));
    connect(V2.y[1], product5.u1) annotation (Line(points={{79,-110},{50,
            -110},{50,-110.8},{44.6,-110.8}},
                                        color={0,0,127}));
    connect(SIN2.y, product6.u1) annotation (Line(points={{51.6,-140},{48,
            -140},{48,-130.8},{44.6,-130.8}}, color={0,0,127}));
    connect(product6.u2, V2.y[1]) annotation (Line(points={{44.6,-127.2},{
            79,-127.2},{79,-110}},
                                color={0,0,127}));
    connect(pwLine3.n,GridBus3. p)
      annotation (Line(points={{-31,-120},{-10,-120}},
                                                 color={0,0,255}));
    connect(SIMULATION_I_Ang_REECA.y, SIMULATION_IAng_REECA.u)
      annotation (Line(points={{-67,-30},{-50,-30}}, color={0,0,127}));
    annotation (Icon(coordinateSystem(preserveAspectRatio=false, extent={{-140,
              -240},{140,240}})),                                  Diagram(
          coordinateSystem(preserveAspectRatio=false, extent={{-140,-240},{
              140,240}})),
      experiment(
        StopTime=7.8,
        __Dymola_NumberOfIntervals=1000,
        __Dymola_Algorithm="Dassl"));
  end VoltageVariation_350_to_330_V;
end Over095PowerFactor;
